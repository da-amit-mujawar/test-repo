-- child table rate chart

drop table if exists meyer_rate_chart_new;

create table meyer_rate_chart_new
(
myrsegmentationage varchar(250) ,
sap10yearpremfemale100k varchar(250),
sap10yearpremfemale250k varchar(250),
sap10yearpremfemale500k varchar(250),
sap10yearpremfemale1m varchar(250),
sap10yearpremfemale1m500k varchar(250),
sap10yearpremfemale2m varchar(250),
sap10yearpremmale100k varchar(250),
sap10yearpremmale250k varchar(250),
sap10yearpremmale500k varchar(250),
sap10yearpremmale1m varchar(250),
sap10yearpremmale1m500k varchar(250),
sap10yearpremmale2m varchar(250),
sap20yearpremfemale100k varchar(250),
sap20yearpremfemale250k varchar(250),
sap20yearpremfemale500k varchar(250),
sap20yearpremfemale1m varchar(250),
sap20yearpremfemale1m500k varchar(250),
sap20yearpremfemale2m varchar(250),
sap20yearpremmale100k varchar(250),
sap20yearpremmale250k varchar(250),
sap20yearpremmale500k varchar(250),
sap20yearpremmale1m varchar(250),
sap20yearpremmale1m500k varchar(250),
sap20yearpremmale2m varchar(250),
lfl60_10yearfemaleprem100k varchar(250),
lfl60_10yearfemaleprem250k varchar(250),
lfl60_10yearfemaleprem500k varchar(250),
lfl60_10yearfemaleprem1m varchar(250),
lfl60_10yearfemaleprem1m500k varchar(250),
lfl60_10yearfemaleprem2m varchar(250),
lfl60_10yearmaleprem100k varchar(250),
lfl60_10yearmaleprem250k varchar(250),
lfl60_10yearmaleprem500k varchar(250),
lfl60_10yearmaleprem1m varchar(250),
lfl60_10yearmaleprem1m500k varchar(250),
lfl60_10yearmaleprem2m varchar(250),
lfl60_20yearfemaleprem100k varchar(250),
lfl60_20yearfemaleprem250k varchar(250),
lfl60_20yearfemaleprem500k varchar(250),
lfl60_20yearfemaleprem1m varchar(250),
lfl60_20yearfemaleprem1m500k varchar(250),
lfl60_20yearfemaleprem2m varchar(250),
lfl60_20yearmaleprem100k varchar(250),
lfl60_20yearmaleprem250k varchar(250),
lfl60_20yearmaleprem500k varchar(250),
lfl60_20yearmaleprem1m varchar(250),
lfl60_20yearmaleprem1m500k varchar(250),
lfl60_20yearmaleprem2m varchar(250),
corepremmale50k varchar(250),
corepremmale100k varchar(250),
corepremmale250k varchar(250),
corepremmale500k varchar(250),
corepremfemale50k varchar(250),
corepremfemale100k varchar(250),
corepremfemale250k varchar(250),
corepremfemale500k varchar(250),
life95premfemale25k varchar(250),
life95premfemale50k varchar(250),
life95premfemale75k varchar(250),
life95premfemale100k varchar(250),
life95premmale25k varchar(250),
life95premmale50k varchar(250),
life95premmale75k varchar(250),
life95premmale100k varchar(250),
under30only varchar(250),
over30thru44 varchar(250),
over40 varchar(250),
over60only varchar(250)
)
diststyle all;


copy meyer_rate_chart_new
(
myrsegmentationage,
sap10yearpremfemale100k,
sap10yearpremfemale250k,
sap10yearpremfemale500k,
sap10yearpremfemale1m,
sap10yearpremfemale1m500k,
sap10yearpremfemale2m,
sap10yearpremmale100k,
sap10yearpremmale250k,
sap10yearpremmale500k,
sap10yearpremmale1m,
sap10yearpremmale1m500k,
sap10yearpremmale2m,
sap20yearpremfemale100k,
sap20yearpremfemale250k,
sap20yearpremfemale500k,
sap20yearpremfemale1m,
sap20yearpremfemale1m500k,
sap20yearpremfemale2m,
sap20yearpremmale100k,
sap20yearpremmale250k,
sap20yearpremmale500k,
sap20yearpremmale1m,
sap20yearpremmale1m500k,
sap20yearpremmale2m,
lfl60_10yearfemaleprem100k,
lfl60_10yearfemaleprem250k,
lfl60_10yearfemaleprem500k,
lfl60_10yearfemaleprem1m,
lfl60_10yearfemaleprem1m500k,
lfl60_10yearfemaleprem2m,
lfl60_10yearmaleprem100k,
lfl60_10yearmaleprem250k,
lfl60_10yearmaleprem500k,
lfl60_10yearmaleprem1m,
lfl60_10yearmaleprem1m500k,
lfl60_10yearmaleprem2m,
lfl60_20yearfemaleprem100k,
lfl60_20yearfemaleprem250k,
lfl60_20yearfemaleprem500k,
lfl60_20yearfemaleprem1m,
lfl60_20yearfemaleprem1m500k,
lfl60_20yearfemaleprem2m,
lfl60_20yearmaleprem100k,
lfl60_20yearmaleprem250k,
lfl60_20yearmaleprem500k,
lfl60_20yearmaleprem1m,
lfl60_20yearmaleprem1m500k,
lfl60_20yearmaleprem2m,
corepremmale50k,
corepremmale100k,
corepremmale250k,
corepremmale500k,
corepremfemale50k,
corepremfemale100k,
corepremfemale250k,
corepremfemale500k,
life95premfemale25k,
life95premfemale50k,
life95premfemale75k,
life95premfemale100k,
life95premmale25k,
life95premmale50k,
life95premmale75k,
life95premmale100k,
under30only,
over30thru44,
over40,
over60only
)
from 's3://{s3-cust-meyer}{s3-key2}'
iam_role '{iam}'
delimiter '|'
ignoreheader as 1
removequotes;
