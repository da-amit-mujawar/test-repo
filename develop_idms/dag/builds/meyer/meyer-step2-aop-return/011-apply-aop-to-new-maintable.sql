-- Step 4: Update current tblMain with Data from 100+200 WB Output WHERE FileCode = 200
update {maintable_name}
   set
    firstname=substring(replace(nvl(b.firstname,''), '~', ''),1,30),
    middleinitial=substring(replace(nvl(b.middleinitial,''), '~', ''),1,30),
    lastname=substring(replace(nvl(b.lastname,''), '~', ''),1,30),
    title=substring(replace(nvl(b.daalumnititle,''), '~', ''),1,20),
    suffix=substring(replace(nvl(b.suffix,''), '~', ''),1,15),
    daspousefirstname=substring(replace(nvl(b.daspousefirstname,''), '~', ''),1,30),
    daspousemiddlename=substring(replace(nvl(b.daspousemiddlename,''), '~', ''),1,30),
    daspouselastname=substring(replace(nvl(b.daspouselastname,''), '~', ''),1,30),
    daspousetitle=substring(replace(nvl(b.daspousetitle,''), '~', ''),1,20),
    daspousesuffix=substring(replace(replace(nvl(b.daspousesuffix,''), '~', ''), '"', ''),1,15),
    ah1resbusind=substring(replace(nvl(b.ah1resbusind,''), '~', ''),1,1),
    ah1deliverytypecd=substring(replace(nvl(b.ah1deliverytypecd,''), '~', ''),1,1),
    addressline1=substring(replace(nvl(b.addressline1,''), '~', ''),1,40),
    ah1unitinfo=substring(replace(nvl(b.ah1unitinfo,''), '~', ''),1,13),
    addressline2=substring(replace(nvl(b.addressline2,''), '~', ''),1,40),
    city=substring(replace(nvl(b.city,''), '~', ''),1,28),
    state=substring(replace(nvl(b.state,''), '~', ''),1,2),
    zip=substring(replace(nvl(b.zip,''), '~', ''),1,5),
    zip4=substring(replace(nvl(b.zip4,''), '~', ''),1,4),
    ah1mailabilityscore=substring(replace(nvl(b.ah1mailabilityscore,''), '~', ''),1,2),
    ah1carrierroute=substring(replace(nvl(b.ah1carrierroute,''), '~', ''),1,4),
    ah1lotsortationnum=substring(replace(nvl(b.ah1lotsortationnum,''), '~', ''),1,2),
    ah1deliverypoint=substring(replace(nvl(b.ah1deliverypoint,''), '~', ''),1,12),
    supp1mpspander=substring(replace(nvl(b.supp1mpspander,''), '~', ''),1,1),
    supp1dtspander=substring(replace(nvl(b.supp1dtspander,''), '~', ''),1,1),
    supp1offpander=substring(replace(nvl(b.supp1offpander,''), '~', ''),1,1),
    supp1buspander=substring(replace(nvl(b.supp1buspander,''), '~', ''),1,1),
    supp1fdspander=substring(replace(nvl(b.supp1fdspander,''), '~', ''),1,1),
    supp1decpander=substring(replace(nvl(b.supp1decpander,''), '~', ''),1,1),
    supp1relpander=substring(replace(nvl(b.supp1relpander,''), '~', ''),1,1),
    supp1extpander=substring(replace(nvl(b.supp1extpander,''), '~', ''),1,1),
    supp1colpander=substring(replace(nvl(b.supp1colpander,''), '~', ''),1,1),
    supp1milpander=substring(replace(nvl(b.supp1milpander,''), '~', ''),1,1),
    supp1trlpander=substring(replace(nvl(b.supp1trlpander,''), '~', ''),1,1),
    supp1retpander=substring(replace(nvl(b.supp1retpander,''), '~', ''),1,1),
    supp1nurpander=substring(replace(nvl(b.supp1nurpander,''), '~', ''),1,1),
    supp1clipander=substring(replace(nvl(b.supp1clipander,''), '~', ''),1,1),
    supp1dbapander=substring(replace(nvl(b.supp1dbapander,''), '~', ''),1,1),
    supp1acapander=substring(replace(nvl(b.supp1acapander,''), '~', ''),1,1),
    supp1attgenfile=substring(replace(nvl(b.supp1attgenfile,''), '~', ''),1,1),
    supp1tpspander=substring(replace(nvl(b.supp1tpspander,''), '~', ''),1,1),
    supp1infobusphone=substring(replace(nvl(b.supp1infobusphone,''), '~', ''),1,1),
    supp1emailsupp=substring(replace(nvl(b.supp1emailsupp,''), '~', ''),1,1),
    ce_household_id=substring(replace(nvl(b.ce_household_id,''), '~', ''),1,12),
    ce_individual_id=substring(replace(nvl(b.ce_individual_id,''), '~', ''),1,12),
    gecbsacd=substring(replace(nvl(b.gecbsacd,''), '~', ''),1,5),
    gecbsatype=substring(replace(nvl(b.gecbsatype,''), '~', ''),1,5),
    gecbsaname=substring(replace(nvl(b.gecbsaname,''), '~', ''),1,50),
    flongitude=substring(replace(nvl(b.flongitude,''), '~', ''),1,11),
    flatitude=substring(replace(nvl(b.flatitude,''), '~', ''),1,11),
    lems=substring(replace(nvl(b.lems,''), '~', ''),1,18),
    individual_mc=substring(replace(nvl(b.individual_mc,''), '~', ''),1,17),
    ncoareturncode=substring(replace(nvl(b.ncoareturncode,''), '~', ''),1,2),
    pinformation=substring(replace(nvl(b.gepinformation,''), '~', ''),1,5),
    pdegreedoctorate=substring(replace(nvl(b.gepdegreedoctorate,''), '~', ''),1,5)
from {maintable_name} a inner join
    meyer_return_aop b on a.id = b.id
where b.file_id = '200';

