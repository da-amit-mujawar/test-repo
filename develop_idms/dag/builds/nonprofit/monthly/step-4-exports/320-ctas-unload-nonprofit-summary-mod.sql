/*
NonProfit Summary MOD
Data Source: np_sum, consuniv ON company_id
Condition: unique company_id and lems !empty
Order by: none
Other: Pass 0 for nulls, space for char1

 Update Schedule: Monthly
*/

unload ('select ltd2.company_id,
       lems,
       nvl(ltd_first_donation_date, ''''),
       nvl(ltd_last_donation_date, ''''),
       nvl(ltd_months_since_first_donation_date, 0),
       nvl(ltd_months_since_last_donation_date, 0),
       nvl(ltd_number_of_donations_past_30_days, 0),
       nvl(ltd_number_of_donations_2_3_months_ago, 0),
       nvl(ltd_number_of_donations_4_6_months_ago, 0),
       nvl(ltd_number_of_donations_7_12_months_ago, 0),
       nvl(ltd_number_of_donations_13_24_months_ago, 0),
       nvl(ltd_number_of_donations_over_24_months_ago, 0),
       nvl(ltd_number_of_donations_0_3_months_ago, 0),
       nvl(ltd_number_of_donations_0_6_months_ago, 0),
       nvl(ltd_number_of_donations_0_12_months_ago, 0),
       nvl(ltd_number_of_donations_0_24_months_ago, 0),
       nvl(ltd_last_payment_method, '' ''),
       nvl(ltd_last_response_channel, '' ''),
       nvl(ltd_number_of_list_sources, 0),
       nvl(ltd_highest_donation_amount_ever, 0),
       nvl(ltd_lowest_donation_amount_ever, 0),
       nvl(ltd_total_number_of_donations, 0),
       nvl(ltd_total_dollar_donations, 0),
       nvl(ltd_average_donation_per_transaction, 0),
       nvl(ltd_months_since_last_donation_mail, 0),
       nvl(ltd_months_since_last_donation_phone, 0),
       nvl(ltd_months_since_last_donation_web, 0),
       nvl(ltd_months_since_last_donation_mobile, 0),
       nvl(m12_number_of_list_sources, 0),
       nvl(m12_highest_donation_amount, 0),
       nvl(m12_lowest_donation_amount, 0),
       nvl(m12_total_number_of_donations, 0),
       nvl(m12_total_dollar_donations, 0),
       nvl(m12_average_donation_per_transaction, 0),
       nvl(m12_cat_an_months_since_last_donation, 0),
       nvl(m12_cat_an_number_of_donation, 0),
       nvl(m12_cat_an_dollar_donation, 0),
       nvl(m12_cat_an_avg_dollar_donation, 0),
       nvl(m12_cat_ch_months_since_last_donation, 0),
       nvl(m12_cat_ch_number_of_donation, 0),
       nvl(m12_cat_ch_dollar_donation, 0),
       nvl(m12_cat_ch_avg_dollar_donation, 0),
       nvl(m12_cat_cg_months_since_last_donation, 0),
       nvl(m12_cat_cg_number_of_donation, 0),
       nvl(m12_cat_cg_dollar_donation, 0),
       nvl(m12_cat_cg_avg_dollar_donation, 0),
       nvl(m12_cat_hg_months_since_last_donation, 0),
       nvl(m12_cat_hg_number_of_donation, 0),
       nvl(m12_cat_hg_dollar_donation, 0),
       nvl(m12_cat_hg_avg_dollar_donation, 0),
       nvl(m12_cat_hs_months_since_last_donation, 0),
       nvl(m12_cat_hs_number_of_donation, 0),
       nvl(m12_cat_hs_dollar_donation, 0),
       nvl(m12_cat_hs_avg_dollar_donation, 0),
       nvl(m12_cat_vt_months_since_last_donation, 0),
       nvl(m12_cat_vt_number_of_donation, 0),
       nvl(m12_cat_vt_dollar_donation, 0),
       nvl(m12_cat_vt_avg_dollar_donation, 0),
       nvl(m12_cat_nt_months_since_last_donation, 0),
       nvl(m12_cat_nt_number_of_donation, 0),
       nvl(m12_cat_nt_dollar_donation, 0),
       nvl(m12_cat_nt_avg_dollar_donation, 0),
       nvl(m12_cat_co_months_since_last_donation, 0),
       nvl(m12_cat_co_number_of_donation, 0),
       nvl(m12_cat_co_dollar_donation, 0),
       nvl(m12_cat_co_avg_dollar_donation, 0),
       nvl(m12_cat_li_months_since_last_donation, 0),
       nvl(m12_cat_li_number_of_donation, 0),
       nvl(m12_cat_li_dollar_donation, 0),
       nvl(m12_cat_li_avg_dollar_donation, 0),
       nvl(m12_cat_ss_months_since_last_donation, 0),
       nvl(m12_cat_ss_number_of_donation, 0),
       nvl(m12_cat_ss_dollar_donation, 0),
       nvl(m12_cat_ss_avg_dollar_donation, 0),
       nvl(m12_cat_rd_months_since_last_donation, 0),
       nvl(m12_cat_rd_number_of_donation, 0),
       nvl(m12_cat_rd_dollar_donation, 0),
       nvl(m12_cat_rd_avg_dollar_donation, 0),
       nvl(m12_cat_ri_months_since_last_donation, 0),
       nvl(m12_cat_ri_number_of_donation, 0),
       nvl(m12_cat_ri_dollar_donation, 0),
       nvl(m12_cat_ri_avg_dollar_donation, 0),
       nvl(m12_cat_ac_months_since_last_donation, 0),
       nvl(m12_cat_ac_number_of_donation, 0),
       nvl(m12_cat_ac_dollar_donation, 0),
       nvl(m12_cat_ac_avg_dollar_donation, 0),
       nvl(m12_cat_cd_months_since_last_donation, 0),
       nvl(m12_cat_cd_number_of_donation, 0),
       nvl(m12_cat_cd_dollar_donation, 0),
       nvl(m12_cat_cd_avg_dollar_donation, 0),
       nvl(m12_cat_cs_months_since_last_donation, 0),
       nvl(m12_cat_cs_number_of_donation, 0),
       nvl(m12_cat_cs_dollar_donation, 0),
       nvl(m12_cat_cs_avg_dollar_donation, 0),
       nvl(m12_cat_rc_months_since_last_donation, 0),
       nvl(m12_cat_rc_number_of_donation, 0),
       nvl(m12_cat_rc_dollar_donation, 0),
       nvl(m12_cat_rc_avg_dollar_donation, 0),
       nvl(m12_cat_rj_months_since_last_donation, 0),
       nvl(m12_cat_rj_number_of_donation, 0),
       nvl(m12_cat_rj_dollar_donation, 0),
       nvl(m12_cat_rj_avg_dollar_donation, 0),
       nvl(m12_cat_ea_months_since_last_donation, 0),
       nvl(m12_cat_ea_number_of_donation, 0),
       nvl(m12_cat_ea_dollar_donation, 0),
       nvl(m12_cat_ea_avg_dollar_donation, 0),
       nvl(m12_cat_pa_months_since_last_donation, 0),
       nvl(m12_cat_pa_number_of_donation, 0),
       nvl(m12_cat_pa_dollar_donation, 0),
       nvl(m12_cat_pa_avg_dollar_donation, 0),
       nvl(m24_number_of_list_sources, 0),
       nvl(m24_highest_donation_amount, 0),
       nvl(m24_lowest_donation_amount, 0),
       nvl(m24_total_number_of_donations, 0),
       nvl(m24_total_dollar_donations, 0),
       nvl(m24_average_donation_per_transaction, 0),
       nvl(m48_number_of_list_sources, 0),
       nvl(m48_highest_donation_amount, 0),
       nvl(m48_lowest_donation_amount, 0),
       nvl(m48_total_number_of_donations, 0),
       nvl(m48_total_dollar_donations, 0),
       nvl(m48_average_donation_per_transaction, 0),
       nvl(m48_average_days_between_donations, 0),
       nvl(m48_number_of_donation_dollar_1_4_amount, 0),
       nvl(m48_number_of_donation_dollar_5_9_amount, 0),
       nvl(m48_number_of_donation_dollar_10_14_amount, 0),
       nvl(m48_number_of_donation_dollar_15_24_amount, 0),
       nvl(m48_number_of_donation_dollar_25_49_amount, 0),
       nvl(m48_number_of_donation_dollar_50_99_amount, 0),
       nvl(m48_number_of_donation_dollar_100_249_amount, 0),
       nvl(m48_number_of_donation_dollar_250_499_amount, 0),
       nvl(m48_number_of_donation_dollar_500_more_amount, 0),
       nvl(m48_number_of_donation_dollar_cash, 0),
       nvl(m48_number_of_donation_dollar_check, 0),
       nvl(m48_number_of_donation_dollar_visa, 0),
       nvl(m48_number_of_donation_dollar_master_card, 0),
       nvl(m48_number_of_donation_dollar_amex, 0),
       nvl(m48_number_of_donation_dollar_other, 0),
       nvl(m48_number_of_donation_via_mail, 0),
       nvl(m48_number_of_donation_via_phone, 0),
       nvl(m48_number_of_donation_via_web, 0),
       nvl(m48_number_of_donation_via_mobile, 0),
       nvl(m48_dollar_donation_via_mail, 0),
       nvl(m48_dollar_donation_via_phone, 0),
       nvl(m48_dollar_donation_via_web, 0),
       nvl(m48_dollar_donation_via_mobile, 0),
       nvl(m48_avg_dollar_donation_via_mail, 0),
       nvl(m48_avg_dollar_donation_via_phone, 0),
       nvl(m48_avg_dollar_donation_via_web, 0),
       nvl(m48_avg_dollar_donation_via_mobile, 0),
       nvl(number_of_donation_january, 0),
       nvl(number_of_donation_february, 0),
       nvl(number_of_donation_march, 0),
       nvl(number_of_donation_april, 0),
       nvl(number_of_donation_may, 0),
       nvl(number_of_donation_june, 0),
       nvl(number_of_donation_july, 0),
       nvl(number_of_donation_august, 0),
       nvl(number_of_donation_september, 0),
       nvl(number_of_donation_october, 0),
       nvl(number_of_donation_november, 0),
       nvl(number_of_donation_december, 0),
       nvl(m48_cat_an_months_since_last_donation, 0),
       nvl(m48_cat_an_number_of_donation, 0),
       nvl(m48_cat_an_dollar_donation, 0),
       nvl(m48_cat_an_avg_dollar_donation, 0),
       nvl(m48_cat_ch_months_since_last_donation, 0),
       nvl(m48_cat_ch_number_of_donation, 0),
       nvl(m48_cat_ch_dollar_donation, 0),
       nvl(m48_cat_ch_avg_dollar_donation, 0),
       nvl(m48_cat_cg_months_since_last_donation, 0),
       nvl(m48_cat_cg_number_of_donation, 0),
       nvl(m48_cat_cg_dollar_donation, 0),
       nvl(m48_cat_cg_avg_dollar_donation, 0),
       nvl(m48_cat_hg_months_since_last_donation, 0),
       nvl(m48_cat_hg_number_of_donation, 0),
       nvl(m48_cat_hg_dollar_donation, 0),
       nvl(m48_cat_hg_avg_dollar_donation, 0),
       nvl(m48_cat_hs_months_since_last_donation, 0),
       nvl(m48_cat_hs_number_of_donation, 0),
       nvl(m48_cat_hs_dollar_donation, 0),
       nvl(m48_cat_hs_avg_dollar_donation, 0),
       nvl(m48_cat_vt_months_since_last_donation, 0),
       nvl(m48_cat_vt_number_of_donation, 0),
       nvl(m48_cat_vt_dollar_donation, 0),
       nvl(m48_cat_vt_avg_dollar_donation, 0),
       nvl(m48_cat_nt_months_since_last_donation, 0),
       nvl(m48_cat_nt_number_of_donation, 0),
       nvl(m48_cat_nt_dollar_donation, 0),
       nvl(m48_cat_nt_avg_dollar_donation, 0),
       nvl(m48_cat_co_months_since_last_donation, 0),
       nvl(m48_cat_co_number_of_donation, 0),
       nvl(m48_cat_co_dollar_donation, 0),
       nvl(m48_cat_co_avg_dollar_donation, 0),
       nvl(m48_cat_li_months_since_last_donation, 0),
       nvl(m48_cat_li_number_of_donation, 0),
       nvl(m48_cat_li_dollar_donation, 0),
       nvl(m48_cat_li_avg_dollar_donation, 0),
       nvl(m48_cat_ss_months_since_last_donation, 0),
       nvl(m48_cat_ss_number_of_donation, 0),
       nvl(m48_cat_ss_dollar_donation, 0),
       nvl(m48_cat_ss_avg_dollar_donation, 0),
       nvl(m48_cat_rd_months_since_last_donation, 0),
       nvl(m48_cat_rd_number_of_donation, 0),
       nvl(m48_cat_rd_dollar_donation, 0),
       nvl(m48_cat_rd_avg_dollar_donation, 0),
       nvl(m48_cat_ri_months_since_last_donation, 0),
       nvl(m48_cat_ri_number_of_donation, 0),
       nvl(m48_cat_ri_dollar_donation, 0),
       nvl(m48_cat_ri_avg_dollar_donation, 0),
       nvl(m48_cat_ac_months_since_last_donation, 0),
       nvl(m48_cat_ac_number_of_donation, 0),
       nvl(m48_cat_ac_dollar_donation, 0),
       nvl(m48_cat_ac_avg_dollar_donation, 0),
       nvl(m48_cat_cd_months_since_last_donation, 0),
       nvl(m48_cat_cd_number_of_donation, 0),
       nvl(m48_cat_cd_dollar_donation, 0),
       nvl(m48_cat_cd_avg_dollar_donation, 0),
       nvl(m48_cat_cs_months_since_last_donation, 0),
       nvl(m48_cat_cs_number_of_donation, 0),
       nvl(m48_cat_cs_dollar_donation, 0),
       nvl(m48_cat_cs_avg_dollar_donation, 0),
       nvl(m48_cat_rc_months_since_last_donation, 0),
       nvl(m48_cat_rc_number_of_donation, 0),
       nvl(m48_cat_rc_dollar_donation, 0),
       nvl(m48_cat_rc_avg_dollar_donation, 0),
       nvl(m48_cat_rj_months_since_last_donation, 0),
       nvl(m48_cat_rj_number_of_donation, 0),
       nvl(m48_cat_rj_dollar_donation, 0),
       nvl(m48_cat_rj_avg_dollar_donation, 0),
       nvl(m48_cat_ea_months_since_last_donation, 0),
       nvl(m48_cat_ea_number_of_donation, 0),
       nvl(m48_cat_ea_dollar_donation, 0),
       nvl(m48_cat_ea_avg_dollar_donation, 0),
       nvl(m48_cat_pa_months_since_last_donation, 0),
       nvl(m48_cat_pa_number_of_donation, 0),
       nvl(m48_cat_pa_dollar_donation, 0),
       nvl(m48_cat_pa_avg_dollar_donation, 0),
       nvl(m12_cat_tot_an_months_since_last_donation, 0),
       nvl(m12_cat_tot_an_number_of_donation, 0),
       nvl(m12_cat_tot_an_dollar_donation, 0),
       nvl(m12_cat_tot_an_avg_dollar_donation, 0),
       nvl(m12_cat_tot_ch_months_since_last_donation, 0),
       nvl(m12_cat_tot_ch_number_of_donation, 0),
       nvl(m12_cat_tot_ch_dollar_donation, 0),
       nvl(m12_cat_tot_ch_avg_dollar_donation, 0),
       nvl(m12_cat_tot_cg_months_since_last_donation, 0),
       nvl(m12_cat_tot_cg_number_of_donation, 0),
       nvl(m12_cat_tot_cg_dollar_donation, 0),
       nvl(m12_cat_tot_cg_avg_dollar_donation, 0),
       nvl(m12_cat_tot_hg_months_since_last_donation, 0),
       nvl(m12_cat_tot_hg_number_of_donation, 0),
       nvl(m12_cat_tot_hg_dollar_donation, 0),
       nvl(m12_cat_tot_hg_avg_dollar_donation, 0),
       nvl(m12_cat_tot_hs_months_since_last_donation, 0),
       nvl(m12_cat_tot_hs_number_of_donation, 0),
       nvl(m12_cat_tot_hs_dollar_donation, 0),
       nvl(m12_cat_tot_hs_avg_dollar_donation, 0),
       nvl(m12_cat_tot_vt_months_since_last_donation, 0),
       nvl(m12_cat_tot_vt_number_of_donation, 0),
       nvl(m12_cat_tot_vt_dollar_donation, 0),
       nvl(m12_cat_tot_vt_avg_dollar_donation, 0),
       nvl(m12_cat_tot_nt_months_since_last_donation, 0),
       nvl(m12_cat_tot_nt_number_of_donation, 0),
       nvl(m12_cat_tot_nt_dollar_donation, 0),
       nvl(m12_cat_tot_nt_avg_dollar_donation, 0),
       nvl(m12_cat_tot_co_months_since_last_donation, 0),
       nvl(m12_cat_tot_co_number_of_donation, 0),
       nvl(m12_cat_tot_co_dollar_donation, 0),
       nvl(m12_cat_tot_co_avg_dollar_donation, 0),
       nvl(m12_cat_tot_li_months_since_last_donation, 0),
       nvl(m12_cat_tot_li_number_of_donation, 0),
       nvl(m12_cat_tot_li_dollar_donation, 0),
       nvl(m12_cat_tot_li_avg_dollar_donation, 0),
       nvl(m12_cat_tot_ss_months_since_last_donation, 0),
       nvl(m12_cat_tot_ss_number_of_donation, 0),
       nvl(m12_cat_tot_ss_dollar_donation, 0),
       nvl(m12_cat_tot_ss_avg_dollar_donation, 0),
       nvl(m12_cat_tot_rd_months_since_last_donation, 0),
       nvl(m12_cat_tot_rd_number_of_donation, 0),
       nvl(m12_cat_tot_rd_dollar_donation, 0),
       nvl(m12_cat_tot_rd_avg_dollar_donation, 0),
       nvl(m12_cat_tot_ri_months_since_last_donation, 0),
       nvl(m12_cat_tot_ri_number_of_donation, 0),
       nvl(m12_cat_tot_ri_dollar_donation, 0),
       nvl(m12_cat_tot_ri_avg_dollar_donation, 0),
       nvl(m12_cat_tot_ac_months_since_last_donation, 0),
       nvl(m12_cat_tot_ac_number_of_donation, 0),
       nvl(m12_cat_tot_ac_dollar_donation, 0),
       nvl(m12_cat_tot_ac_avg_dollar_donation, 0),
       nvl(m12_cat_tot_cd_months_since_last_donation, 0),
       nvl(m12_cat_tot_cd_number_of_donation, 0),
       nvl(m12_cat_tot_cd_dollar_donation, 0),
       nvl(m12_cat_tot_cd_avg_dollar_donation, 0),
       nvl(m12_cat_tot_cs_months_since_last_donation, 0),
       nvl(m12_cat_tot_cs_number_of_donation, 0),
       nvl(m12_cat_tot_cs_dollar_donation, 0),
       nvl(m12_cat_tot_cs_avg_dollar_donation, 0),
       nvl(m12_cat_tot_rc_months_since_last_donation, 0),
       nvl(m12_cat_tot_rc_number_of_donation, 0),
       nvl(m12_cat_tot_rc_dollar_donation, 0),
       nvl(m12_cat_tot_rc_avg_dollar_donation, 0),
       nvl(m12_cat_tot_rj_months_since_last_donation, 0),
       nvl(m12_cat_tot_rj_number_of_donation, 0),
       nvl(m12_cat_tot_rj_dollar_donation, 0),
       nvl(m12_cat_tot_rj_avg_dollar_donation, 0),
       nvl(m12_cat_tot_ea_months_since_last_donation, 0),
       nvl(m12_cat_tot_ea_number_of_donation, 0),
       nvl(m12_cat_tot_ea_dollar_donation, 0),
       nvl(m12_cat_tot_ea_avg_dollar_donation, 0),
       nvl(m12_cat_tot_pa_months_since_last_donation, 0),
       nvl(m12_cat_tot_pa_number_of_donation, 0),
       nvl(m12_cat_tot_pa_dollar_donation, 0),
       nvl(m12_cat_tot_pa_avg_dollar_donation, 0),
       nvl(m48_cat_tot_an_months_since_last_donation, 0),
       nvl(m48_cat_tot_an_number_of_donation, 0),
       nvl(m48_cat_tot_an_dollar_donation, 0),
       nvl(m48_cat_tot_an_avg_dollar_donation, 0),
       nvl(m48_cat_tot_ch_months_since_last_donation, 0),
       nvl(m48_cat_tot_ch_number_of_donation, 0),
       nvl(m48_cat_tot_ch_dollar_donation, 0),
       nvl(m48_cat_tot_ch_avg_dollar_donation, 0),
       nvl(m48_cat_tot_cg_months_since_last_donation, 0),
       nvl(m48_cat_tot_cg_number_of_donation, 0),
       nvl(m48_cat_tot_cg_dollar_donation, 0),
       nvl(m48_cat_tot_cg_avg_dollar_donation, 0),
       nvl(m48_cat_tot_hg_months_since_last_donation, 0),
       nvl(m48_cat_tot_hg_number_of_donation, 0),
       nvl(m48_cat_tot_hg_dollar_donation, 0),
       nvl(m48_cat_tot_hg_avg_dollar_donation, 0),
       nvl(m48_cat_tot_hs_months_since_last_donation, 0),
       nvl(m48_cat_tot_hs_number_of_donation, 0),
       nvl(m48_cat_tot_hs_dollar_donation, 0),
       nvl(m48_cat_tot_hs_avg_dollar_donation, 0),
       nvl(m48_cat_tot_vt_months_since_last_donation, 0),
       nvl(m48_cat_tot_vt_number_of_donation, 0),
       nvl(m48_cat_tot_vt_dollar_donation, 0),
       nvl(m48_cat_tot_vt_avg_dollar_donation, 0),
       nvl(m48_cat_tot_nt_months_since_last_donation, 0),
       nvl(m48_cat_tot_nt_number_of_donation, 0),
       nvl(m48_cat_tot_nt_dollar_donation, 0),
       nvl(m48_cat_tot_nt_avg_dollar_donation, 0),
       nvl(m48_cat_tot_co_months_since_last_donation, 0),
       nvl(m48_cat_tot_co_number_of_donation, 0),
       nvl(m48_cat_tot_co_dollar_donation, 0),
       nvl(m48_cat_tot_co_avg_dollar_donation, 0),
       nvl(m48_cat_tot_li_months_since_last_donation, 0),
       nvl(m48_cat_tot_li_number_of_donation, 0),
       nvl(m48_cat_tot_li_dollar_donation, 0),
       nvl(m48_cat_tot_li_avg_dollar_donation, 0),
       nvl(m48_cat_tot_ss_months_since_last_donation, 0),
       nvl(m48_cat_tot_ss_number_of_donation, 0),
       nvl(m48_cat_tot_ss_dollar_donation, 0),
       nvl(m48_cat_tot_ss_avg_dollar_donation, 0),
       nvl(m48_cat_tot_rd_months_since_last_donation, 0),
       nvl(m48_cat_tot_rd_number_of_donation, 0),
       nvl(m48_cat_tot_rd_dollar_donation, 0),
       nvl(m48_cat_tot_rd_avg_dollar_donation, 0),
       nvl(m48_cat_tot_ri_months_since_last_donation, 0),
       nvl(m48_cat_tot_ri_number_of_donation, 0),
       nvl(m48_cat_tot_ri_dollar_donation, 0),
       nvl(m48_cat_tot_ri_avg_dollar_donation, 0),
       nvl(m48_cat_tot_ac_months_since_last_donation, 0),
       nvl(m48_cat_tot_ac_number_of_donation, 0),
       nvl(m48_cat_tot_ac_dollar_donation, 0),
       nvl(m48_cat_tot_ac_avg_dollar_donation, 0),
       nvl(m48_cat_tot_cd_months_since_last_donation, 0),
       nvl(m48_cat_tot_cd_number_of_donation, 0),
       nvl(m48_cat_tot_cd_dollar_donation, 0),
       nvl(m48_cat_tot_cd_avg_dollar_donation, 0),
       nvl(m48_cat_tot_cs_months_since_last_donation, 0),
       nvl(m48_cat_tot_cs_number_of_donation, 0),
       nvl(m48_cat_tot_cs_dollar_donation, 0),
       nvl(m48_cat_tot_cs_avg_dollar_donation, 0),
       nvl(m48_cat_tot_rc_months_since_last_donation, 0),
       nvl(m48_cat_tot_rc_number_of_donation, 0),
       nvl(m48_cat_tot_rc_dollar_donation, 0),
       nvl(m48_cat_tot_rc_avg_dollar_donation, 0),
       nvl(m48_cat_tot_rj_months_since_last_donation, 0),
       nvl(m48_cat_tot_rj_number_of_donation, 0),
       nvl(m48_cat_tot_rj_dollar_donation, 0),
       nvl(m48_cat_tot_rj_avg_dollar_donation, 0),
       nvl(m48_cat_tot_ea_months_since_last_donation, 0),
       nvl(m48_cat_tot_ea_number_of_donation, 0),
       nvl(m48_cat_tot_ea_dollar_donation, 0),
       nvl(m48_cat_tot_ea_avg_dollar_donation, 0),
       nvl(m48_cat_tot_pa_months_since_last_donation, 0),
       nvl(m48_cat_tot_pa_number_of_donation, 0),
       nvl(m48_cat_tot_pa_dollar_donation, 0),
       nvl(m48_cat_tot_pa_avg_dollar_donation, 0)
--       ,hh_status_code  -- 20221010 CB
from exclude_sum_ltd_np ltd2
left outer join exclude_sum_cat_np cat2 on ltd2.company_id = cat2.company_id
inner join  ctas_cons_unv_compid_tobedropped m on ltd2.company_id = m.company_id and nvl(m.lems,'''') != '''' ')
    to 's3://{s3-apogee}{export_mmdb_2}'
    iam_role '{iam}'
    encrypted
    cleanpath
    gzip
    delimiter as '|';


insert into apogee_export_count
    (tablename, record_count)
select 'nonprofit_hh_summary', count(*)
from exclude_sum_ltd_np ltd2
left outer join exclude_sum_cat_np cat2 on ltd2.company_id = cat2.company_id
inner join  ctas_cons_unv_compid_tobedropped m on ltd2.company_id = m.company_id and nvl(m.lems,'') != '';

