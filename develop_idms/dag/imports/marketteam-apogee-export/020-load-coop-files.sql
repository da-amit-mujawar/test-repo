--apogee file has been created by export dag no need to load
/*
--create apg file
DROP TABLE IF EXISTS {coopapg};

CREATE TABLE {coopapg} (
Company_Id varchar(18) ENCODE ZSTD,
LEMSMatchCode varchar(18) ENCODE ZSTD,
LTD_First_Donation_Date varchar(8) ENCODE ZSTD,
LTD_Last_Donation_Date varchar(8) ENCODE ZSTD,
LTD_Months_Since_First_Donation_Date varchar(10) ENCODE ZSTD,
LTD_Months_Since_Last_Donation_Date varchar(10) ENCODE BYTEDICT,
LTD_Number_Of_Donations_Past_30_Days varchar(10) ENCODE ZSTD,
LTD_Number_Of_Donations_2_3_Months_Ago varchar(10) ENCODE ZSTD,
LTD_Number_Of_Donations_4_6_Months_Ago varchar(10) ENCODE ZSTD,
LTD_Number_Of_Donations_7_12_Months_Ago varchar(10) ENCODE ZSTD,
LTD_Number_Of_Donations_13_24_Months_Ago varchar(10) ENCODE ZSTD,
LTD_Number_Of_Donations_Over_24_Months_Ago varchar(10) ENCODE ZSTD,
LTD_Number_Of_Donations_0_3_Months_Ago varchar(10) ENCODE ZSTD,
LTD_Number_Of_Donations_0_6_Months_Ago varchar(10) ENCODE ZSTD,
LTD_Number_Of_Donations_0_12_Months_Ago varchar(10) ENCODE ZSTD,
LTD_Number_Of_Donations_0_24_Months_Ago varchar(10) ENCODE ZSTD,
LTD_Last_Payment_Method varchar(2) ENCODE ZSTD,
LTD_Last_Response_Channel varchar(2) ENCODE ZSTD,
LTD_Number_Of_List_Sources varchar(10) ENCODE ZSTD,
LTD_Highest_Donation_Amount_Ever varchar(10) ENCODE ZSTD,
LTD_Lowest_Donation_Amount_Ever varchar(10) ENCODE BYTEDICT,
LTD_Total_Number_Of_Donations varchar(10) ENCODE ZSTD,
LTD_Total_Dollar_Donations varchar(10) ENCODE ZSTD,
LTD_Average_Donation_Per_Transaction varchar(10) ENCODE ZSTD,
LTD_Months_Since_Last_Donation_Mail varchar(10) ENCODE ZSTD,
LTD_Months_Since_Last_Donation_Phone varchar(10) ENCODE ZSTD,
LTD_Months_Since_Last_Donation_Web varchar(10) ENCODE ZSTD,
LTD_Months_Since_Last_Donation_Mobile varchar(10) ENCODE ZSTD,
M12_Number_Of_List_Sources varchar(10) ENCODE ZSTD,
M12_Highest_Donation_Amount varchar(10) ENCODE ZSTD,
M12_Lowest_Donation_Amount varchar(10) ENCODE ZSTD,
M12_Total_Number_Of_Donations varchar(10) ENCODE ZSTD,
M12_Total_Dollar_Donations varchar(10) ENCODE ZSTD,
M12_Average_Donation_Per_Transaction varchar(10) ENCODE ZSTD,
M12_CAT_AN_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_AN_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_AN_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_AN_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_CH_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_CH_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_CH_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_CH_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_CG_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_CG_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_CG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_CG_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_HG_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_HG_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_HG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_HG_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_HS_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_HS_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_HS_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_HS_AVG_Dollar_Donation varchar(50) ENCODE ZSTD,
M12_CAT_VE_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_VE_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_VE_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_VE_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_NT_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_NT_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_NT_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_NT_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_CO_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_CO_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_CO_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_CO_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_LI_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_LI_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_LI_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_LI_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_SS_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_SS_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_SS_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_SS_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_RD_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_RD_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_RD_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_RD_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_RI_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_RI_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_RI_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_RI_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_AC_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_AC_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_AC_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_AC_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_CD_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_CD_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_CD_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_CD_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_CS_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_CS_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_CS_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_CS_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_RC_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_RC_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_RC_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_RC_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_RJ_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_RJ_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_RJ_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_RJ_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_EA_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_EA_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_EA_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_EA_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_PA_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_PA_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_PA_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_PA_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M24_Number_Of_List_Sources varchar(10) ENCODE ZSTD,
M24_Highest_Donation_Amount varchar(10) ENCODE ZSTD,
M24_Lowest_Donation_Amount varchar(10) ENCODE BYTEDICT,
M24_Total_Number_Of_Donations varchar(10) ENCODE ZSTD,
M24_Total_Dollar_Donations varchar(10) ENCODE ZSTD,
M24_Average_Donation_Per_Transaction varchar(10) ENCODE ZSTD,
M48_Number_Of_List_Sources varchar(10) ENCODE ZSTD,
M48_Highest_Donation_Amount varchar(10) ENCODE BYTEDICT,
M48_Lowest_Donation_Amount varchar(10) ENCODE BYTEDICT,
M48_Total_Number_Of_Donations varchar(10) ENCODE ZSTD,
M48_Total_Dollar_Donations varchar(10) ENCODE ZSTD,
M48_Average_Donation_Per_Transaction varchar(10) ENCODE ZSTD,
M48_Average_Days_Between_Donations varchar(10) ENCODE ZSTD,
M48_Number_Of_Donation_Dollar_1_4_Amount varchar(10) ENCODE ZSTD,
M48_Number_Of_Donation_Dollar_5_9_Amount varchar(10) ENCODE ZSTD,
M48_Number_Of_Donation_Dollar_10_14_Amount varchar(10) ENCODE ZSTD,
M48_Number_Of_Donation_Dollar_15_24_Amount varchar(10) ENCODE ZSTD,
M48_Number_Of_Donation_Dollar_25_49_Amount varchar(10) ENCODE ZSTD,
M48_Number_Of_Donation_Dollar_50_99_Amount varchar(10) ENCODE ZSTD,
M48_Number_Of_Donation_Dollar_100_249_Amount varchar(10) ENCODE ZSTD,
M48_Number_Of_Donation_Dollar_250_499_Amount varchar(10) ENCODE ZSTD,
M48_Number_Of_Donation_Dollar_500_More_Amount varchar(10) ENCODE ZSTD,
M48_Number_Of_Donation_Dollar_Cash varchar(10) ENCODE ZSTD,
M48_Number_Of_Donation_Dollar_Check varchar(10) ENCODE ZSTD,
M48_Number_Of_Donation_Dollar_Visa varchar(10) ENCODE ZSTD,
M48_Number_Of_Donation_Dollar_Master_Card varchar(10) ENCODE ZSTD,
M48_Number_Of_Donation_Dollar_AMEX varchar(10) ENCODE ZSTD,
M48_Number_Of_Donation_Dollar_Other varchar(10) ENCODE ZSTD,
M48_Number_Of_Donation_Via_Mail varchar(10) ENCODE ZSTD,
M48_Number_Of_Donation_Via_Phone varchar(10) ENCODE ZSTD,
M48_Number_Of_Donation_Via_Web varchar(10) ENCODE ZSTD,
M48_Number_Of_Donation_Via_Mobile varchar(10) ENCODE ZSTD,
M48_Dollar_Donation_Via_Mail varchar(10) ENCODE ZSTD,
M48_Dollar_Donation_Via_Phone varchar(10) ENCODE ZSTD,
M48_Dollar_Donation_Via_Web varchar(10) ENCODE ZSTD,
M48_Dollar_Donation_Via_Mobile varchar(10) ENCODE ZSTD,
M48_AVG_Dollar_Donation_Via_Mail varchar(10) ENCODE ZSTD,
M48_AVG_Dollar_Donation_Via_Phone varchar(10) ENCODE ZSTD,
M48_AVG_Dollar_Donation_Via_Web varchar(10) ENCODE ZSTD,
M48_AVG_Dollar_Donation_Via_Mobile varchar(10) ENCODE ZSTD,
Number_Of_Donation_January varchar(10) ENCODE ZSTD,
Number_Of_Donation_February varchar(10) ENCODE ZSTD,
Number_Of_Donation_March varchar(10) ENCODE ZSTD,
Number_Of_Donation_April varchar(10) ENCODE ZSTD,
Number_Of_Donation_May varchar(10) ENCODE ZSTD,
Number_Of_Donation_June varchar(10) ENCODE ZSTD,
Number_Of_Donation_July varchar(10) ENCODE ZSTD,
Number_Of_Donation_August varchar(10) ENCODE ZSTD,
Number_Of_Donation_September varchar(10) ENCODE ZSTD,
Number_Of_Donation_October varchar(10) ENCODE ZSTD,
Number_Of_Donation_November varchar(10) ENCODE ZSTD,
Number_Of_Donation_December varchar(10) ENCODE ZSTD,
M48_CAT_AN_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_AN_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_AN_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_AN_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_CH_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_CH_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_CH_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_CH_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_CG_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_CG_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_CG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_CG_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_HG_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_HG_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_HG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_HG_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_HS_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_HS_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_HS_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_HS_AVG_Dollar_Donation varchar(50) ENCODE ZSTD,
M48_CAT_VE_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_VE_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_VE_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_VE_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_NT_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_NT_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_NT_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_NT_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_CO_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_CO_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_CO_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_CO_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_LI_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_LI_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_LI_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_LI_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_SS_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_SS_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_SS_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_SS_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_RD_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_RD_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_RD_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_RD_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_RI_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_RI_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_RI_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_RI_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_AC_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_AC_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_AC_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_AC_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_CD_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_CD_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_CD_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_CD_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_CS_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_CS_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_CS_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_CS_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_RC_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_RC_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_RC_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_RC_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_RJ_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_RJ_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_RJ_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_RJ_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_EA_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_EA_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_EA_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_EA_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_PA_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_PA_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_PA_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_PA_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_AN_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_AN_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_AN_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_AN_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_CH_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_CH_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_CH_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_CH_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_CG_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_CG_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_CG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_CG_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_HG_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_HG_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_HG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_HG_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_HS_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_HS_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_HS_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_HS_AVG_Dollar_Donation varchar(50) ENCODE ZSTD,
M12_CAT_TOT_VE_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_VE_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_VE_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_VE_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_NT_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_NT_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_NT_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_NT_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_CO_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_CO_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_CO_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_CO_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_LI_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_LI_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_LI_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_LI_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_SS_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_SS_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_SS_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_SS_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_RD_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_RD_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_RD_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_RD_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_RI_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_RI_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_RI_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_RI_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_AC_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_AC_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_AC_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_AC_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_CD_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_CD_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_CD_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_CD_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_CS_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_CS_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_CS_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_CS_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_RC_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_RC_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_RC_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_RC_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_RJ_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_RJ_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_RJ_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_RJ_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_EA_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_EA_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_EA_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_EA_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_PA_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_PA_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_PA_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_PA_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_AN_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_AN_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_AN_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_AN_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_CH_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_CH_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_CH_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_CH_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_CG_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_CG_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_CG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_CG_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_HG_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_HG_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_HG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_HG_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_HS_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_HS_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_HS_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_HS_AVG_Dollar_Donation varchar(50) ENCODE ZSTD,
M48_CAT_TOT_VE_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_VE_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_VE_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_VE_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_NT_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_NT_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_NT_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_NT_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_CO_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_CO_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_CO_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_CO_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_LI_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_LI_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_LI_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_LI_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_SS_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_SS_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_SS_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_SS_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_RD_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_RD_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_RD_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_RD_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_RI_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_RI_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_RI_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_RI_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_AC_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_AC_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_AC_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_AC_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_CD_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_CD_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_CD_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_CD_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_CS_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_CS_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_CS_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_CS_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_RC_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_RC_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_RC_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_RC_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_RJ_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_RJ_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_RJ_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_RJ_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_EA_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_EA_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_EA_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_EA_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_PA_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_PA_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_PA_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_PA_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_ET_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_ET_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_SW_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_SW_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_ET_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_ET_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_SW_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_SW_Number_Of_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_ET_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_ET_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_SW_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_SW_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_ET_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_ET_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_SW_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M48_CAT_TOT_SW_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_ET_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_ET_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_SW_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_SW_Months_Since_Last_Donation varchar(10) ENCODE ZSTD,
M12_CAT_ET_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_ET_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_SW_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_SW_Number_Of_Donation varchar(10) ENCODE ZSTD,
M12_CAT_ET_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_ET_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_SW_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_SW_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_ET_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_ET_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_TOT_SW_AVG_Dollar_Donation varchar(10) ENCODE ZSTD,
M12_CAT_SW_AVG_Dollar_Donation varchar(10));

COPY {coopapg}
--from 's3://idms-7933-apogee/exports/nonprofit_hh_summary_nodedupe/'
FROM 's3://idms-2722-apogee/exports/nonprofit_hh_summary_nodedupe/nonprofit_hh_summary_nodedupe'
IAM_ROLE '{iam}'
IGNOREHEADER 1
DELIMITER '|'
GZIP
ACCEPTINVCHARS
MAXERROR 1000
;

*/
--use files loaded by export dag

INSERT INTO {table_job_stats}
SELECT 'Load NonProfit_Summary_NoDedupe_Full',count(*),getdate() FROM exclude_apogee_np_summ_nodedupe;


--create apg file
DROP TABLE IF EXISTS {coopmgen};

CREATE TABLE {coopmgen} (
individual_id varchar(18) ENCODE ZSTD,
company_id varchar(12) ENCODE ZSTD,
lemsmatchcode varchar(18) ENCODE ZSTD,
LAST_TRANSACTION_OVERALL_DAYS varchar(5) ENCODE ZSTD,
TOT_PARTS varchar(9) ENCODE BYTEDICT,
TOT_DLRS_12M varchar(10) ENCODE ZSTD,
TOT_TRNS_12M varchar(9) ENCODE ZSTD,
TOT_DLRS_LT varchar(10) ENCODE ZSTD,
TOT_TRNS_LT varchar(3) ENCODE BYTEDICT,
TOT_DLRS_12M_AVG varchar(10) ENCODE ZSTD,
TOT_DLRS_LT_AVG varchar(10) ENCODE ZSTD,
LAST_TRANSACTION_CATALOG_DAYS varchar(5) ENCODE ZSTD,
CAT_PART varchar(9) ENCODE ZSTD,
CAT_DLRS_12M varchar(10) ENCODE ZSTD,
CAT_TRNS_12M varchar(9) ENCODE ZSTD,
CAT_DLRS_LT varchar(10) ENCODE ZSTD,
CAT_TRNS_LT varchar(3) ENCODE ZSTD,
CAT_DLRS_12M_AVG varchar(10) ENCODE ZSTD,
CAT_DLRS_LT_AVG varchar(10) ENCODE ZSTD,
LAST_TRANSACTION_WEB_DAYS varchar(5) ENCODE ZSTD,
WEB_PARTS varchar(9) ENCODE ZSTD,
WEB_DLRS_12M varchar(10) ENCODE ZSTD,
WEB_TRNS_12M varchar(9) ENCODE ZSTD,
WEB_DLRS_LT varchar(10) ENCODE ZSTD,
WEB_TRNS_LT varchar(3) ENCODE ZSTD,
WEB_DLRS_12M_AVG varchar(10) ENCODE ZSTD,
WEB_DLRS_LT_AVG varchar(10) ENCODE ZSTD,
LAST_TRANSACTION_RETAIL_DAYS varchar(5) ENCODE ZSTD,
RTL_PARTS varchar(9) ENCODE ZSTD,
RTL_DLRS_12M varchar(10) ENCODE ZSTD,
RTL_TRNS_12M varchar(9) ENCODE ZSTD,
RTL_DLRS_LT varchar(10) ENCODE ZSTD,
RTL_TRNS_LT varchar(3) ENCODE ZSTD,
RTL_DLRS_12M_AVG varchar(10) ENCODE ZSTD,
RTL_DLRS_LT_AVG varchar(10) ENCODE ZSTD,
NEXTACTION_ID varchar(60) ENCODE ZSTD,
LEMS varchar(18) ENCODE ZSTD,
PAID_12MONTH_PC varchar(1) ENCODE ZSTD,
PAID_12MONTH_CC varchar(1) ENCODE ZSTD,
PAID_12MONTH_CASH varchar(1));

COPY {coopmgen}
FROM 's3://{s3-apogee}/exports/nonprofit_mgen/'
--FROM 's3://idms-2722-apogee/exports/nonprofit_mgen/nonprofit_mgen'
IAM_ROLE '{iam}'
IGNOREHEADER 1
DELIMITER '|'
GZIP
ACCEPTINVCHARS
MAXERROR 1000
;


INSERT INTO {table_job_stats}
SELECT 'Load NonProfit_MGen_Full',count(*),getdate() FROM {coopmgen};

INSERT INTO {table_job_stats}
SELECT 'NonProfit_Summary_NoDedupe_Full to Consumer',count(*),getdate() FROM {coopapg} WHERE company_id IN (SELECT familyid FROM {tablename2});
INSERT INTO {table_job_stats}
SELECT 'NonProfit_MGen_Full Matches to Consumer',count(*),getdate() FROM {coopmgen} WHERE individual_id IN (SELECT individualid FROM {tablename2});
