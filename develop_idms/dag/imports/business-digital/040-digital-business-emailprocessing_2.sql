---Counts are recorded  Production,QA

select COUNT(*) Count from digital.business_sic_fullset;
---82785420,  ---QA 235563

drop table if exists digital.business_flag_ecdata2;

create table digital.business_flag_ecdata2 as
select b.* , x.s_truefranchiseflag
from digital.my_business_fullset b
  LEFT OUTER join    (select abinumber, s_truefranchiseflag
   from digital.business_sic_fullset
  where ltrim(rtrim(s_truefranchiseflag)) != ''
     group by abinumber, s_truefranchiseflag
	    ) as X  on ( b.abinumber = x.abinumber);
---(64,890,024 row(s) affected) 00:41:57  ---QA (181519 row(s) affected)


--remove duplicated on name and address , keep dupes with move_ind=' ' apply employee size
drop table if exists digital.drop_dupe;

create table digital.drop_dupe as
select b.id, move_ind
from digital.business_email_fullset b join
(
select b.firstname , b.lastname , emailaddress, Editedaddress,city,state,zipcode,zipfour
from digital.business_email_fullset b
where ltrim(rtrim(firstname)) != ''
and (abinumber = '000000000' or ltrim(rtrim(abinumber)) = '')
group by b.firstname , b.lastname , emailaddress, Editedaddress , city,state,zipcode,zipfour
having count(*) > 1
  ) c on
(
b.firstname = c.firstname
AND b.lastname = c.lastname
AND b.emailaddress = c.emailaddress
AND b.Editedaddress = c.Editedaddress
AND b.city = c.city
AND b.state = c.state
AND b.zipcode = c.zipcode
AND b.zipfour = c.zipfour
  )
  where ltrim(rtrim(move_ind)) != '';

drop table if exists digital.business_email_nonmatches_nodups_aws;

create table digital.business_email_nonmatches_nodups_aws as
select e.*, case when s.employeesize is null then '9' else s.employeesize end employeesize
from digital.business_email_fullset e
left outer join digital.business_email_nonmatches_employeesize s
on ( e.emailaddress = s.emailaddress)
where ltrim(rtrim(firstname)) != ''
and (abinumber = '000000000' or ltrim(rtrim(abinumber)) = '')
and e.id not in
(select id
from digital.drop_dupe
 );
 --(73447912 rows affected)      ---266171

---select * from digital.business_email_nonmatches_nodups_aws limit 1000;

 drop table if exists digital.business_email_nonmatches_segments_aws;

 create table digital.business_email_nonmatches_segments_aws as
select
 right('000000000000000000'+cast(e.id + 199000000000000 as varchar),18) id,
  id   orig_id,
 executivesourcecode e_executivesourcecode,
 ''  e_contactid,
 right('00'+vendorid2,2) e_vendorid2,
 e.abinumber,
  e.individualid,
 e.familyid,
e.firstname e_firstname , e.lastname e_lastname , areacode+phonenumber phonenumber,
case when trim(emailaddress) = '' then emailaddress else md5(lower(trim(emailaddress))) end email,
emailaddress orig_email,
'' m_address_mailing, '' m_city_mailing,
'' m_state_mailing, '' m_zipcode_mailing, '' m_zipfour_mailing,
ltrim(rtrim(housenumber))+' '+ltrim(rtrim(streetpredirectional))+' '+ltrim(rtrim(streetname))+' '+ltrim(rtrim(streetsuffix))+' '+ltrim(rtrim(streetpostdirectional))+' '+ltrim(rtrim(unittype))+' '+ltrim(rtrim(unitnumber)) address,
city,state,zipcode,zipfour,
'' m_address_landmark,
'' m_city_landmark,
'' m_state_landmark,
'' m_zipcode_landmark,
'' m_zipfour_landmark,
'' e_homeaddress,
'' e_homecity,
'' e_homestate,
'' e_homezipcode,
'' e_homezip4,
'' fulfillmentflag,
'BUSINESS_EMAIL_NONMATCHES' dataset,
CASE WHEN ( e.titlecode IN ('1','5','9','!','@','C','E','F','I','N','Q','W','Y')    OR ( ( SICCODE >=737000 AND SICCODE <= 737999   )  AND  e.titlecode NOT IN ('8','V','+',']',':','')  ) ) then 1 end B0001,
CASE WHEN ( employeesize >=  1 AND employeesize<= 500 ) AND e.titlecode NOT IN (']'  ,'') then 1 end B0002,
CASE WHEN ( e.titlecode NOT IN (']'  ,'') ) then 1 end B0003,
CASE WHEN (  ( employeesize >=   1  AND employeesize <=  500    )  ) then 1 end B0004,
CASE WHEN (  ( employeesize >=   21  AND employeesize <=  50    )  ) then 1 end B0005,
CASE WHEN ( e.titlecode IN ('$','@','%','1','2','4','9','A','C','D','E','F')  ) then 1 end B0006,
CASE WHEN ( e.titlecode IN ('!','@','=','N','Q')  OR  ( SICCODE >=  737000  AND SICCODE <=  737999   )  OR ( ( employeesize >= 1 AND employeesize <= 10) AND e.titlecode IN ('1','2','3','4','5','9','(',')','[','_','=','>','C','E','F','I','J','K','Q','S','W') ) ) then 1 end B0007,
CASE WHEN ( e.titlecode IN ('1','2','C') ) then 1 end B0008,
CASE WHEN ( e.titlecode IN ('#','F','G','H','O')  OR  ( SICCODE >=  628000  AND SICCODE <=  628999 )  OR  SICCODE IN (  874209 )   ) then 1 end B0009,
CASE WHEN ( e.titlecode IN ('1','5','9','C','E','F','I','W','%','M','Q','R','T')  OR ( SICCODE IN (   179605, 276102, 349301, 353401, 357805, 382507, 394930, 458112, 481210, 481211, 501354, 504437, 504646, 504651, 504653, 504657, 504708, 507521, 507806, 507818, 508342, 508817, 508829, 509334, 515408, 551109, 551110, 555104, 555119, 559917, 573132, 573615, 594105, 594307, 594539, 653133, 729103, 731115, 735308, 738981, 753905, 799310, 811118, 861103, 873203, 874210, 874213, 874214, 874247, 874248, 874259, 874267, 874808, 874810, 874811, 874818  )  AND e.titlecode NOT IN ('8','V','+',']',':','')  ) ) then 1 end B0010,
CASE WHEN ( e.titlecode IN ('1','9') ) then 1 end B0011,
CASE WHEN ( e.titlecode IN ('1','5','9') ) then 1 end B0012,
CASE WHEN (   ( SICCODE >=  800000 AND SICCODE <= 809999 )
 OR  SICCODE IN ( 283407, 283498, 283601, 283602, 308916, 355913, 384301, 384398, 504719, 504917, 512203, 512226, 591205, 591207, 735202, 736116, 769982,
 822109, 822111, 824901, 824906, 862105, 862106, 871177, 873108, 873112, 873115, 873124, 873126, 873127, 874243 )
 OR e.proftitle IN ('AAEM','AAPA','AAPS','ABQAURP','ASOPA','CUPA','EDF','FACCP','NAEMSP','NBCOPA','OPA-C','PA-C','PA','DO','MD','RFDS','FS','ME','OB','DC','DDS','DMD','DPM','DPT','DVM')
 OR  (  e.proftitle IN ('AIN','ANM','ANNA','ANP','AOCN','AORN','APN','APRN','ARN','ARNP','ASN','ASORN','BAA (N)','BAN','BIG','Bsc.N','BSN','CAPA','CARN','CCC','CCRN','CDDN','CDONA/LTC','CEN','CENAs','CETN','CGFNS','CGRN','CHN','CHT RN','CLNC','CN','CNA','CNAA','CNC','CNM','CNN','CNO','CNOR','CNRN','CNS','COHN','COHN-S','CPAN','CPN (C)','CPNP','CPON','CPP','CRANA','CRNA','CRNFA','CRNH','CRNI','CRNO','CRNP','CRRN','CSN','CTN','CUNP','CURN','CWCN','DNSc','DON','DSN','EN','ENA','ENPC','FAAN','FNP','GN','GNP','HNC','IAFN','ICN','INCC','INS','ITNS','LNC','LPN ','LVN','MICN','MN','MNEd','MSN','NA','ND','NENA','NH','NICs','NNNHP','NNP','NOC','NP','NPP','NSYICU','NVSPV','NZNO','OCN','OGP','ONC','PHN','PMH-NP','PN','PNP','RCNA','RGN','RMG','RMN','RN','RNAC','RNC','RNFA','RNMH','RNR','RPN','SN','SRN','TNCC','WHCNP','WHNP','WOCN')
 )  ) then 1 end B0013,
CASE WHEN (   ( SICCODE >= 628101  AND SICCODE <=  628206 )  OR  SICCODE IN (  628218, 874209 )  ) then 1 end B0014,
CASE WHEN (  ( employeesize >=   1  AND employeesize <=  500    ) AND e.titlecode in ('1','9') ) then 1 end  B0015,
CASE WHEN (  ( employeesize >=   1  AND employeesize <=  20    )  ) then 1 end B0016,
CASE WHEN ( e.titlecode IN ('1','2','5','9','#','C','E','I','W','F','G','H','O')   OR ( ( ( SICCODE >=   600000  AND SICCODE <=  629999 )  OR  ( SICCODE >=  872000  AND SICCODE <=  872999 )  OR  SICCODE IN (  874209   ) )  AND e.titlecode NOT IN ('8','V','+',']',':','')  ) ) then 1 end B0017,
CASE WHEN ( e.titlecode IN ('$','@','%','1','2','4','9','A','C','D','E','F')  ) then 1 end B0018,
CASE WHEN ( e.titlecode IN ('!','@','=','N')  OR  ( SICCODE >=  737000  AND SICCODE <=  737999   )  OR (  (employeesize >=   1  AND  employeesize <= 10)  AND e.titlecode IN ('1','2','3','4','5','9','(',')','[','_','=','>','C','E','F','I','J','K','Q','S','W') ) ) then 1 end B0019,
CASE WHEN ( e.titlecode IN ('!','@','=','N')  OR  ( SICCODE >=  737101  AND SICCODE <=  737104 )  OR  SICCODE IN (  737106, 737108, 737109, 737205, 737401, 737409   )  OR ( ( employeesize >=   1 AND employeesize <= 10) AND e.titlecode IN ('1','2','3','4','5','9','(',')','[','_','=','>','C','E','F','I','J','K','Q','S','W') ) ) then 1 end B0020,
CASE WHEN (  ( employeesize >=   101  AND employeesize <=  500    )  ) then 1 end B0021,
cast(NULL as int) B0022,
CASE WHEN ( e.proftitle IN ('AIN','ANM','ANNA','ANP','AOCN','AORN','APN','APRN','ARN','ARNP','ASN','ASORN','BAA (N)','BAN','BIG','Bsc.N','BSN','CAPA','CARN','CCC','CCRN','CDDN','CDONA/LTC','CEN','CENAs','CETN','CGFNS','CGRN','CHN','CHT RN','CLNC','CN','CNA','CNAA','CNC','CNM','CNN','CNO','CNOR','CNRN','CNS','COHN','COHN-S','CPAN','CPN (C)','CPNP','CPON','CPP','CRANA','CRNA','CRNFA','CRNH','CRNI','CRNO','CRNP','CRRN','CSN','CTN','CUNP','CURN','CWCN','DNSc','DON','DSN','EN','ENA','ENPC','FAAN','FNP','GN','GNP','HNC','IAFN','ICN','INCC','INS','ITNS','LNC','LPN ','LVN','MICN','MN','MNEd','MSN','NA','ND','NENA','NH','NICs','NNNHP','NNP','NOC','NP','NPP','NSYICU','NVSPV','NZNO','OCN','OGP','ONC','PHN','PMH-NP','PN','PNP','RCNA','RGN','RMG','RMN','RN','RNAC','RNC','RNFA','RNMH','RNR','RPN','SN','SRN','TNCC','WHCNP','WHNP','WOCN') OR  SICCODE IN (  736116, 804907, 804908, 804927, 804955, 805999, 824901 )   ) then 1 end B0023,
CASE WHEN ( e.titlecode IN ('!','@','=','N')  OR  ( SICCODE >=  737000  AND SICCODE <=  737999 )  OR  ( SICCODE >=  871000  AND SICCODE <=  871999 )  OR  ( SICCODE >=  873000  AND SICCODE <=  873999 )  OR  SICCODE IN (  085106, 874853, 874855 )   ) then 1 end B0024,
CASE WHEN (  ( employeesize >=   51  AND employeesize <=  100    )  ) then 1 end B0025,
CASE WHEN (  ( employeesize >=   2501  AND employeesize <=  5000    )  ) then 1 end B0026,
CASE WHEN ( e.titlecode IN ('/','X')   OR  ( SICCODE >=  150000  AND SICCODE <=  179999 )   ) then 1 end B0027,
CASE WHEN ( e.titlecode IN ('1','2','4','5','9','A','C','D') ) then 1 end B0028,
CASE WHEN ( e.titlecode IN ('2','4','5','9','E','F','I','J','K','W','$','%','&',')','@') ) then 1 end B0029,
CASE WHEN ( e.titlecode IN (':')   OR  ( SICCODE >=  820000  AND SICCODE <=  829999 )  OR  ( SICCODE >=  941100  AND SICCODE <=  941199 )  OR  SICCODE IN (  874825 )   ) then 1 end B0030,
CASE WHEN ( e.titlecode IN ('1','2','5','9','#','C','F','G','H','I','O')   AND  ( SICCODE >=  628200  AND SICCODE <=  628299 )  OR  SICCODE IN (  621101, 621104, 621105,  621109, 621110, 621111, 874209, 602101, 671201, 671901 )   ) then 1 end B0031,
CASE WHEN ( e.titlecode NOT IN ('8','V',   '+'   ,  ':') ) then 1 end B0032,
CASE WHEN (   ( SICCODE >=  805000  AND SICCODE <=  805999 )  OR  ( SICCODE >=  806000  AND SICCODE <=  806999 )  OR  SICCODE IN ( 736116, 801104, 801105, 801133, 803198, 804398, 804907,804908, 804927, 804955, 809306, 809307, 809308, 809399, 824901 )   ) then 1 end B0033,
CASE WHEN ( ( employeesize > 50 AND e.titlecode  IN ('$','@','%','{','1','2','4','5','9','A','C','D','E','F','G','H','I','J','K','W') )  ) then 1 end B0034,
CASE WHEN ( e.proftitle IN ('AAEM','AAPA','AAPS','ABQAURP','ASOPA','CUPA','EDF','FACCP','NAEMSP','NBCOPA','OPA-C','PA-C','PA','DO','MD','RFDS','FS','ME','OB','DC','DDS','DMD','DPM','DPT','DVM')      OR  ( SICCODE >=  801111  AND SICCODE <=  801114 )  OR  ( SICCODE >=   801118  AND SICCODE <=  801131 )  OR  ( SICCODE >=  804301 AND SICCODE <= 804304 )  OR  SICCODE IN (  801101, 801105, 801108, 801137, 801138, 804901, 802108 )   ) then 1 end B0035,
CASE WHEN ( e.titlecode IN ('!','@','=','N','Q')   OR ( ( SICCODE >=  737101  AND SICCODE <=  737106 )  OR  ( SICCODE >=   737301  AND SICCODE <=  737304 )  OR  ( SICCODE >=   737307  AND SICCODE <=  737406 )  OR  ( SICCODE >=   737408  AND SICCODE <=  737410 )  OR  ( SICCODE >=   737414  AND SICCODE <=  737422 )  OR  ( SICCODE >=   737425  AND SICCODE <=  737427 )  OR  ( SICCODE >=  737503  AND SICCODE <=  737505 )  OR  ( SICCODE >=  737901  AND SICCODE <=  737907 )  OR  ( SICCODE >=  737910  AND SICCODE <=  737999)  OR  SICCODE IN (  737109, 737203, 737698 )  AND e.titlecode NOT IN ('8','V','+',':')  )  OR ( ( employeesize>=1 AND employeesize <= 10) AND e.titlecode IN ('1','2','3','4','5','9','(',')','[','_','=','>','C','E','F','I','J','K','Q','S','W') ) ) then 1 end B0036,
CASE WHEN (  ( SICCODE >=  823101  AND SICCODE <=  823104 )  OR  ( SICCODE >=  910000  AND SICCODE <=  979999 )  OR  SICCODE IN (  655303, 806904, 822105, 832253, 833108, 873307, 899931 )   ) then 1 end B0037,
cast(NULL as int) B0038,
CASE WHEN ( e.titlecode IN ('1','5','9','C','E','F','I','W','%','\\','M','R')  OR  ( SICCODE >=  731000  AND SICCODE <=  731999 )  OR  SICCODE IN (  733105, 733605, 873202, 873204, 874302, 874823   )  OR ( ( employeesize >=1 ) AND employeesize <= 10) AND e.titlecode IN ('1','2','3','4','5','9','(',')','[','_','=','>','C','E','F','I','J','K','Q','S','W') ) then 1 end B0039,
CASE WHEN (
( SICCODE >=  800000 AND SICCODE <= 809999 )
 OR  SICCODE IN ( 283407, 283498, 283601, 283602, 308916, 355913, 384301, 384398, 504719, 504917, 512203, 512226, 591205, 591207, 735202, 736116, 769982,
 822109, 822111, 824901, 824906, 862105, 862106, 871177, 873108, 873112, 873115, 873124, 873126, 873127, 874243 )
 OR (e.proftitle IN ('AAEM','AAPA','AAPS','ABQAURP','ASOPA','CUPA','EDF','FACCP','NAEMSP','NBCOPA','OPA-C','PA-C','PA','DO','MD','RFDS','FS','ME','OB','DC','DDS','DMD','DPM','DPT','DVM')   OR  (e.proftitle IN ('AIN','ANM','ANNA','ANP','AOCN','AORN','APN','APRN','ARN','ARNP','ASN','ASORN','BAA (N)','BAN','BIG','Bsc.N','BSN','CAPA','CARN','CCC','CCRN','CDDN','CDONA/LTC','CEN','CENAs','CETN','CGFNS','CGRN','CHN','CHT RN','CLNC','CN','CNA','CNAA','CNC','CNM','CNN','CNO','CNOR','CNRN','CNS','COHN','COHN-S','CPAN','CPN (C)','CPNP','CPON','CPP','CRANA','CRNA','CRNFA','CRNH','CRNI','CRNO','CRNP','CRRN','CSN','CTN','CUNP','CURN','CWCN','DNSc','DON','DSN','EN','ENA','ENPC','FAAN','FNP','GN','GNP','HNC','IAFN','ICN','INCC','INS','ITNS','LNC','LPN ','LVN','MICN','MN','MNEd','MSN','NA','ND','NENA','NH','NICs','NNNHP','NNP','NOC','NP','NPP','NSYICU','NVSPV','NZNO','OCN','OGP','ONC','PHN','PMH-NP','PN','PNP','RCNA','RGN','RMG','RMN','RN','RNAC','RNC','RNFA','RNMH','RNR','RPN','SN','SRN','TNCC','WHCNP','WHNP','WOCN')
  ) ) ) then 1 end B0040,
CASE WHEN (   ( SICCODE >= 150000  AND SICCODE <=  179999 )   ) then 1 end B0041,
CASE WHEN (   SICCODE IN ( 283407, 283498, 283601, 283602, 308916, 355913, 504917, 512203, 512226, 591205, 591207, 807107, 807114, 822111, 862105, 871177, 873108, 873112, 873115, 873124, 873126, 873127 )   ) then 1 end B0042,
CASE WHEN (   ( SICCODE >= 596100 AND SICCODE <= 596199 )   ) then 1 end B0043,
CASE WHEN ( e.titlecode IN ('1','5','9','?','_','$','^','P')   OR  ( SICCODE >=  736103  AND SICCODE <=  736106 )  OR  ( SICCODE >=  944101  AND SICCODE <=  944104 )  OR  SICCODE IN (  637103, 874216, 874222 )   ) then 1 end B0044,
CASE WHEN ( (employeesize > 50 AND e.titlecode  IN ('$','@','%','{','1','2','4','5','9','A','C','D','E','F','G','H','I','J','K','W'))   ) then 1 end B0045,
CASE WHEN (   ( SICCODE >= 730000 AND SICCODE <= 739999 )   ) then 1 end B0046,
CASE WHEN ( e.titlecode IN ('!','@','=','N')  OR  SICCODE IN (  737108, 737109 )   ) then 1 end B0047,
CASE WHEN ( e.titlecode IN ('-','\\','%','M','Q','R','T')   OR ( SICCODE IN (   179605, 276102, 349301, 353401, 357805, 382507, 394930, 458112, 481210, 481211, 501354, 504437, 504646, 504651, 504653, 504657, 504708, 507521, 507806, 507818, 508342, 508817, 508829, 509334, 515408, 551109, 551110, 555104, 555119, 559917, 573132, 573615, 594105, 594307, 594539, 653133, 729103, 731115, 735308, 738981, 753905, 799310, 811118, 861103, 873203, 874210, 874213, 874214, 874247, 874248, 874259, 874267, 874808, 874810, 874811, 874818  )  AND e.titlecode NOT IN ('8','V','+',']',':','')  ) ) then 1 end B0048,
CASE WHEN (  ( employeesize >=   501  AND employeesize <=  1000    )  ) then 1 end B0049,
CASE WHEN ( employeesize  >= 5001  ) then 1 end B0050,
CASE WHEN (   SICCODE IN ( 737202, 737205, 737316, 737410, 737411, 737502, 737598, 737913 )   ) then 1 end B0051,
CASE WHEN (  ( SICCODE >=  823101  AND SICCODE <=  823104 )  OR  ( SICCODE >=  830000  AND SICCODE <=  839999 )  OR  ( SICCODE >=  910000  AND SICCODE <=  979999 )  OR  SICCODE IN (  085101, 655303, 673298, 738102, 738111, 738122, 738949, 804910,  804921, 804970, 804992, 806904, 822105, 824916, 824951, 824952, 829947, 866137, 874208, 874813, 874832 )   ) then 1 end B0052,
CASE WHEN (   ( SICCODE >= 805000 AND SICCODE <= 805999 )   ) then 1 end B0053,
CASE WHEN ( e.titlecode IN ('1','2','5','9','#','C','F','G','H','I','O')
OR ( ( SICCODE >=   600000  AND SICCODE <=  629999 )  OR  ( SICCODE >=  872000  AND SICCODE <=  872999 )
 OR  SICCODE IN (  874209 )   ) ) then 1 end B0054,
CASE WHEN ( e.titlecode IN ('!','@','=','N')  OR  SICCODE IN (  737103, 737104, 737301, 737303, 737304, 737316, 737398, 737504, 737906, 737910, 737901, 737304, 737314, 737317, 737421, 737904 )   ) then 1 end B0055,
CASE WHEN ( e.titlecode IN ('$','^','P')   OR  ( SICCODE >=  736103  AND SICCODE <=  736106 )   ) then 1 end B0056,
CASE WHEN ( e.titlecode IN ('=')   OR  SICCODE IN (  871110 )   ) then 1 end B0057,
CASE WHEN ( e.titlecode IN ('!','@','=','N')  OR  (( SICCODE >=  737102 AND SICCODE <= 737106 )  OR  SICCODE IN (  737108, 737109, 737205, 737398, 737409, 737410, 737411, 737421, 737424, 737905, 737906 ) )  ) then 1 end B0058,
CASE WHEN ( e.titlecode IN ('!','@','=','N')  OR  SICCODE IN (  573418, 737108 )   ) then 1 end B0059,
CASE WHEN (   ( SICCODE >= 421000 AND SICCODE <= 421999 )  OR  SICCODE IN (  423102, 423103, 444902, 444905, 444906, 473101, 473116, 473120, 473121, 473124, 473125, 478503, 478508, 478978, 511301, 511306, 511333, 514805, 514813, 515307, 733101, 733110, 861110, 874812  )   ) then 1 end B0060,
CASE WHEN (   ( SICCODE >= 594500 AND SICCODE <= 594699 )   ) then 1 end B0061,
CASE WHEN ( e.titlecode IN ('/','X')   OR  ( SICCODE >=  200000 AND SICCODE <= 399999 )   ) then 1 end B0062,
CASE WHEN ( e.titlecode IN ('#','F','G','H','O')   OR ( ( ( SICCODE >=   600000  AND SICCODE <=  629999 )  OR  ( SICCODE >=  872000  AND SICCODE <=  872999 )  OR  SICCODE IN (  874209  ) )  AND e.titlecode NOT IN ('8','V','+',']',':','')  ) ) then 1 end B0063,
CASE WHEN ( employeesize >=   1001    AND employeesize <=  2500    )   then 1 end B0064,
CASE WHEN ( ( e.titlecode IN ('!','@','=','N')
AND  (( SICCODE >=  600000  AND SICCODE <=  619999 )
OR  ( SICCODE >=  811000  AND SICCODE <=  811999 )
OR  ( SICCODE >=  944101  AND SICCODE <=  944104 )
OR  SICCODE IN (  874222 ) ) )   OR  SICCODE IN (737204, 737404) )   then 1 end B0065,
CASE WHEN (   SICCODE IN ( 733604,733603 )   ) then 1 end B0066,
CASE WHEN (   SICCODE IN ( 801104, 801133, 803198, 804398, 804999, 807104, 809305, 809399  )   ) then 1 end B0067,
CASE WHEN (  ( employeesize >=   1  AND employeesize <=  500    )  ) then 1 end B0068,
CASE WHEN ( e.titlecode IN ('$','@','%','1','2','4','9','A','C','D','E','F')  ) then 1 end B0069,
CASE WHEN ( e.titlecode IN ('=')   OR  SICCODE IN (  871122, 871125 )   ) then 1 end B0070,
CASE WHEN ( e.titlecode IN ('1','2','5','9','#','C','F','G','H','I','O')
OR ( ( SICCODE >=   600000  AND SICCODE <=  629999 )
OR  ( SICCODE >=  872000  AND SICCODE <=  872999 )
 OR  SICCODE IN (  874209 )   ) ) then 1 end B0071,
CASE WHEN (   SICCODE IN ( '018105', 122102, 341202, 421201, 421205, 421212, 421231, 421302, 421303, 421304, 421305, 421306, 421307, 421308, 421309, 421318, 421320, 421321, 421498, 421502, 421503, 423102, 444902, 444906, 473101, 473120, 473121, 473125, 492505, 511301, 511306, 511333, 514805, 514813, 515307, 581230, 596302, 596309, 733101, 733110, 753220, 861110, 874266, 874812, 922906, '078102' )   ) then 1 end B0072,
CASE WHEN (   SICCODE IN ( 581208, 581224, 581251, 581301, 581255 )   ) then 1 end B0073,
CASE WHEN (   ( SICCODE >= 401000  AND SICCODE <=  429999 )  OR  ( SICCODE >=  440000  AND SICCODE <=  448999 )  OR  ( SICCODE >=  451000  AND SICCODE <=  452999 )  OR  ( SICCODE >=  472400 AND SICCODE <= 472499 )  OR  ( SICCODE >=   473100  AND SICCODE <=  478999 )  OR  SICCODE IN (  735939 )   ) then 1 end B0074,
CASE WHEN (   ( SICCODE >= 520000 AND SICCODE <= 599999 )   ) then 1 end B0075,
CASE WHEN (   SICCODE IN ( 804921, 804970, 832204, 832215, 832218, 832219, 832221, 832227, 832244, 832245, 832253, 832266, 832282, 832283, 832284, 832289, 832293, 839999, 944101, 944102, 944103, 944104 )   ) then 1 end B0076,
CASE WHEN (   SICCODE IN ( 701101, 701111,581208, 581224, 581251, 581301, 581255 )   ) then 1 end B0077,
CASE WHEN ( e.titlecode IN ('&','T','-')   OR ( SICCODE IN (   179605, 276102, 349301, 353401, 357805, 382507, 394930, 458112, 481210, 481211, 501354, 504437, 504646, 504651, 504653, 504657, 504708, 507521, 507806, 507818, 508342, 508817, 508829, 509334, 515408, 551109, 551110, 555104, 555119, 559917, 573132, 573615, 594105, 594307, 594539, 653133, 729103, 735308, 738921, 738981, 753905, 799310, 861103, 874267, 874808, 874810, 874811  )  AND e.titlecode NOT IN ('8','V','+',']',':','')  ) ) then 1 end B0078,
CASE WHEN ( e.titlecode IN ('(') ) then 1 end B0079,
CASE WHEN ( e.titlecode IN ('=')   OR  ( SICCODE >=  871100 AND SICCODE <= 871199 )   ) then 1 end B0080,
CASE WHEN ( e.titlecode IN ('^','P')   OR  SICCODE IN (  637103, 874216, 874222 )   ) then 1 end B0081,
CASE WHEN (   ( SICCODE >= 820000  AND SICCODE <=  829999 )  OR  ( SICCODE >=  941100  AND SICCODE <=  941199 )  OR  SICCODE IN (  874825 )   ) then 1 end B0082,
CASE WHEN ( e.titlecode IN ('A','C','D') ) then 1 end B0083,
CASE WHEN ( e.titlecode IN ('#','F','G','H','O')  OR  ( SICCODE >=  628000  AND SICCODE <=  628999 )  OR  SICCODE IN (  874209 )   ) then 1 end B0084,
cast(NULL as int) B0085,
CASE WHEN ( e.titlecode IN ('=')   OR  SICCODE IN (  871211, 871202, 871112, 871307 )   ) then 1 end B0086,
CASE WHEN (  ( SICCODE >=  823101  AND SICCODE <=  823104 )  OR  ( SICCODE >=  910000  AND SICCODE <=  979999 )  OR  SICCODE IN (  655303, 806904, 822105, 832253, 833108, 873307, 899931 )   ) then 1 end B0087,
CASE WHEN ( e.titlecode IN ('#','F','G','H','O')   OR  ( SICCODE >=  628200  AND SICCODE <=  628299 )  OR  ( SICCODE >=  872000  AND SICCODE <=  872999 )   ) then 1 end B0088,
CASE WHEN (   SICCODE IN ( 628202, 628214, 628217, 672298, 672699, 874209 )   ) then 1 end B0089,
CASE WHEN ( e.titlecode IN ('!','@','=','N')  OR  ( SICCODE >=  737000  AND SICCODE <=  737999 )   ) then 1 end B0090,
CASE WHEN (   ( SICCODE >= 480000 AND SICCODE <= 489999 )   ) then 1 end B0091,
CASE WHEN (   SICCODE IN ( 591205, 591207, 804939, 822111, 862105 )   ) then 1 end B0092,
CASE WHEN ( e.titlecode IN      ('1','2','4','5','6','9','$','%' ,  ')'   ,   ','   , '@', 'C','E', 'F','G','H','I','J','K','L','M','N','O','P','Q','R', 'S','T','V','W','X','Y' )
 ) then 1 end B0093,
CASE WHEN ( e.titlecode IN ('!','@','=','N')  OR  ( SICCODE >=  737000  AND SICCODE <=  737999 )   ) then 1 end B0094,
CASE WHEN ( e.titlecode IN ('^','P')   OR  ( SICCODE >=  944101  AND SICCODE <=  944104 )  OR  SICCODE IN (  874222 )   ) then 1 end B0095,
CASE WHEN ( e.titlecode IN ('X','S')   OR ( ( SICCODE >=  200000 AND SICCODE <= 399999  )
AND e.titlecode IN ('1','5','9','^','_','C','I','M','P','W') ) ) then 1 end B0096,
CASE WHEN ( e.titlecode IN ('&','T','-')   OR ( SICCODE IN (   179605, 276102, 349301, 353401, 357805, 382507, 394930, 458112, 481210, 481211, 501354, 504437, 504646, 504651, 504653, 504657, 504708, 507521, 507806, 507818, 508342, 508817, 508829, 509334, 515408, 551109, 551110, 555104, 555119, 559917, 573132, 573615, 594105, 594307, 594539, 653133, 729103, 735308, 738921, 738981, 753905, 799310, 861103, 874267, 874808, 874810, 874811  )  AND e.titlecode NOT IN ('8','V','+',']',':','')  ) ) then 1 end B0097,
CASE WHEN (  ( SICCODE >=  628200  AND SICCODE <=  628299 )  OR  SICCODE IN (  621101, 621104, 621105,  621109, 621110, 621111, 874209, 602101, 671201, 671901 )   ) then 1 end B0098,
CASE WHEN (   ( SICCODE >= 911101 AND SICCODE <= 912106 )  OR  ( SICCODE >= 912115 AND SICCODE <= 922102 )  OR  ( SICCODE >= 922201 AND SICCODE <= 961104 )  OR  ( SICCODE >= 962101 AND SICCODE <= 963104 )  OR  ( SICCODE >= 964101 AND SICCODE <= 964104 )  OR  ( SICCODE >= 965101 AND SICCODE <= 965104 )  OR  ( SICCODE >= 966101 AND SICCODE <= 971109 )   ) then 1 end B0099,
CASE WHEN (   ( SICCODE >=  651201  AND SICCODE <=  651208 )  OR  SICCODE IN (  651298, 651498, 653102, 653103, 653104, 653108, 653109, 653114, 653117, 653118, 653120, 653121, 653122, 653125, 653127, 653131, 653135, 653136, 653139, 653140, 653144, 653147, 653149, 654101, 654102, 654103, 655201, 655202, 655205, 655206 )   ) then 1 end B0100,
CASE WHEN (  ( employeesize >=   1  AND employeesize <=  49    )  ) then 1 end B0101,
CASE WHEN (   ( SICCODE >= 641100  AND SICCODE <=  641199  )   ) then 1 end B0102,
CASE WHEN ( e.titlecode IN ('/','X','S')   OR  ( SICCODE >=  200000 AND SICCODE <= 399999 )   ) then 1 end B0103,
CASE WHEN (   ( SICCODE >= 500000 AND SICCODE <= 519999 )   ) then 1 end B0104,
CASE WHEN (   ( SICCODE >= 130000 AND SICCODE <= 139999 )  OR  SICCODE IN (  171131, 179412, 329604, 343305, 361202, 361301, 362104, 362105, 362504, 362506, 362901, 362998, 369902, 382202, 382208, 491101, 491103, 493198, 493902, 496102, 503306, 506307, 506312, 506316, 506317, 506329, 506330, 506347, 506357, 506358, 506359, 506366, 506369, 506374, 506387, 506399, 506520, 507405, 507407, 507416, 507438, 508465, 521135, 521136, 653149, 735931, 738943, 762999, 769404, 769932, 807116, 871115, 871150, 873103, 873421, 874212, 874217, 874218, 874851, 874893, 999947, 999950 )   ) then 1 end B0105,
cast(NULL as int) B0106,
CASE WHEN (  ( employeesize >=   5  AND employeesize <=  49    )  ) then 1 end B0107,
CASE WHEN (   SICCODE IN ( 085101, 738102, 738111, 738122, 738949, 804910, 804992, 824916, 824951, 824952, 829947, 874208, 874813, 874832, 912108, 922101, 922102, 922104, 922401, 922402, 922403, 922404, 922405, 922901, 922902, 922903, 922904, 971101, 971102, 971103, 971104 )   ) then 1 end B0108,
CASE WHEN ( e.titlecode IN ('3','?','_','{','>') ) then 1 end B0110,
CASE WHEN (   SICCODE IN ( 673298, 839919, 839998, 866137 )   ) then 1 end B0111,
CASE WHEN ( e.titlecode IN ('@','=','N') ) then 1 end B0112,
CASE WHEN ( e.titlecode IN ('&','T','-')   OR ( SICCODE IN (   179605, 276102, 349301, 353401, 357805, 382507, 394930, 458112, 481210, 481211, 501354, 504437, 504646, 504651, 504653, 504657, 504708, 507521, 507806, 507818, 508342, 508817, 508829, 509334, 515408, 551109, 551110, 555104, 555119, 559917, 573132, 573615, 594105, 594307, 594539, 653133, 729103, 735308, 738921, 738981, 753905, 799310, 861103, 874267, 874808, 874810, 874811  )  AND e.titlecode NOT IN ('8','V','+',']',':','')  ) ) then 1 end B0113,
CASE WHEN (   ( SICCODE >=  802101  AND SICCODE <=  802106 )  OR  SICCODE IN ( 384301, 384398, 504719, 735202, 769982, 804914, 807102, 807103, 807201, 807202, 807203, 807204, 807205, 809902, 809903, 809925, 822109, 824906, 862106, 874243 )   ) then 1 end B0114,
CASE WHEN (  ( employeesize >=   1  AND employeesize <=  4    )  ) then 1 end B0115,
CASE WHEN (   ( SICCODE >=  802101  AND SICCODE <=  802106 )  OR  SICCODE IN ( 384301, 384398, 504719, 735202, 769982, 804914, 807102, 807103, 807201, 807202, 807203, 807204, 807205, 809902, 809903, 809925, 822109, 824906, 862106, 874243 )   ) then 1 end B0116,
CASE WHEN ( e.titlecode IN ('!','@','=','N')   AND  ( ( SICCODE >=  971101  AND SICCODE <=  971104 )  OR  SICCODE IN (  874813 ) )  ) then 1 end B0117,
CASE WHEN ( e.titlecode IN ('A','C','D') ) then 1 end B0118,
CASE WHEN (   ( SICCODE >=  651201  AND SICCODE <=  651598 )  OR  ( SICCODE >=  653000  AND SICCODE <=  653999 )  OR  ( SICCODE >=  654101  AND SICCODE <=  654107 )  OR  ( SICCODE >=  655201  AND SICCODE <=  655207  )  OR  SICCODE IN ( 614106, 615904, 616201, 616202, 616203, 616204, 616207, 616302, 616305, 633101, 635107, 639901 )   ) then 1 end B0119,
cast(NULL as int) B0120,
CASE WHEN (   ( SICCODE >=  874000  AND SICCODE <=  874999 )  OR  SICCODE IN (  '071105', '072101', '072111', '075216', '075226', '078101', '078104', '078108', '092101', 138204, 138207, 138209, 138213, 144204, 152152, 161105, 162323, 162937, 171134, 171142, 171147, 174212, 176105, 179501, 179999, 242106, 252206, 347108, 421321,  448904, 449110,  449203,  472403, 472407,  473101, 473103, 473110, 473125, 493904,  493905,  494105,  495204, 495308, 495321, 505205, 571314, 581220,  591207, 594169,  596305,  599989, 616204, 628202,  628204, 628205, 628217,  632101, 632406, 641104, 641113, 641117, 651207, 651902,  653106,  653108,  653117, 653121,  653124, 653129, 653131, 653136,  653140, 655206,  672298,  673305, 701103,  723112, 729103, 729901, 729905, 729921, 729932, 729947, 731102, 733508, 736104, 736105, 736110, 737103, 737104, 737205,  737318, 737698,  737807, 737901, 737902, 737905, 737906, 738111, 738118, 738902, 738985, 738992, 752103, 754921, '076202',  '076204',  781905, 781908, 781910, 792218, 792222, 799112,  801117, 804903, 804992, 832223,  835104, 871102, 871127,  871150,  871167, 871210, 871222, 871312, 872105, 872110,  873113,  873118, 873127, 873130, 873142, 873207, 873209, 873406, 873409, 873417, 899904, 899914, '097105' )   ) then 1 end B0121,
CASE WHEN ( e.titlecode IN ('V') OR  ( SICCODE >=  811100  AND SICCODE <= 811199 )   ) then 1 end B0122,
CASE WHEN ( e.titlecode IN ('!','@','=','N')  OR  SICCODE IN (  737108, 737109 )   ) then 1 end B0123,
CASE WHEN (   ( SICCODE >= 372000 AND SICCODE <= 372999 )   ) then 1 end B0124,
CASE WHEN (   ( SICCODE >= 010000  AND SICCODE <=  029999 )  OR  ( SICCODE >=  070000  AND SICCODE <=  099999 )   ) then 1 end B0125,
CASE WHEN (   ( SICCODE >= 217000  AND SICCODE <=  274999 )  OR  ( SICCODE >=  483000  AND SICCODE <=  489999 )  OR  ( SICCODE >=  738300  AND SICCODE <= 738399 )  OR  ( SICCODE >=  780000  AND SICCODE <=  792999 )  OR  ( SICCODE >=  841201  AND SICCODE <=  841210 )  OR  SICCODE IN (  599969 )   ) then 1 end B0126,
CASE WHEN ( e.titlecode IN ('V') OR  ( SICCODE >=  811100  AND SICCODE <= 811199 )   ) then 1 end B0127,
CASE WHEN ( e.titlecode IN (':')   OR  ( SICCODE >=  820000  AND SICCODE <=  820999 )  OR  ( SICCODE >=  941100  AND SICCODE <=  941199 )  OR  SICCODE IN (  874802, 874825 )   ) then 1 end B0128,
CASE WHEN ( e.titlecode IN ('%','\\','M')  OR
( SICCODE IN (  399303, 399398, 519917, 519956, 519959, 731101, 731103, 731104, 731105, 731106, 731107, 731108, 731109, 731110, 731111, 731112, 731114, 731115, 731201, 731205, 731303, 731305, 731306, 731307, 731308, 731902, 731903, 731910, 731911, 731914, 731915, 731916, 731917, 731918, 731919, 731920, 731921, 731926, 731927, 731928, 731999, 733105, 733605, 811118, 824915, 873202, 873203, 873204, 874210, 874213, 874214, 874247, 874248, 874259, 874302, 874818, 874840, 874864 )
  ) ) then 1 end B0129,
CASE WHEN ( e.titlecode IN ('1','2','5','9','#','C','F','G','H','I','O')   AND  ( SICCODE >=  628200  AND SICCODE <=  628299 )  OR  SICCODE IN (  621101, 621104, 621105,  621109, 621110, 621111, 874209, 602101, 671201, 671901 )   ) then 1 end B0130,
CASE WHEN ( e.titlecode IN ('Y')    ) then 1 end B0131,
CASE WHEN ( e.titlecode IN ('#','F','G','H','O')   OR  ( SICCODE >=  872000  AND SICCODE <=  872999 )   ) then 1 end B0132,
CASE WHEN ( e.titlecode IN ('-','%','\\','R','T')   OR  SICCODE IN (  179605, 276102, 349301, 353401, 357805, 382507, 394930, 399303, 399398, 458112, 481210, 481211, 501354, 504437, 504646, 504651, 504653, 504657, 504708, 507521, 507806, 507818, 508342, 508817, 508829, 509334, 515408, 519917, 519956, 519959, 551109, 551110, 555104, 555119, 559917, 573132, 573615, 594105, 594307, 594539, 653133, 729103, 731101, 731103, 731104, 731105, 731106, 731107, 731108, 731109, 731110, 731111, 731112, 731114, 731115, 731201, 731205, 731303, 731305, 731306, 731307, 731308, 731902, 731903, 731911, 731914, 731915, 731916, 731917, 731918, 731919, 731920, 731921, 731926, 731927, 731928, 731999, 733105, 733605, 735308, 738981, 753905, 799310, 811118, 824915, 861103, 873203, 874210, 874213, 874214, 874247, 874248, 874259, 874267, 874808, 874810, 874811, 874818 )   ) then 1 end B0133,
CASE WHEN (   ( SICCODE >=  874000  AND SICCODE <=  874999 )  OR  SICCODE IN (
'071105', '072101', '072111', '075216', '075226', '078101', '078104', '078108', '092101', 138204, 138207, 138209, 138213, 144204, 152152, 161105, 162323, 162937, 171134, 171142, 171147, 174212, 176105, 179501, 179999, 242106, 252206, 347108, 448904, 472403, 473101, 473103, 473110, 473125, 495204, 495308, 495321, 505205, 571314, 591207, 599989, 616204, 628204, 628205, 632101, 632406, 641104, 641113, 641117, 651207, 653117, 653124, 653129, 653131, 653140, 673305, 723112, 729103, 729901, 729905, 729921, 729932, 729947, 731102, 733508, 736104, 736105, 736110, 737103, 737104, 737318, 737807, 737901, 737902, 737905, 737906, 738111, 738118, 738902, 738985, 738992, 752103, 754921, 781905, 781908, 781910, 792218, 792222, 801117, 804903, 804992, 835104, 871102, 871167, 871210, 871222, 871312, 872105, 873118, 873127, 873130, 873142, 873207, 873209, 873406, 873409, 873417, 899904, 899914
)   ) then 1 end B0134,
cast(NULL as int)  B0135,
CASE WHEN (   SICCODE IN ( 621105, 621109, 621111, 628202, 628213, 628214, 628215, 653104, 672298, 672699, 679801, 679902, 679998 )   ) then 1 end B0136,
CASE WHEN ( e.titlecode IN ('$','^','P')   OR  ( SICCODE >=  736103  AND SICCODE <=  736106 )  OR  ( SICCODE >=  944101  AND SICCODE <=  944104 )  OR  SICCODE IN (  637103, 874216, 874222 )   ) then 1 end B0137,
CASE WHEN (   ( SICCODE >= 130000 AND SICCODE <= 139999 )   ) then 1 end B0138,
CASE WHEN (  ( employeesize >=   1  AND employeesize <=  500    ) AND e.titlecode NOT IN ('8','V','+',':') ) then 1 end B0139,
CASE WHEN ( e.titlecode IN ('/','X')   OR  ( SICCODE >=  200000 AND SICCODE <= 399999 )   ) then 1 end B0140,
cast(NULL as int) B0141,
cast(NULL as int) B0142,
cast(NULL as int) B0143,
cast(NULL as int) B0144,
cast(NULL as int) B0145,
cast(NULL as int) B0146,
cast(NULL as int) B0147,
cast(NULL as int) B0148,
cast(NULL as int) B0149,
cast(NULL as int) B0150,
cast(NULL as int) B0151,
cast(NULL as int) B0152,
cast(NULL as int) B0153,

CASE WHEN ( e.titlecode IN ('3', '{', '>', '4', '(', '?', 'W', 'K') ) then 1 end B0299,
CASE WHEN ( e.titlecode IN ('&', '%', '\\', 'R','-', 'T')  ) then 1 end B0300,
CASE WHEN ( e.titlecode IN ('F', 'H', 'G', '#', 'O')  ) then 1 end B0301,
CASE WHEN ( e.titlecode IN ('^', 'P', 'L', '7')  ) then 1 end B0302,
CASE WHEN ( e.titlecode IN ('[', 'S', '/', 'X')  ) then 1 end B0303,
cast(NULL as int) B0306,
cast(NULL as int) B0307,
cast(NULL as int) B0323,
cast(NULL as int) B0324,
cast(NULL as int) B0325,
cast(NULL as int) B0326,
cast(NULL as int) B0327,
cast(NULL as int) B0328,
cast(NULL as int) B0329,
cast(NULL as int) B0330,
cast(NULL as int) B0331,
cast(NULL as int) B0332,
cast(NULL as int) B0333,
cast(NULL as int) B0334,
cast(NULL as int) B0335,
cast(NULL as int) B0336,
cast(NULL as int) B0337,
cast(NULL as int) B0338,
cast(NULL as int) B0339,
cast(NULL as int) B0340,
CASE WHEN (e.proftitle IN ('CNM')) then 1 end B0350,
CASE WHEN (e.proftitle IN ('CNP')) then 1 end B0351,
CASE WHEN (e.proftitle IN ('CPA')) then 1 end B0352,
CASE WHEN (e.proftitle IN ('DC')) then 1 end B0353,
CASE WHEN (e.proftitle IN ('DDS')) then 1 end B0354,
CASE WHEN (e.proftitle IN ('DO')) then 1 end B0355,
CASE WHEN (e.proftitle IN ('DMD')) then 1 end B0356,
CASE WHEN (e.proftitle IN ('DPM')) then 1 end B0357,
CASE WHEN (e.proftitle IN ('DPT')) then 1 end B0358,
CASE WHEN (e.proftitle IN ('DVM')) then 1 end B0359,
CASE WHEN (e.proftitle IN ('LPN')) then 1 end B0360,
CASE WHEN (e.proftitle IN ('MD')) then 1 end B0361,
CASE WHEN (e.proftitle IN ('NP')) then 1 end B0362,
CASE WHEN (e.proftitle IN ('OD')) then 1 end B0363,
CASE WHEN (e.proftitle IN ('OT')) then 1 end B0364,
CASE WHEN (e.proftitle IN ('PA')) then 1 end B0365,
CASE WHEN (e.proftitle IN ('PE')) then 1 end B0366,
CASE WHEN (e.proftitle IN ('PHD')) then 1 end B0367,
CASE WHEN (e.proftitle IN ('PT')) then 1 end B0368,
CASE WHEN (e.proftitle IN ('RN')) then 1 end B0369,
CASE WHEN (e.proftitle IN ('ND') ) then 1 end B0370,
cast(NULL as int) B0375,
CASE WHEN siccode in ('274121','874126','874882') or
          substring(siccode,1,4) in ('3571','3572','3575','3577','5045','5065','5734','8243') or
          substring(siccode,1,3) in ('367','737')
          then 1 end B0378,
CASE WHEN siccode in ('274121','874126','874882') or
		  substring(siccode,1,4) in ('3571','3572','3575','3577','5045','5065','5734','8243') or
          substring(siccode,1,3) in ('367','737')
          then 1 end B0379,
CASE WHEN siccode in ('944101','944102','944103','944104','874203','874204','874216','874222') or
		  substring(siccode,1,3) in ('736','833')
          then 1 end B0380,
CASE WHEN substring(siccode,1,3) in ('931') or substring(siccode,1,2) in ('60','61','62') then 1 end B0381,
CASE WHEN substring(siccode,1,3) in ('872') then 1 end B0382,
CASE WHEN substring(siccode,1,2) in ('81') then 1 end B0383,
CASE WHEN siccode in ('874213','874214','874259','874210','874248','874818','874247','873203') or substring(siccode,1,3) in ('731')  then 1 end B0384,
CASE WHEN substring(siccode,1,2) in ('80') then 1 end B0385,
CASE WHEN substring(siccode,1,2) in ('63','64')	then 1 end	B0386,
CASE WHEN substring(siccode,1,3) in ('871')	then 1 end	B0387,
CASE WHEN substring(siccode,1,3) in ('873')	then 1 end	B0388,
CASE WHEN substring(siccode,1,2) in ('20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39') then 1 end B0389,
CASE WHEN substring(siccode,1,2) in ('40','41','42','43','44','45','46','47') then 1 end B0390,
CASE WHEN substring(siccode,1,2) in ('82','83')	then 1 end	B0391,
CASE WHEN substring(siccode,1,2) in ('91','92','93','94','95','96','97') then 1 end	B0392,
CASE WHEN substring(siccode,1,2) in ('58') then 1 end B0393,
CASE WHEN substring(siccode,1,3) in ('866') then 1 end B0394,
CASE WHEN substring(siccode,1,2) in ('15','16','17') then 1 end	B0395,
CASE WHEN substring(siccode,1,2) in ('10',11,'12','13','14') then 1 end	B0396,
CASE WHEN substring(siccode,1,3) in ('753','762','763','764','769') then 1 end B0397,
CASE WHEN substring(siccode,1,4) in ('7349') then 1 end	B0398,
cast(NULL as int) B0399,
cast(NULL as int) B0400,
cast(NULL as int) B0401,
cast(NULL as int) B0402,
cast(NULL as int) B0403,
cast(NULL as int) B0404,
cast(NULL as int) B0405,
cast(NULL as int) B0406,
cast(NULL as int) B0407,
cast(NULL as int) B0408,
cast(NULL as int) B0409,
cast(NULL as int) B0410,
cast(NULL as int) B0411,
cast(NULL as int) B0412,
cast(NULL as int) B0413,
cast(NULL as int) B0414,
cast(NULL as int) B0415,
cast(NULL as int) B0416,
cast(NULL as int) B0417,
cast(NULL as int) B0418,
cast(NULL as int) B0419,
cast(NULL as int) B0420,
cast(NULL as int) B0421,
---
CASE WHEN	siccode in ('421205','421206','421209','421212','421214','421226','421229','421230','421231','421234','421235','421303','421304',
 '421305','421306','421307','421308','421309','421310','421318','421320','421321','421322','421403','421404','421498','421501','421502',
 '421503','421504','423102','423103','441298','442401','442498','443298','444901','444902','444905','444906','444999') then 1 end B0422,
CASE WHEN	siccode in ('531110') then 1 end B0423,
CASE WHEN ( (siccode >= 541101 and siccode <= 549999) and
      siccode not in ('541103','542104','542105','546101','546102','546103','546104','546105','546106','546107','546108','546109','546110',
     '546111','546112','549905','549906','549924','549925','549934','549938') )	then 1 end	B0424,
CASE WHEN	siccode in ('541103','554101')	then 1 end	B0425,
CASE WHEN	siccode >= 561101 and siccode <= 569989	then 1 end	B0426,
CASE WHEN	siccode >= 594101 and siccode <= 594179	then 1 end	B0427,
CASE WHEN  (siccode >= 594401 and siccode <= 594423) or siccode in ('593216')	then 1 end	B0428,
CASE WHEN  (siccode >= 594301 and siccode <= 594319 and siccode not in ('594308','594312','594313','594317','594318','594319'))	then 1 end	B0429,
CASE WHEN   siccode >= 594501 and siccode <= 594546	then 1 end	B0430,
CASE WHEN   siccode in ('599973','599992','599996','599997','599998')	then 1 end	B0431,
CASE WHEN  (siccode >= 581201 and siccode <= 581309 and siccode not in ('581204','581210','581256')) then 1 end	B0432,
CASE WHEN   siccode >= 592101 and siccode <= 592107	then 1 end	B0433,
CASE WHEN   siccode >= 701101 and siccode <= 702198	then 1 end	B0434,
CASE WHEN  ((siccode >= 821101 and siccode <= 822298) or (siccode >= 824401 and siccode <= 824999) and siccode not in ('821114','824901','824951','824952')) or
      siccode in ('829907','829914','829924','829935','829948','829957','829962','829963','829964','829968','829974','829990')	then 1 end	B0435,
CASE WHEN   siccode >= 509101 and siccode <= 509165	then 1 end	B0436,
CASE WHEN   siccode >= 509201 and siccode <= 509224	then 1 end	B0437,
CASE WHEN   siccode >= 509401 and siccode <= 509440 then 1 end	B0438,
CASE WHEN   siccode >= 511101 and siccode <= 511239	then 1 end	B0439,
CASE WHEN  (siccode >= 513601 and siccode <= 513911 and siccode not in ('513617','513627','513732')) then 1 end	B0440,
CASE WHEN  (siccode >= 514101 and siccode <= 514999 and siccode not in ('514109','514815','514910','514915','514942')) then 1 end B0441,
CASE WHEN	siccode >= 518101 and siccode <= 518207 or siccode in ('514915') then 1 end	B0442,
CASE WHEN	siccode >= 591201 and siccode <= 591214 or siccode in ('804939') then 1 end	B0443,
CASE WHEN	((siccode >= 801101 and siccode <= 801138 or siccode >= 804301 and siccode <= 804398) and siccode not in ('801105')) then 1 end B0444,
CASE WHEN   siccode >= 802101 and siccode <= 802106	then 1 end B0445,
CASE WHEN	siccode >= 804101 and siccode <= 804104	then 1 end B0446,
CASE WHEN   siccode >= 804201 and siccode <= 804207	then 1 end B0447,
CASE WHEN   siccode >= 805101 and siccode <= 805999	then 1 end B0448,
CASE WHEN   siccode >= 806201 and siccode <= 806998	then 1 end B0449,
CASE WHEN  (siccode >= 807101 and siccode <= 807205 and siccode not in ('514109','514815','514910','514915','514942')) then 1 end B0450,
CASE WHEN   siccode in ('801105','809306','809307','809308','809311','809399') then 1 end B0451,
CASE WHEN  (siccode >= 616301 and siccode <= 622104) or (siccode >= 641104 and siccode <= 641124) or (siccode >= 641127 and siccode <= 641198) or siccode in ('514915','628904') then 1 end B0452,
CASE WHEN	siccode >= 616201 and siccode <= 616305 or siccode in ('641105','641107','641132') then 1 end B0453,
CASE WHEN  (siccode >= 621101 and siccode <= 623105 and siccode not in ('622101','622102','622103','622104')) then 1 end B0454,
CASE WHEN	siccode >= 628201 and siccode <= 628218	then 1 end	B0455,
CASE WHEN  (((siccode >= 628201 and siccode <= 628218) or siccode >= 671201 and siccode <= 679999) and siccode not in ('628207','628208','628210','628211','628213')) then 1 end B0456,

CASE WHEN employeesize >= 1000 then 1 end B0457,
CASE WHEN employeesize >= 100 and employeesize <= 499 then 1 end B0458,
CASE WHEN employeesize >= 1 and employeesize <= 9 then 1 end B0459,
CASE WHEN employeesize >= 10 and employeesize <= 49 then 1 end B0460,
CASE WHEN (e.proftitle IN('AAEM','AAPA','AAPS','ABQAURP','ASOPA','CUPA','EDF','FACCP','NAEMSP','NBCOPA','OPA-C','PA-C','PA','DO','MD','RFDS','FS','ME','OB','DC','DMD','DPM','DPT')  OR
            siccode IN('801101','801105','801108','801111','801112','801113','801114','801137','801138','804301','804302','804303','804304','804901','802108')
                 or siccode between 801118 and 801131) then 1 end B0461,
cast(NULL as int) B0462,
CASE WHEN substring(siccode,1,2) = '35' then 1 end B0463,
CASE WHEN substring(siccode,1,2) = '15' then 1 end B0464,
CASE WHEN e.titlecode IN('1','2','5','9','#','C','F','G','H','I','O')  OR
          siccode IN('621101','621104','621105','621109','621110','621111','874209') OR siccode between 628200 and 628299 OR
          substring(siccode,1,3) IN('602','603','604','606') then 1 end B0465,
CASE WHEN siccode in('124101','138101','138210','138902','138930','153101','154220','154236','161114','162202','162304','162321','162904','162912','162917','162925','811110','832290')
                        OR substring(siccode,1,2) = '17' then 1 end B0466,
CASE WHEN SICCODE in('801104','801113','803198','804398','804999','809399')
            OR ((siccode between 801101 and 801138 or siccode between 804301 and 804398) and siccode not in ('801105')) then 1 end B0467,
cast(NULL as int) B0468,
CASE WHEN siccode in('431101') then 1 end B0469,
CASE WHEN substring(SICCODE,1,2) in('01','02') then 1 end B0470,
cast(NULL as int) B0471,
cast(NULL as int) B0472,
CASE WHEN siccode in('653117') then 1 end B0473,
CASE WHEN e.titlecode='C' then 1 end B0474,
CASE WHEN e.titlecode='F' then 1 end B0475,
CASE WHEN e.titlecode='%' then 1 end B0476,
CASE WHEN e.titlecode='E' then 1 end B0477,
CASE WHEN e.titlecode='@' then 1 end B0478,
CASE WHEN e.titlecode='@' then 1 end B0479,
cast(NULL as int) B0480,
CASE WHEN e.titlecode='$' then 1 end B0481,
cast(NULL as int) B0482,
cast(NULL as int) B0483,
CASE WHEN e.titlecode in('$','%','@','C','E','F') then 1 end B0484,
CASE WHEN e.titlecode='4' then 1 end B0485,
CASE WHEN e.titlecode='I' then 1 end B0486,
CASE WHEN e.titlecode='N' then 1 end B0487,
CASE WHEN e.titlecode='?' then 1 end B0488,
CASE WHEN e.titlecode='1' then 1 end B0489,
CASE WHEN e.titlecode='9' then 1 end B0490,
CASE WHEN e.titlecode='A' then 1 end B0491,
CASE WHEN e.titlecode='J' then 1 end B0492,
cast(NULL as int) B0493,
CASE WHEN e.titlecode IN('1','2','C') AND employeesize < 25  then 1 end B0494,
--- new segments 02/21
NULL B0495,
NULL B0496,
NULL B0497,
NULL B0498,
NULL B0499,
NULL B0500,
NULL B0501,
NULL B0502,
NULL B0503,
NULL B0504,
NULL B0505,
NULL B0506,
NULL B0507,
NULL B0508,
NULL B0509,
NULL B0510,
NULL B0511,
NULL B0512,
NULL B0513,
NULL B0514,
NULL B0515,
NULL B0516,
NULL B0517,
NULL B0518,
NULL B0519,
NULL B0520,
NULL B0521,
NULL B0522,
NULL B0523,
NULL B0524,
CASE WHEN	e.titlecode='2'	then 1 end	B0525,
NULL B0526,
NULL B0527,
NULL B0528,
NULL B0529,
NULL B0530,
NULL B0531,
NULL B0532,
NULL B0533,
NULL B0534,
NULL B0535,
NULL B0536,
NULL B0537,
NULL B0538,
NULL B0539,
NULL B0540,
NULL B0541,
NULL B0542,
NULL B0543,
NULL B0544,
NULL B0545,
NULL B0546,
NULL B0547,
NULL B0548,
NULL B0549,
NULL B0550,
NULL B0551,
NULL B0552,
NULL B0553,
NULL B0554,
NULL B0555,
NULL B0556,
NULL B0557,
NULL B0558,
NULL B0559,
NULL B0560,
NULL B0561,
NULL B0562,
NULL B0563,
NULL B0564,
NULL B0565,
NULL B0566,
NULL B0567,
NULL B0568,
NULL B0569,
NULL B0570,
NULL B0571,
NULL B0572,
NULL B0573,
NULL B0574,
NULL B0575,
NULL B0576,
NULL B0577,
NULL B0578,
CASE WHEN	siccode between 830000 and 839999	then 1 end	B0579,
NULL B0580,
NULL B0581,
NULL B0582,
NULL B0583,
NULL B0584,
NULL B0585,
NULL B0586,
CASE WHEN 	(employeesize >= 1 and employeesize <= 500)	 then 1 end	B0587,
CASE WHEN	(employeesize >= 1 and employeesize <= 9)	then 1 end	B0588,
CASE WHEN	(employeesize >= 10 and employeesize <= 50)	then 1 end	B0589,
CASE WHEN	(employeesize >= 51 and employeesize <= 100)	then 1 end	B0590,
CASE WHEN	(employeesize >= 101 and employeesize <= 250)	then 1 end	B0591
 from  digital.business_email_nonmatches_nodups_aws e;
---(73447912 row(s) affected) 00:21:18   ---QA (266171 row(s) affected)



-- Create segments and dedupe from the Sic file
drop table if exists digital.business_sic_segments_full_aws;

create table digital.business_sic_segments_full_aws as
select abinumber,

CASE WHEN ( S_SICCODE >=    737000 AND S_SICCODE <= 737999   ) then 1 end B0001,
 CASE WHEN ( S_SICCODE >=  737000  AND S_SICCODE <=  737999   )  then 1 end B0007,
 CASE WHEN ( S_SICCODE >=  628000  AND S_SICCODE <=  628999 )  OR  S_SICCODE IN (  874209 ) then 1 end B0009,
CASE WHEN  S_SICCODE IN (   179605, 276102, 349301, 353401, 357805, 382507, 394930, 458112, 481210, 481211, 501354, 504437, 504646, 504651, 504653, 504657, 504708, 507521, 507806, 507818, 508342, 508817, 508829, 509334, 515408, 551109, 551110, 555104, 555119, 559917, 573132, 573615, 594105, 594307, 594539, 653133, 729103, 731115, 735308, 738981, 753905, 799310, 811118, 861103, 873203, 874210, 874213, 874214, 874247, 874248, 874259, 874267, 874808, 874810, 874811, 874818  ) then 1 end B0010,
CASE WHEN  ( S_SICCODE >=  800000 AND S_SICCODE <= 809999)
  OR  S_SICCODE IN ( 283407, 283498, 283601, 283602, 308916, 355913, 384301, 384398, 504719, 504917, 512203, 512226, 591205, 591207, 735202, 736116, 769982,
 822109, 822111, 824901, 824906, 862105, 862106, 871177, 873108, 873112, 873115, 873124, 873126, 873127, 874243
   )
then 1 end B0013,
CASE WHEN ( S_SICCODE >= 628101  AND S_SICCODE <=  628206 )  OR  S_SICCODE IN (  628218, 874209 ) then 1 end B0014,
CASE WHEN ( S_SICCODE >=   600000  AND S_SICCODE <=  629999 )  OR  ( S_SICCODE >=  872000  AND S_SICCODE <=  872999 )  OR  S_SICCODE IN (  874209   ) then 1 end B0017,
CASE WHEN ( S_SICCODE >=  737000  AND S_SICCODE <=  737999   )  then 1 end B0019,
CASE WHEN ( S_SICCODE >=  737101  AND S_SICCODE <=  737104 )  OR  S_SICCODE IN (  737106, 737108, 737109, 737205, 737401, 737409   ) then 1 end B0020,
CASE WHEN ( S_SICCODE >=  911101 AND S_SICCODE <= 911104 )  OR  ( S_SICCODE >=  912101 AND S_SICCODE <= 912106 )  OR  S_SICCODE IN (  912109, 912111, 912114 ) then 1 end B0022,
CASE WHEN S_SICCODE IN (  736116, 804907, 804908, 804927, 804955, 805999, 824901 ) then 1 end B0023,
CASE WHEN ( S_SICCODE >=  737000  AND S_SICCODE <=  737999 )  OR  ( S_SICCODE >=  871000  AND S_SICCODE <=  871999 )  OR  ( S_SICCODE >=  873000  AND S_SICCODE <=  873999 )  OR  S_SICCODE IN (  085106, 874853, 874855 ) then 1 end B0024,
CASE WHEN ( S_SICCODE >=  150000  AND S_SICCODE <=  179999 )  then 1 end B0027,
CASE WHEN ( S_SICCODE >=  820000  AND S_SICCODE <=  829999 )  OR  ( S_SICCODE >=  941100  AND S_SICCODE <=  941199 )  OR  S_SICCODE IN (  874825 ) then 1 end B0030,
CASE WHEN ( S_SICCODE >=  628200  AND S_SICCODE <=  628299 )  OR  S_SICCODE IN (  621101, 621104, 621105,  621109, 621110, 621111, 874209, 602101, 671201, 671901 ) then 1 end B0031,
CASE WHEN ( S_SICCODE >=  805000  AND S_SICCODE <=  805999 )  OR  ( S_SICCODE >=  806000  AND S_SICCODE <=  806999 )  OR  S_SICCODE IN ( 736116, 801104, 801105, 801133, 803198, 804398, 804907,804908, 804927, 804955, 809306, 809307, 809308, 809399, 824901 ) then 1 end B0033,
CASE WHEN ( S_SICCODE >=  801111  AND S_SICCODE <=  801114 )  OR  ( S_SICCODE >=   801118  AND S_SICCODE <=  801131 )  OR  ( S_SICCODE >=  804301 AND S_SICCODE <= 804304 )  OR  S_SICCODE IN (  801101, 801105, 801108, 801137, 801138, 804901, 802108 ) then 1 end B0035,
CASE WHEN ( S_SICCODE >=  737101  AND S_SICCODE <=  737106 )  OR  ( S_SICCODE >=   737301  AND S_SICCODE <=  737304 )  OR  ( S_SICCODE >=   737307  AND S_SICCODE <=  737406 )  OR  ( S_SICCODE >=   737408  AND S_SICCODE <=  737410 )  OR  ( S_SICCODE >=   737414  AND S_SICCODE <=  737422 )  OR  ( S_SICCODE >=   737425  AND S_SICCODE <=  737427 )  OR  ( S_SICCODE >=  737503  AND S_SICCODE <=  737505 )  OR  ( S_SICCODE >=  737901  AND S_SICCODE <=  737907 )  OR  ( S_SICCODE >=  737910  AND S_SICCODE <=  737999    )  OR  S_SICCODE IN (  737109, 737203, 737698 ) then 1 end B0036,
CASE WHEN ( S_SICCODE >=  823101  AND S_SICCODE <=  823104 )  OR  ( S_SICCODE >=  910000  AND S_SICCODE <=  979999 )  OR  S_SICCODE IN (  655303, 806904, 822105, 832253, 833108, 873307, 899931 ) then 1 end B0037,
CASE WHEN ( S_SICCODE >=  731000  AND S_SICCODE <=  731999 )  OR  S_SICCODE IN (  733105, 733605, 873202, 873204, 874302, 874823   ) then 1 end B0039,
CASE WHEN
( S_SICCODE >=  800000 AND S_SICCODE <= 809999     )  OR
   S_SICCODE IN ( 283407, 283498, 283601, 283602, 308916, 355913, 384301, 384398, 504719, 504917, 512203, 512226, 591205, 591207, 735202, 736116, 769982,
822109, 822111, 824901, 824906, 862105, 862106, 871177, 873108, 873112, 873115, 873124, 873126, 873127, 874243 ) then 1 end B0040,
CASE WHEN ( S_SICCODE >= 150000  AND S_SICCODE <=  179999 )  then 1 end B0041,
CASE WHEN S_SICCODE IN ( 283407, 283498, 283601, 283602, 308916, 355913, 504917, 512203, 512226, 591205, 591207, 807107, 807114, 822111, 862105, 871177, 873108, 873112, 873115, 873124, 873126, 873127 ) then 1 end B0042,
CASE WHEN ( S_SICCODE >= 596100 AND S_SICCODE <= 596199 )  then 1 end B0043,
CASE WHEN ( S_SICCODE >=  736103  AND S_SICCODE <=  736106 )  OR  ( S_SICCODE >=  944101  AND S_SICCODE <=  944104 )  OR  S_SICCODE IN (  637103, 874216, 874222 ) then 1 end B0044,
CASE WHEN ( S_SICCODE >= 730000 AND S_SICCODE <= 739999 )  then 1 end B0046,
CASE WHEN S_SICCODE IN (  737108, 737109 ) then 1 end B0047,
CASE WHEN S_SICCODE IN (   179605, 276102, 349301, 353401, 357805, 382507, 394930, 458112, 481210, 481211, 501354, 504437, 504646, 504651, 504653, 504657, 504708, 507521, 507806, 507818, 508342, 508817, 508829, 509334, 515408, 551109, 551110, 555104, 555119, 559917, 573132, 573615, 594105, 594307, 594539, 653133, 729103, 731115, 735308, 738981, 753905, 799310, 811118, 861103, 873203, 874210, 874213, 874214, 874247, 874248, 874259, 874267, 874808, 874810, 874811, 874818  ) then 1 end B0048,
CASE WHEN S_SICCODE IN ( 737202, 737205, 737316, 737410, 737411, 737502, 737598, 737913 ) then 1 end B0051,
CASE WHEN ( S_SICCODE >=  823101  AND S_SICCODE <=  823104 )  OR  ( S_SICCODE >=  830000  AND S_SICCODE <=  839999 )  OR  ( S_SICCODE >=  910000  AND S_SICCODE <=  979999 )  OR  S_SICCODE IN (  085101, 655303, 673298, 738102, 738111, 738122, 738949, 804910,  804921, 804970, 804992, 806904, 822105, 824916, 824951, 824952, 829947, 866137, 874208, 874813, 874832 ) then 1 end B0052,
CASE WHEN ( S_SICCODE >= 805000 AND S_SICCODE <= 805999 )  then 1 end B0053,
CASE WHEN ( S_SICCODE >=   600000  AND S_SICCODE <=  629999 )  OR  ( S_SICCODE >=  872000  AND S_SICCODE <=  872999 )  OR  S_SICCODE IN (  874209 ) then 1 end B0054,

CASE WHEN S_SICCODE IN (  737103, 737104, 737301, 737303, 737304, 737316, 737398, 737504, 737906, 737910, 737901, 737304, 737314, 737317, 737421, 737904 ) then 1 end B0055,
CASE WHEN ( S_SICCODE >=  736103  AND S_SICCODE <=  736106 )  then 1 end B0056,
CASE WHEN  S_SICCODE IN (  871110 ) then 1 end B0057,
CASE WHEN ( S_SICCODE >=  737102 AND S_SICCODE <= 737106 )  OR  S_SICCODE IN (  737108, 737109, 737205, 737398, 737409, 737410, 737411, 737421, 737424, 737905, 737906 ) then 1 end B0058,
CASE WHEN S_SICCODE IN (  573418, 737108 ) then 1 end B0059,
CASE WHEN ( S_SICCODE >= 421000 AND S_SICCODE <= 421999 )  OR  S_SICCODE IN (  423102, 423103, 444902, 444905, 444906, 473101, 473116, 473120, 473121, 473124, 473125, 478503, 478508, 478978, 511301, 511306, 511333, 514805, 514813, 515307, 733101, 733110, 861110, 874812  ) then 1 end B0060,
CASE WHEN ( S_SICCODE >= 594500 AND S_SICCODE <= 594699 )  then 1 end B0061,
CASE WHEN ( S_SICCODE >=  200000 AND S_SICCODE <= 399999 )  then 1 end B0062,
CASE WHEN  ( S_SICCODE >=   600000  AND S_SICCODE <=  629999 )  OR  ( S_SICCODE >=  872000  AND S_SICCODE <=  872999 )  OR  S_SICCODE IN (  874209  ) then 1 end B0063,
CASE WHEN
( S_SICCODE >=  600000  AND S_SICCODE <=  619999 )  OR
( S_SICCODE >=  811000  AND S_SICCODE <=  811999 )  OR
( S_SICCODE >=  944101  AND S_SICCODE <=  944104     ) OR
S_SICCODE IN (  874222 )
 then 1 end B0065,
CASE WHEN S_SICCODE IN (  737204, 737404 ) then 1 end B0065b,
CASE WHEN S_SICCODE IN ( 733604,733603 ) then 1 end B0066,
CASE WHEN S_SICCODE IN ( 801104, 801133, 803198, 804398, 804999, 807104, 809305, 809399  ) then 1 end B0067,
CASE WHEN S_SICCODE IN (  871122, 871125 ) then 1 end B0070,
CASE WHEN ( S_SICCODE >=   600000  AND S_SICCODE <=  629999 )  OR  ( S_SICCODE >=  872000  AND S_SICCODE <=  872999 )  OR  S_SICCODE IN (  874209 ) then 1 end B0071,
CASE WHEN S_SICCODE IN ( '018105', 122102, 341202, 421201, 421205, 421212, 421231, 421302, 421303, 421304, 421305, 421306, 421307, 421308, 421309, 421318, 421320, 421321, 421498, 421502, 421503, 423102, 444902, 444906, 473101, 473120, 473121, 473125, 492505, 511301, 511306, 511333, 514805, 514813, 515307, 581230, 596302, 596309, 733101, 733110, 753220, 861110, 874266, 874812, 922906, '078102' ) then 1 end B0072,
CASE WHEN S_SICCODE IN ( 581208, 581224, 581251, 581301, 581255 ) then 1 end B0073,
CASE WHEN ( S_SICCODE >= 401000  AND S_SICCODE <=  429999 )  OR  ( S_SICCODE >=  440000  AND S_SICCODE <=  448999 )  OR  ( S_SICCODE >=  451000  AND S_SICCODE <=  452999 )  OR  ( S_SICCODE >=  472400 AND S_SICCODE <= 472499 )  OR  ( S_SICCODE >=   473100  AND S_SICCODE <=  478999 )  OR  S_SICCODE IN (  735939 ) then 1 end B0074,
CASE WHEN ( S_SICCODE >= 520000 AND S_SICCODE <= 599999 )  then 1 end B0075,
CASE WHEN S_SICCODE IN ( 804921, 804970, 832204, 832215, 832218, 832219, 832221, 832227, 832244, 832245, 832253, 832266, 832282, 832283, 832284, 832289, 832293, 839999, 944101, 944102, 944103, 944104 ) then 1 end B0076,
CASE WHEN S_SICCODE IN ( 701101, 701111,581208, 581224, 581251, 581301, 581255 ) then 1 end B0077,
CASE WHEN S_SICCODE IN (   179605, 276102, 349301, 353401, 357805, 382507, 394930, 458112, 481210, 481211, 501354, 504437, 504646, 504651, 504653, 504657, 504708, 507521, 507806, 507818, 508342, 508817, 508829, 509334, 515408, 551109, 551110, 555104, 555119, 559917, 573132, 573615, 594105, 594307, 594539, 653133, 729103, 735308, 738921, 738981, 753905, 799310, 861103, 874267, 874808, 874810, 874811  ) then 1 end B0078,
CASE WHEN ( S_SICCODE >=  871100 AND S_SICCODE <= 871199 )  then 1 end B0080,
CASE WHEN    S_SICCODE IN (  637103, 874216, 874222 ) then 1 end B0081,
CASE WHEN    ( S_SICCODE >= 820000  AND S_SICCODE <=  829999 )  OR  ( S_SICCODE >=  941100  AND S_SICCODE <=  941199 )  OR  S_SICCODE IN (  874825 ) then 1 end B0082,
CASE WHEN    ( S_SICCODE >=  628000  AND S_SICCODE <=  628999 )  OR  S_SICCODE IN (  874209 ) then 1 end B0084,
CASE WHEN    S_SICCODE IN (  871211, 871202, 871112, 871307 ) then 1 end B0086,
CASE WHEN  ( S_SICCODE >=  823101  AND S_SICCODE <=  823104 )  OR  ( S_SICCODE >=  910000  AND S_SICCODE <=  979999 )  OR  S_SICCODE IN (  655303, 806904, 822105, 832253, 833108, 873307, 899931 ) then 1 end B0087,
CASE WHEN    ( S_SICCODE >=  628200  AND S_SICCODE <=  628299 )  OR  ( S_SICCODE >=  872000  AND S_SICCODE <=  872999 )  then 1 end B0088,
CASE WHEN    S_SICCODE IN ( 628202, 628214, 628217, 672298, 672699, 874209 ) then 1 end B0089,
CASE WHEN    ( S_SICCODE >=  737000  AND S_SICCODE <=  737999 )  then 1 end B0090,
CASE WHEN    ( S_SICCODE >= 480000 AND S_SICCODE <= 489999 )  then 1 end B0091,
CASE WHEN    S_SICCODE IN ( 591205, 591207, 804939, 822111, 862105 ) then 1 end B0092,
CASE WHEN    ( S_SICCODE >=  737000  AND S_SICCODE <=  737999 )  then 1 end B0094,
CASE WHEN    ( S_SICCODE >=  944101  AND S_SICCODE <=  944104 )  OR  S_SICCODE IN (  874222 ) then 1 end B0095,
CASE WHEN    ( S_SICCODE >=  200000 AND S_SICCODE <= 399999  )  then 1 end B0096,
CASE WHEN    S_SICCODE IN (   179605, 276102, 349301, 353401, 357805, 382507, 394930, 458112, 481210, 481211, 501354, 504437, 504646, 504651, 504653, 504657, 504708, 507521, 507806, 507818, 508342, 508817, 508829, 509334, 515408, 551109, 551110, 555104, 555119, 559917, 573132, 573615, 594105, 594307, 594539, 653133, 729103, 735308, 738921, 738981, 753905, 799310, 861103, 874267, 874808, 874810, 874811  ) then 1 end B0097,
CASE WHEN    ( S_SICCODE >=  628200  AND S_SICCODE <=  628299 )  OR  S_SICCODE IN (  621101, 621104, 621105,  621109, 621110, 621111, 874209, 602101, 671201, 671901 ) then 1 end B0098,
CASE WHEN    ( S_SICCODE >= 911101 AND S_SICCODE <= 912106 )  OR  ( S_SICCODE >= 912115 AND S_SICCODE <= 922102 )  OR  ( S_SICCODE >= 922201 AND S_SICCODE <= 961104 )  OR  ( S_SICCODE >= 962101 AND S_SICCODE <= 963104 )  OR  ( S_SICCODE >= 964101 AND S_SICCODE <= 964104 )  OR  ( S_SICCODE >= 965101 AND S_SICCODE <= 965104 )  OR  ( S_SICCODE >= 966101 AND S_SICCODE <= 971109 )  then 1 end B0099,
CASE WHEN    ( S_SICCODE >=  651201  AND S_SICCODE <=  651208 )  OR  S_SICCODE IN (  651298, 651498, 653102, 653103, 653104, 653108, 653109, 653114, 653117, 653118, 653120, 653121, 653122, 653125, 653127, 653131, 653135, 653136, 653139, 653140, 653144, 653147, 653149, 654101, 654102, 654103, 655201, 655202, 655205, 655206 )
OR
s_yellowpagecode IN (70730)
then 1 end B0100,

CASE WHEN ( S_SICCODE >= 641100 AND S_SICCODE <= 641199 ) then 1 end B0102,
CASE WHEN ( S_SICCODE >= 200000 AND S_SICCODE <= 399999 ) then 1 end B0103,
CASE WHEN ( S_SICCODE >= 500000 AND S_SICCODE <= 519999 ) then 1 end B0104,
CASE WHEN ( S_SICCODE >= 130000 AND S_SICCODE <= 139999 ) OR S_SICCODE IN ( 171131, 179412, 329604, 343305, 361202, 361301, 362104, 362105, 362504, 362506, 362901, 362998, 369902, 382202, 382208, 491101, 491103, 493198, 493902, 496102, 503306, 506307, 506312, 506316, 506317, 506329, 506330, 506347, 506357, 506358, 506359, 506366, 506369, 506374, 506387, 506399, 506520, 507405, 507407, 507416, 507438, 508465, 521135, 521136, 653149, 735931, 738943, 762999, 769404, 769932, 807116, 871115, 871150, 873103, 873421, 874212, 874217, 874218, 874851, 874893, 999947, 999950 ) then 1 end B0105,
CASE WHEN S_SICCODE IN ( 085101, 738102, 738111, 738122, 738949, 804910, 804992, 824916, 824951, 824952, 829947, 874208, 874813, 874832, 912108, 922101, 922102, 922104, 922401, 922402, 922403, 922404, 922405, 922901, 922902, 922903, 922904, 971101, 971102, 971103, 971104 ) then 1 end B0108,
CASE WHEN S_SICCODE IN ( 673298, 839919, 839998, 866137 ) then 1 end B0111,
CASE WHEN S_SICCODE IN ( 179605, 276102, 349301, 353401, 357805, 382507, 394930, 458112, 481210, 481211, 501354, 504437, 504646, 504651, 504653, 504657, 504708, 507521, 507806, 507818, 508342, 508817, 508829, 509334, 515408, 551109, 551110, 555104, 555119, 559917, 573132, 573615, 594105, 594307, 594539, 653133, 729103, 735308, 738921, 738981, 753905, 799310, 861103, 874267, 874808, 874810, 874811 ) then 1 end B0113,
CASE WHEN ( S_SICCODE >= 802101 AND S_SICCODE <= 802106 ) OR S_SICCODE IN ( 384301, 384398, 504719, 735202, 769982, 804914, 807102, 807103, 807201, 807202, 807203, 807204, 807205, 809902, 809903, 809925, 822109, 824906, 862106, 874243 ) then 1 end B0114,
CASE WHEN ( S_SICCODE >= 802101 AND S_SICCODE <= 802106 ) OR S_SICCODE IN ( 384301, 384398, 504719, 735202, 769982, 804914, 807102, 807103, 807201, 807202, 807203, 807204, 807205, 809902, 809903, 809925, 822109, 824906, 862106, 874243 ) then 1 end B0116,
CASE WHEN ( S_SICCODE >= 971101 AND S_SICCODE <= 971104 ) OR S_SICCODE IN ( 874813 ) then 1 end B0117,
CASE WHEN ( S_SICCODE >= 651201 AND S_SICCODE <= 651598 ) OR ( S_SICCODE >= 653000 AND S_SICCODE <= 653999 ) OR ( S_SICCODE >= 654101 AND S_SICCODE <= 654107 ) OR ( S_SICCODE >= 655201 AND S_SICCODE <= 655207 ) OR S_SICCODE IN ( 614106, 615904, 616201, 616202, 616203, 616204, 616207, 616302, 616305, 633101, 635107, 639901 ) then 1 end B0119,
CASE WHEN ( S_SICCODE >= 874000 AND S_SICCODE <= 874999 ) OR S_SICCODE IN ( '071105', '072101', '072111', '075216', '075226', '078101', '078104', '078108', '092101', 138204, 138207, 138209, 138213, 144204, 152152, 161105, 162323, 162937, 171134, 171142, 171147, 174212, 176105, 179501, 179999, 242106, 252206, 347108, 421321, 448904, 449110, 449203, 472403, 472407, 473101, 473103, 473110, 473125, 493904, 493905, 494105, 495204, 495308, 495321, 505205, 571314, 581220, 591207, 594169, 596305, 599989, 616204, 628202, 628204, 628205, 628217, 632101, 632406, 641104, 641113, 641117, 651207, 651902, 653106, 653108, 653117, 653121, 653124, 653129, 653131, 653136, 653140, 655206, 672298, 673305, 701103, 723112, 729103, 729901, 729905, 729921, 729932, 729947, 731102, 733508, 736104, 736105, 736110, 737103, 737104, 737205, 737318, 737698, 737807, 737901, 737902, 737905, 737906, 738111, 738118, 738902, 738985, 738992, 752103, 754921, '076202', '076204', 781905, 781908, 781910, 792218, 792222, 799112, 801117, 804903, 804992, 832223, 835104, 871102, 871127, 871150, 871167, 871210, 871222, 871312, 872105, 872110, 873113, 873118, 873127, 873130, 873142, 873207, 873209, 873406, 873409, 873417, 899904, 899914, '097105') then 1 end B0121,
CASE WHEN ( S_SICCODE >= 811100 AND S_SICCODE <= 811199 ) then 1 end B0122,
CASE WHEN S_SICCODE IN ( 737108, 737109 ) then 1 end B0123,
CASE WHEN ( S_SICCODE >= 372000 AND S_SICCODE <= 372999 ) then 1 end B0124,
CASE WHEN ( S_SICCODE >= 010000 AND S_SICCODE <= 029999 ) OR ( S_SICCODE >= 070000 AND S_SICCODE <= 099999 ) then 1 end B0125,
CASE WHEN ( S_SICCODE >= 217000 AND S_SICCODE <= 274999 ) OR ( S_SICCODE >= 483000 AND S_SICCODE <= 489999 ) OR ( S_SICCODE >= 738300 AND S_SICCODE <= 738399 ) OR ( S_SICCODE >= 780000 AND S_SICCODE <= 792999 ) OR ( S_SICCODE >= 841201 AND S_SICCODE <= 841210 ) OR S_SICCODE IN ( 599969 ) then 1 end B0126,
CASE WHEN ( S_SICCODE >= 811100 AND S_SICCODE <= 811199 ) then 1 end B0127,
CASE WHEN ( S_SICCODE >= 820000 AND S_SICCODE <= 820999 ) OR ( S_SICCODE >= 941100 AND S_SICCODE <= 941199 ) OR S_SICCODE IN ( 874802, 874825 ) then 1 end B0128,
CASE WHEN S_SICCODE IN ( 399303, 399398, 519917, 519956, 519959, 731101, 731103, 731104, 731105, 731106, 731107, 731108, 731109, 731110, 731111, 731112, 731114, 731115, 731201, 731205, 731303, 731305, 731306, 731307, 731308, 731902, 731903, 731910, 731911, 731914, 731915, 731916, 731917, 731918, 731919, 731920, 731921, 731926, 731927, 731928, 731999, 733105, 733605, 811118, 824915, 873202, 873203, 873204, 874210, 874213, 874214, 874247, 874248, 874259, 874302, 874818, 874840, 874864 ) then 1 end B0129,
CASE WHEN ( S_SICCODE >= 628200 AND S_SICCODE <= 628299 ) OR S_SICCODE IN ( 621101, 621104, 621105, 621109, 621110, 621111, 874209, 602101, 671201, 671901 ) then 1 end B0130,
CASE WHEN s_yellowpagecode IN (69303, 69307) then 1 end B0131,
CASE WHEN ( S_SICCODE >= 872000 AND S_SICCODE <= 872999 ) then 1 end B0132,
CASE WHEN S_SICCODE IN ( 179605, 276102, 349301, 353401, 357805, 382507, 394930, 399303, 399398, 458112, 481210, 481211, 501354, 504437, 504646, 504651, 504653, 504657, 504708, 507521, 507806, 507818, 508342, 508817, 508829, 509334, 515408, 519917, 519956, 519959, 551109, 551110, 555104, 555119, 559917, 573132, 573615, 594105, 594307, 594539, 653133, 729103, 731101, 731103, 731104, 731105, 731106, 731107, 731108, 731109, 731110, 731111, 731112, 731114, 731115, 731201, 731205, 731303, 731305, 731306, 731307, 731308, 731902, 731903, 731911, 731914, 731915, 731916, 731917, 731918, 731919, 731920, 731921, 731926, 731927, 731928, 731999, 733105, 733605, 735308, 738981, 753905, 799310, 811118, 824915, 861103, 873203, 874210, 874213, 874214, 874247, 874248, 874259, 874267, 874808, 874810, 874811, 874818 ) then 1 end B0133,
CASE WHEN ( S_SICCODE >= 874000 AND S_SICCODE <= 874999 ) OR S_SICCODE IN ( '071105', '072101', '072111', '075216', '075226', '078101', '078104', '078108', '092101', 138204, 138207, 138209, 138213, 144204, 152152, 161105, 162323, 162937, 171134, 171142, 171147, 174212, 176105, 179501, 179999, 242106, 252206, 347108, 448904, 472403, 473101, 473103, 473110, 473125, 495204, 495308, 495321, 505205, 571314, 591207, 599989, 616204, 628204, 628205, 632101, 632406, 641104, 641113, 641117, 651207, 653117, 653124, 653129, 653131, 653140, 673305, 723112, 729103, 729901, 729905, 729921, 729932, 729947, 731102, 733508, 736104, 736105, 736110, 737103, 737104, 737318, 737807, 737901, 737902, 737905, 737906, 738111, 738118, 738902, 738985, 738992, 752103, 754921, 781905, 781908, 781910, 792218, 792222, 801117, 804903, 804992, 835104, 871102, 871167, 871210, 871222, 871312, 872105, 873118, 873127, 873130, 873142, 873207, 873209, 873406, 873409, 873417, 899904, 899914 ) then 1 end B0134,
CASE WHEN S_SICCODE IN ( 621105, 621109, 621111, 628202, 628213, 628214, 628215, 653104, 672298, 672699, 679801, 679902, 679998 ) then 1 end B0136,
CASE WHEN ( S_SICCODE >= 736103 AND S_SICCODE <= 736106 ) OR ( S_SICCODE >= 944101 AND S_SICCODE <= 944104 ) OR S_SICCODE IN ( 637103, 874216, 874222 ) then 1 end B0137,
CASE WHEN ( S_SICCODE >= 130000 AND S_SICCODE <= 139999 ) then 1 end B0138,
CASE WHEN ( S_SICCODE >= 200000 AND S_SICCODE <= 399999 ) then 1 end B0140,
CASE WHEN s_siccode in ('274121','874126','874882') or substring(s_siccode,1,4) in ('3571','3572','3575','3577','5045','5065','5734','8243') or substring(s_siccode,1,3) in ('367','737') then 1 end B0378,
CASE WHEN s_siccode in ('274121','874126','874882') or substring(s_siccode,1,4) in ('3571','3572','3575','3577','5045','5065','5734','8243') or substring(s_siccode,1,3) in ('367','737') then 1 end B0379,
CASE WHEN s_siccode in ('944101','944102','944103','944104','874203','874204','874216','874222') or substring(s_siccode,1,3) in ('736','833') then 1 end B0380,
CASE WHEN substring(s_siccode,1,3) in ('931') or substring(s_siccode,1,2) in ('60','61','62') then 1 end B0381,
CASE WHEN substring(s_siccode,1,3) in ('872') then 1 end B0382,
CASE WHEN substring(s_siccode,1,2) in ('81') then 1 end B0383,
CASE WHEN s_siccode in ('874213','874214','874259','874210','874248','874818','874247','873203') or substring(s_siccode,1,3) in ('731') then 1 end B0384,
CASE WHEN substring(s_siccode,1,2) in ('80') then 1 end B0385,
CASE WHEN substring(s_siccode,1,2) in ('63','64') then 1 end B0386,
CASE WHEN substring(s_siccode,1,3) in ('871') then 1 end B0387,
CASE WHEN substring(s_siccode,1,3) in ('873') then 1 end B0388,
CASE WHEN substring(s_siccode,1,2) in ('20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39') then 1 end B0389,
CASE WHEN substring(s_siccode,1,2) in ('40','41','42','43','44','45','46','47') then 1 end B0390,
CASE WHEN substring(s_siccode,1,2) in ('82','83') then 1 end B0391,
CASE WHEN substring(s_siccode,1,2) in ('91','92','93','94','95','96','97') then 1 end B0392,
CASE WHEN substring(s_siccode,1,2) in ('58') then 1 end B0393,
CASE WHEN substring(s_siccode,1,3) in ('866') then 1 end B0394,
CASE WHEN substring(s_siccode,1,2) in ('15','16','17') then 1 end B0395,
CASE WHEN substring(s_siccode,1,2) in ('10','11','12','13','14') then 1 end B0396,
CASE WHEN substring(s_siccode,1,3) in ('753','762','763','764','769') then 1 end B0397,
CASE WHEN substring(s_siccode,1,4) in ('7349') then 1 end B0398,
CASE WHEN s_siccode in ('421205','421206','421209','421212','421214','421226','421229','421230','421231','421234','421235','421303','421304',
 '421305','421306','421307','421308','421309','421310','421318','421320','421321','421322','421403','421404','421498','421501','421502',
 '421503','421504','423102','423103','441298','442401','442498','443298','444901','444902','444905','444906','444999') then 1 end B0422,
CASE WHEN s_siccode in ('531110') then 1 end B0423,
CASE WHEN (s_siccode >= 541101 and s_siccode <= 549999 and
 s_siccode not in ('541103','542104','542105','546101','546102','546103','546104','546105','546106','546107','546108','546109','546110',
 '546111','546112','549905','549906','549924','549925','549934','549938')) then 1 end B0424,
CASE WHEN s_siccode in ('541103','554101') then 1 end B0425,
CASE WHEN s_siccode >= 561101 and s_siccode <= 569989 then 1 end B0426,
CASE WHEN s_siccode >= 594101 and s_siccode <= 594179 then 1 end B0427,
CASE WHEN s_siccode >= 594401 and s_siccode <= 594423 or s_siccode in ('593216') then 1 end B0428,
CASE WHEN (s_siccode >= 594301 and s_siccode <= 594319 and s_siccode not in ('594308','594312','594313','594317','594318','594319')) then 1 end B0429,
CASE WHEN s_siccode >= 594501 and s_siccode <= 594546 then 1 end B0430,
CASE WHEN s_siccode in ('599973','599992','599996','599997','599998') then 1 end B0431,
CASE WHEN (s_siccode >= 581201 and s_siccode <= 581309 and s_siccode not in ('581204','581210','581256')) then 1 end B0432,
CASE WHEN s_siccode >= 592101 and s_siccode <= 592107 then 1 end B0433,
CASE WHEN s_siccode >= 701101 and s_siccode <= 702198 then 1 end B0434,
CASE WHEN ((s_siccode >= 821101 and s_siccode <= 822298) or (s_siccode >= 824401 and s_siccode <= 824999) and s_siccode not in ('821114','824901','824951','824952')) or
 s_siccode in ('829907','829914','829924','829935','829948','829957','829962','829963','829964','829968','829974','829990') then 1 end B0435,
CASE WHEN s_siccode >= 509101 and s_siccode <= 509165 then 1 end B0436,
CASE WHEN s_siccode >= 509201 and s_siccode <= 509224 then 1 end B0437,
CASE WHEN s_siccode >= 509401 and s_siccode <= 509440 then 1 end B0438,
CASE WHEN s_siccode >= 511101 and s_siccode <= 511239 then 1 end B0439,
CASE WHEN (s_siccode >= 513601 and s_siccode <= 513911 and s_siccode not in ('513617','513627','513732')) then 1 end B0440,
CASE WHEN (s_siccode >= 514101 and s_siccode <= 514999 and s_siccode not in ('514109','514815','514910','514915','514942')) then 1 end B0441,
CASE WHEN s_siccode >= 518101 and s_siccode <= 518207 or s_siccode in ('514915') then 1 end B0442,
CASE WHEN s_siccode >= 591201 and s_siccode <= 591214 or s_siccode in ('804939') then 1 end B0443,
CASE WHEN (((s_siccode >= 801101 and s_siccode <= 801138) or s_siccode >= 804301 and s_siccode <= 804398) and s_siccode not in ('801105')) then 1 end B0444,
CASE WHEN s_siccode >= 802101 and s_siccode <= 802106 then 1 end B0445,
CASE WHEN s_siccode >= 804101 and s_siccode <= 804104 then 1 end B0446,
CASE WHEN s_siccode >= 804201 and s_siccode <= 804207 then 1 end B0447,
CASE WHEN s_siccode >= 805101 and s_siccode <= 805999 then 1 end B0448,
CASE WHEN s_siccode >= 806201 and s_siccode <= 806998 then 1 end B0449,
CASE WHEN (s_siccode >= 807101 and s_siccode <= 807205 and s_siccode not in ('514109','514815','514910','514915','514942')) then 1 end B0450,
CASE WHEN s_siccode in ('801105','809306','809307','809308','809311','809399') then 1 end B0451,
CASE WHEN (s_siccode >= 616301 and s_siccode <= 622104) or (s_siccode >= 641104 and s_siccode <= 641124) or (s_siccode >= 641127 and s_siccode <= 641198) or s_siccode in ('514915','628904') then 1 end B0452,
CASE WHEN s_siccode >= 616201 and s_siccode <= 616305 or s_siccode in ('641105','641107','641132') then 1 end B0453,
CASE WHEN (s_siccode >= 621101 and s_siccode <= 623105 and s_siccode not in ('622101','622102','622103','622104')) then 1 end B0454,
CASE WHEN s_siccode >= 628201 and s_siccode <= 628218 then 1 end B0455,
CASE WHEN ((s_siccode >= 628201 and s_siccode <= 628218 or s_siccode >= 671201 and s_siccode <= 679999) and s_siccode not in ('628207','628208','628210','628211','628213')) then 1 end B0456,
CASE WHEN (s_siccode IN('801101','801105','801108','801111','801112','801113','801114','801137','801138','804301','804302','804303','804304','804901','802108')
 or s_siccode between 801118 and 801131) then 1 end B0461,
CASE WHEN (s_siccode = '801101' AND S_FranchiseCode1 = 'T' ) then 1 end B0462,
CASE WHEN substring(s_siccode,1,2) = '35' then 1 end B0463,
CASE WHEN substring(s_siccode,1,2) = '15' then 1 end B0464,
CASE WHEN s_siccode IN('621101','621104','621105','621109','621110','621111','874209') OR
s_siccode between 628200 and 628299 OR substring(s_siccode,1,3) IN('602','603','604','606') then 1 end B0465,
CASE WHEN s_siccode in ('124101','138101','138210','138902','138930','153101','154220','154236','161114','162202','162304','162321','162904','162912','162917','162925','811110','832290') OR
substring(s_siccode,1,2) = '17' then 1 end B0466,
CASE WHEN S_SICCODE in('801104','801113','803198','804398','804999','809399') OR
((S_siccode between 801101 and 801138 or s_siccode between 804301 and 804398) and s_siccode not in('801105')) then 1 end B0467,
CASE WHEN s_siccode in('431101') then 1 end B0469,
CASE WHEN substring(S_SICCODE,1,2) in('01','02') then 1 end B0470,
CASE WHEN s_siccode in('653117') then 1 end B0473,
CASE WHEN substring(s_siccode,1,2) in('35','36','50','57','73') then 1 end B0479,
CASE WHEN substring(S_SICCODE,1,3)='737' OR S_SICCODE in('274128','274130','489907','596102','596106','738204','781925','864120','871186','873110','873141','874402','874862') then 1 end B0493,
--- new segs
case when  (S_siccode between 370000 and 379999 or S_siccode between 551100 and 551199) then 1 end  B0552,
case when  (S_siccode between 600000 and 609999) then 1 end  B0553,
case when  (S_siccode between 150000 and 179999) then 1 end  B0554,
case when  (S_siccode between 120000 and 139999) then 1 end  B0555,
case when  (S_siccode between 610000 and 619999) then 1 end  B0556,
case when  (S_siccode between 800000 and 809999) then 1 end  B0557,
case when  S_siccode between 630000 and 649999) then 1 end   B0558,
case when  (S_siccode between 200000 and 399999) then 1 end  B0559,
case when  S_siccode between 520000 and 599999) then 1 end   B0560,
case when  (S_siccode between 480000 and 489999) then 1 end  B0561,
case when  (S_siccode between 400000 and 479999) then 1 end  B0562,
case when  (S_siccode between 490000 and 499999) then 1 end  B0563,
case when  (S_siccode between 370000 and 379999 or S_siccode between 551100 and 551199) then 1 end  B0564,
case when  (S_siccode between 600000 and 609999) then 1 end  B0565,
case when  (S_siccode between 150000 and 179999) then 1 end  B0566,
case when  (S_siccode between 120000 and 139999) then 1 end  B0567,
case when  (S_siccode between 610000 and 619999) then 1 end  B0568,
case when  (S_siccode between 800000 and 809999) then 1 end  B0569,
case when  (S_siccode between 630000 and 649999) then 1 end  B0570,
case when  (S_siccode between 200000 and 399999) then 1 end  B0571,
case when  (S_siccode between 520000 and 599999) then 1 end  B0572,
case when  (S_siccode between 480000 and 489999) then 1 end  B0573,
case when  (S_siccode between 400000 and 479999) then 1 end  B0574,
case when  (S_siccode between 490000 and 499999) then 1 end  B0575,
case when  (S_siccode between 830000 and 839999) then 1 end  B0579
  from digital.business_sic_fullset;
 ---(83145326 rows affected)  00:21:03  ---(238937 rows affected)
 ---(59248443 rows affected) with distinct
---58,886,478

drop table if exists digital.business_sic_segments_full_nodup_aws;

create table digital.business_sic_segments_full_nodup_aws as
select
abinumber,
max(	B0001	) as 	B0001	,
max(	B0007	) as 	B0007	,
max(	B0009	) as 	B0009	,
max(	B0010	) as 	B0010	,
max(	B0013	) as 	B0013	,
max(	B0014	) as 	B0014	,
max(	B0017	) as 	B0017	,
max(	B0019	) as 	B0019	,
max(	B0020	) as 	B0020	,
max(	B0022	) as 	B0022	,
max(	B0023	) as 	B0023	,
max(	B0024	) as 	B0024	,
max(	B0027	) as 	B0027	,
max(	B0030	) as 	B0030	,
max(	B0031	) as 	B0031	,
max(	B0033	) as 	B0033	,
max(	B0035	) as 	B0035	,
max(	B0036	) as 	B0036	,
max(	B0037	) as 	B0037	,
max(	B0039	) as 	B0039	,
max(	B0040	) as 	B0040	,
max(	B0041	) as 	B0041	,
max(	B0042	) as 	B0042	,
max(	B0043	) as 	B0043	,
max(	B0044	) as 	B0044	,
max(	B0046	) as 	B0046	,
max(	B0047	) as 	B0047	,
max(	B0048	) as 	B0048	,
max(	B0051	) as 	B0051	,
max(	B0052	) as 	B0052	,
max(	B0053	) as 	B0053	,
max(	B0054	) as 	B0054	,
max(	B0055	) as 	B0055	,
max(	B0056	) as 	B0056	,
max(	B0057	) as 	B0057	,
max(	B0058	) as 	B0058	,
max(	B0059	) as 	B0059	,
max(	B0060	) as 	B0060	,
max(	B0061	) as 	B0061	,
max(	B0062	) as 	B0062	,
max(	B0063	) as 	B0063	,
max(	B0065	) as 	B0065	,
max(	B0065b	) as 	B0065b	,
max(	B0066	) as 	B0066	,
max(	B0067	) as 	B0067	,
max(	B0070	) as 	B0070	,
max(	B0071	) as 	B0071	,
max(	B0072	) as 	B0072	,
max(	B0073	) as 	B0073	,
max(	B0074	) as 	B0074	,
max(	B0075	) as 	B0075	,
max(	B0076	) as 	B0076	,
max(	B0077	) as 	B0077	,
max(	B0078	) as 	B0078	,
max(	B0080	) as 	B0080	,
max(	B0081	) as 	B0081	,
max(	B0082	) as 	B0082	,
max(	B0084	) as 	B0084	,
max(	B0086	) as 	B0086	,
max(	B0087	) as 	B0087	,
max(	B0088	) as 	B0088	,
max(	B0089	) as 	B0089	,
max(	B0090	) as 	B0090	,
max(	B0091	) as 	B0091	,
max(	B0092	) as 	B0092	,
max(	B0094	) as 	B0094	,
max(	B0095	) as 	B0095	,
max(	B0096	) as 	B0096	,
max(	B0097	) as 	B0097	,
max(	B0098	) as 	B0098	,
max(	B0099	) as 	B0099	,
max(	B0100	) as 	B0100	,
max(	B0102	) as 	B0102	,
max(	B0103	) as 	B0103	,
max(	B0104	) as 	B0104	,
max(	B0105	) as 	B0105	,
max(	B0108	) as 	B0108	,
max(	B0111	) as 	B0111	,
max(	B0113	) as 	B0113	,
max(	B0114	) as 	B0114	,
max(	B0116	) as 	B0116	,
max(	B0117	) as 	B0117	,
max(	B0119	) as 	B0119	,
max(	B0121	) as 	B0121	,
max(	B0122	) as 	B0122	,
max(	B0123	) as 	B0123	,
max(	B0124	) as 	B0124	,
max(	B0125	) as 	B0125	,
max(	B0126	) as 	B0126	,
max(	B0127	) as 	B0127	,
max(	B0128	) as 	B0128	,
max(	B0129	) as 	B0129	,
max(	B0130	) as 	B0130	,
max(	B0131	) as 	B0131	,
max(	B0132	) as 	B0132	,
max(	B0133	) as 	B0133	,
max(	B0134	) as 	B0134	,
max(	B0136	) as 	B0136	,
max(	B0137	) as 	B0137	,
max(	B0138	) as 	B0138	,
max(	B0140	) as 	B0140	,
max(	B0378	) as 	B0378	,
max(	B0379	) as 	B0379	,
max(	B0380	) as 	B0380	,
max(	B0381	) as 	B0381	,
max(	B0382	) as 	B0382	,
max(	B0383	) as 	B0383	,
max(	B0384	) as 	B0384	,
max(	B0385	) as 	B0385	,
max(	B0386	) as 	B0386	,
max(	B0387	) as 	B0387	,
max(	B0388	) as 	B0388	,
max(	B0389	) as 	B0389	,
max(	B0390	) as 	B0390	,
max(	B0391	) as 	B0391	,
max(	B0392	) as 	B0392	,
max(	B0393	) as 	B0393	,
max(	B0394	) as 	B0394	,
max(	B0395	) as 	B0395	,
max(	B0396	) as 	B0396	,
max(	B0397	) as 	B0397	,
max(	B0398	) as 	B0398	,
max(	B0422	) as 	B0422	,
max(	B0423	) as 	B0423	,
max(	B0424	) as 	B0424	,
max(	B0425	) as 	B0425	,
max(	B0426	) as 	B0426	,
max(	B0427	) as 	B0427	,
max(	B0428	) as 	B0428	,
max(	B0429	) as 	B0429	,
max(	B0430	) as 	B0430	,
max(	B0431	) as 	B0431	,
max(	B0432	) as 	B0432	,
max(	B0433	) as 	B0433	,
max(	B0434	) as 	B0434	,
max(	B0435	) as 	B0435	,
max(	B0436	) as 	B0436	,
max(	B0437	) as 	B0437	,
max(	B0438	) as 	B0438	,
max(	B0439	) as 	B0439	,
max(	B0440	) as 	B0440	,
max(	B0441	) as 	B0441	,
max(	B0442	) as 	B0442	,
max(	B0443	) as 	B0443	,
max(	B0444	) as 	B0444	,
max(	B0445	) as 	B0445	,
max(	B0446	) as 	B0446	,
max(	B0447	) as 	B0447	,
max(	B0448	) as 	B0448	,
max(	B0449	) as 	B0449	,
max(	B0450	) as 	B0450	,
max(	B0451	) as 	B0451	,
max(	B0452	) as 	B0452	,
max(	B0453	) as 	B0453	,
max(	B0454	) as 	B0454	,
max(	B0455	) as 	B0455	,
max(	B0456	) as 	B0456	,
max(	B0461	) as 	B0461	,
max(	B0462	) as 	B0462	,
max(	B0463	) as 	B0463	,
max(	B0464	) as 	B0464	,
max(	B0465	) as 	B0465	,
max(	B0466	) as 	B0466	,
max(	B0467	) as 	B0467	,
max(	B0469	) as 	B0469	,
max(	B0470	) as 	B0470	,
max(	B0473	) as 	B0473	,
max(	B0479	) as 	B0479	,
max(	B0493	) as 	B0493   ,
---
max ( B0552 ) as  B0552,
max ( B0553 ) as  B0553,
max ( B0554 ) as  B0554,
max ( B0555 ) as  B0555,
max ( B0556 ) as  B0556,
max ( B0557 ) as  B0557,
max ( B0558 ) as  B0558,
max ( B0559 ) as  B0559,
max ( B0560 ) as  B0560,
max ( B0561 ) as  B0561,
max ( B0562 ) as  B0562,
max ( B0563 ) as  B0563,
max ( B0564 ) as  B0564,
max ( B0565 ) as  B0565,
max ( B0566 ) as  B0566,
max ( B0567 ) as  B0567,
max ( B0568 ) as  B0568,
max ( B0569 ) as  B0569,
max ( B0570 ) as  B0570,
max ( B0571 ) as  B0571,
max ( B0572 ) as  B0572,
max ( B0573 ) as  B0573,
max ( B0574 ) as  B0574,
max ( B0575 ) as  B0575,
max ( B0579 ) as  B0579
   from digital.business_sic_segments_full_aws
     group by abinumber;
---(64890024 rows affected)    (181519 rows affected)


delete from digital.business_sic_segments_full_nodup_aws where
B0001	is  	NULL	and
B0007	is  	NULL	and
B0009	is  	NULL	and
B0010	is  	NULL	and
B0013	is  	NULL	and
B0014	is  	NULL	and
B0017	is  	NULL	and
B0019	is  	NULL	and
B0020	is  	NULL	and
B0022	is  	NULL	and
B0023	is  	NULL	and
B0024	is  	NULL	and
B0027	is  	NULL	and
B0030	is  	NULL	and
B0031	is  	NULL	and
B0033	is  	NULL	and
B0035	is  	NULL	and
B0036	is  	NULL	and
B0037	is  	NULL	and
B0039	is  	NULL	and
B0040	is  	NULL	and
B0041	is  	NULL	and
B0042	is  	NULL	and
B0043	is  	NULL	and
B0044	is  	NULL	and
B0046	is  	NULL	and
B0047	is  	NULL	and
B0048	is  	NULL	and
B0051	is  	NULL	and
B0052	is  	NULL	and
B0053	is  	NULL	and
B0054	is  	NULL	and
B0055	is  	NULL	and
B0056	is  	NULL	and
B0057	is  	NULL	and
B0058	is  	NULL	and
B0059	is  	NULL	and
B0060	is  	NULL	and
B0061	is  	NULL	and
B0062	is  	NULL	and
B0063	is  	NULL	and
B0065	is  	NULL	and
B0065b	is  	NULL	and
B0066	is  	NULL	and
B0067	is  	NULL	and
B0070	is  	NULL	and
B0071	is  	NULL	and
B0072	is  	NULL	and
B0073	is  	NULL	and
B0074	is  	NULL	and
B0075	is  	NULL	and
B0076	is  	NULL	and
B0077	is  	NULL	and
B0078	is  	NULL	and
B0080	is  	NULL	and
B0081	is  	NULL	and
B0082	is  	NULL	and
B0084	is  	NULL	and
B0086	is  	NULL	and
B0087	is  	NULL	and
B0088	is  	NULL	and
B0089	is  	NULL	and
B0090	is  	NULL	and
B0091	is  	NULL	and
B0092	is  	NULL	and
B0094	is  	NULL	and
B0095	is  	NULL	and
B0096	is  	NULL	and
B0097	is  	NULL	and
B0098	is  	NULL	and
B0099	is  	NULL	and
B0100	is  	NULL	and
B0102	is  	NULL	and
B0103	is  	NULL	and
B0104	is  	NULL	and
B0105	is  	NULL	and
B0108	is  	NULL	and
B0111	is  	NULL	and
B0113	is  	NULL	and
B0114	is  	NULL	and
B0116	is  	NULL	and
B0117	is  	NULL	and
B0119	is  	NULL	and
B0121	is  	NULL	and
B0122	is  	NULL	and
B0123	is  	NULL	and
B0124	is  	NULL	and
B0125	is  	NULL	and
B0126	is  	NULL	and
B0127	is  	NULL	and
B0128	is  	NULL	and
B0129	is  	NULL	and
B0130	is  	NULL	and
B0131	is  	NULL	and
B0132	is  	NULL	and
B0133	is  	NULL	and
B0134	is  	NULL	and
B0136	is  	NULL	and
B0137	is  	NULL	and
B0138	is  	NULL	and
B0140	is  	NULL	and
B0378	is  	NULL	and
B0379	is  	NULL	and
B0380	is  	NULL	and
B0381	is  	NULL	and
B0382	is  	NULL	and
B0383	is  	NULL	and
B0384	is  	NULL	and
B0385	is  	NULL	and
B0386	is  	NULL	and
B0387	is  	NULL	and
B0388	is  	NULL	and
B0389	is  	NULL	and
B0390	is  	NULL	and
B0391	is  	NULL	and
B0392	is  	NULL	and
B0393	is  	NULL	and
B0394	is  	NULL	and
B0395	is  	NULL	and
B0396	is  	NULL	and
B0397	is  	NULL	and
B0398	is  	NULL	and
B0422	is  	NULL	and
B0423	is  	NULL	and
B0424	is  	NULL	and
B0425	is  	NULL	and
B0426	is  	NULL	and
B0427	is  	NULL	and
B0428	is  	NULL	and
B0429	is  	NULL	and
B0430	is  	NULL	and
B0431	is  	NULL	and
B0432	is  	NULL	and
B0433	is  	NULL	and
B0434	is  	NULL	and
B0435	is  	NULL	and
B0436	is  	NULL	and
B0437	is  	NULL	and
B0438	is  	NULL	and
B0439	is  	NULL	and
B0440	is  	NULL	and
B0441	is  	NULL	and
B0442	is  	NULL	and
B0443	is  	NULL	and
B0444	is  	NULL	and
B0445	is  	NULL	and
B0446	is  	NULL	and
B0447	is  	NULL	and
B0448	is  	NULL	and
B0449	is  	NULL	and
B0450	is  	NULL	and
B0451	is  	NULL	and
B0452	is  	NULL	and
B0453	is  	NULL	and
B0454	is  	NULL	and
B0455	is  	NULL	and
B0456	is  	NULL	and
B0461	is  	NULL	and
B0462	is  	NULL	and
B0463	is  	NULL	and
B0464	is  	NULL	and
B0465	is  	NULL	and
B0466	is  	NULL	and
B0467	is  	NULL	and
B0469	is  	NULL	and
B0470	is  	NULL	and
B0473	is  	NULL	and
B0479	is  	NULL	and
B0493	is  	NULL    and
---
B0552	is null and
B0553	is null and
B0554	is null and
B0555	is null and
B0556	is null and
B0557	is null and
B0558	is null and
B0559	is null and
B0560	is null and
B0561	is null and
B0562	is null and
B0563	is null and
B0564	is null and
B0565	is null and
B0566	is null and
B0567	is null and
B0568	is null and
B0569	is null and
B0570	is null and
B0571	is null and
B0572	is null and
B0573	is null and
B0574	is null and
B0575	is null and
B0579	is null;
---  (17066278 rows affected)   (44022 rows affected)

select count(*) from digital.business_sic_segments_full_nodup_aws;
---137497

drop table if exists digital.business_segments_aws;

create table digital.business_segments_aws as
select
  right('000000000000000000'+e.id,18) id,
 id orig_id,
 e_executivesourcecode,
 e_contactid,
  right('00'+e_vendorid2,2) e_vendorid2,
 e.abinumber,
 e_individualid,
 e_familyid,
cast(e.e_firstname as varchar(20)) as e_firstname   , cast(e.e_lastname as varchar(20)) as e_lastname , areacode+phonenumber phonenumber,
---case when ltrim(rtrim(e_emailaddress)) = '' then cast(e_emailaddress as varchar(80)) else cast( lower(substring(convert(varchar(max),HashBytes('MD5',lower(LTRIM(RTRIM(e_emailaddress)))),1),3,32)) as varchar(80) ) end email,
case when trim(e_emailaddress) = '' then cast(e_emailaddress as varchar(80)) else md5(lower(trim(e_emailaddress))) end email,
cast(e_emailaddress as varchar(80)) orig_email,
m_address_mailing, m_city_mailing,
m_state_mailing, m_zipcode_mailing, m_zipfour_mailing, address,city,state,zipcode,zipfour,
m_address_landmark,
m_city_landmark,
m_state_landmark,
m_zipcode_landmark,
m_zipfour_landmark,
e_homeaddress,
e_homecity,
e_homestate,
e_homezipcode,
e_homezip4,
fulfillmentflag,
cast('EXEC' as varchar(30)) dataset,
CASE WHEN ( e.e_titlecode IN ('1','5','9','!','@','C','E','F','I','N','Q','W','Y')    OR ( B0001 = 1 AND  e.e_titlecode NOT IN ('8','V','+',']',':','')  ) ) then 1 end B0001,
CASE WHEN (  ( numberemployees >=   1  AND numberemployees <=  500    ) AND e.e_titlecode NOT IN (']'  ,'') ) then 1 end B0002,
CASE WHEN ( e.e_titlecode NOT IN (']'  ,'') ) then 1 end B0003,
CASE WHEN (  ( numberemployees >=   1  AND numberemployees <=  500    )  ) then 1 end B0004,
CASE WHEN (  ( numberemployees >=   21  AND numberemployees <=  50    )  ) then 1 end B0005,
CASE WHEN ( e.e_titlecode IN ('$','@','%','1','2','4','9','A','C','D','E','F')  ) then 1 end B0006,
CASE WHEN ( e.e_titlecode IN ('!','@','=','N','Q')  OR  B0007 = 1 OR ( ( numberemployees >=1 AND numberemployees <= 10) AND e.e_titlecode IN ('1','2','3','4','5','9','(',')','[','_','=','>','C','E','F','I','J','K','Q','S','W') ) ) then 1 end B0007,
CASE WHEN ( e.e_titlecode IN ('1','2','C') ) then 1 end B0008,
CASE WHEN ( e.e_titlecode IN ('#','F','G','H','O')  OR  B0009 = 1  ) then 1 end B0009,
CASE WHEN ( e.e_titlecode IN ( '1','5','9','C','E','F','I','W','%','M','Q','R','T' )  OR ( B0010 = 1 AND e.e_titlecode NOT IN ('8','V','+',']',':','')  ) ) then 1 end B0010,
CASE WHEN ( e.e_titlecode IN ('1','9') ) then 1 end B0011,
CASE WHEN ( e.e_titlecode IN ('1','5','9') ) then 1 end B0012,
CASE WHEN (  B0013 = 1 OR amiflag=1 OR e.e_proftitle IN ( 'AAEM','AAPA','AAPS','ABQAURP','ASOPA','CUPA','EDF','FACCP','NAEMSP','NBCOPA','OPA-C','PA-C','PA','DO','MD','RFDS','FS','ME','OB','DC','DDS','DMD','DPM','DPT','DVM' ) OR  e.e_proftitle IN ('AIN','ANM','ANNA','ANP','AOCN','AORN','APN','APRN','ARN','ARNP','ASN','ASORN','BAA (N)','BAN','BIG','Bsc.N','BSN','CAPA','CARN','CCC','CCRN','CDDN','CDONA/LTC','CEN','CENAs','CETN','CGFNS','CGRN','CHN','CHT RN','CLNC','CN','CNA','CNAA','CNC','CNM','CNN','CNO','CNOR','CNRN','CNS','COHN','COHN-S','CPAN','CPN (C)','CPNP','CPON','CPP','CRANA','CRNA','CRNFA','CRNH','CRNI','CRNO','CRNP','CRRN','CSN','CTN','CUNP','CURN','CWCN','DNSc','DON','DSN','EN','ENA','ENPC','FAAN','FNP','GN','GNP','HNC','IAFN','ICN','INCC','INS','ITNS','LNC','LPN ','LVN','MICN','MN','MNEd','MSN','NA','ND','NENA','NH','NICs','NNNHP','NNP','NOC','NP','NPP','NSYICU','NVSPV','NZNO','OCN','OGP','ONC','PHN','PMH-NP','PN','PNP','RCNA','RGN','RMG','RMN','RN','RNAC','RNC','RNFA','RNMH','RNR','RPN','SN','SRN','TNCC','WHCNP','WHNP','WOCN') OR  B0023 = 1 OR B0033 = 1  OR  B0042 = 1  OR B0114 = 1 ) then 1 end B0013,
B0014,
CASE WHEN (  ( numberemployees >=   1  AND numberemployees <=  500    ) AND e.e_titlecode in ('1','9') ) then 1 end  B0015,
CASE WHEN (  ( numberemployees >=   1  AND numberemployees <=  20    )  ) then 1 end B0016,
CASE WHEN ( e.e_titlecode IN ('1','2','5','9','#','C','E','I','W','F','G','H','O')   OR ( B0017 = 1 AND e.e_titlecode NOT IN ('8','V','+',']',':','')  ) ) then 1 end B0017,
CASE WHEN ( e.e_titlecode IN ('$','@','%','1','2','4','9','A','C','D','E','F')  ) then 1 end B0018,
CASE WHEN ( e.e_titlecode IN ('!','@','=','N')  OR  B0019 = 1 OR ( ( numberemployees>=1 AND numberemployees <= 10) AND e.e_titlecode IN ('1','2','3','4','5','9','(',')','[','_','=','>','C','E','F','I','J','K','Q','S','W') ) ) then 1 end B0019,
CASE WHEN ( e.e_titlecode IN ('!','@','=','N')  OR  B0020 = 1 OR ( ( numberemployees >=1 AND numberemployees <= 10) AND e.e_titlecode IN ('1','2','3','4','5','9','(',')','[','_','=','>','C','E','F','I','J','K','Q','S','W') ) ) then 1 end B0020,
CASE WHEN (  ( numberemployees >=   101  AND numberemployees <=  500    )  ) then 1 end B0021,
CASE WHEN ( databasesegmentationcode IN (5,6,7,8)   AND  B0022 = 1  ) then 1 end B0022,
CASE WHEN ( e.e_proftitle IN ('AIN','ANM','ANNA','ANP','AOCN','AORN','APN','APRN','ARN','ARNP','ASN','ASORN','BAA (N)','BAN','BIG','Bsc.N','BSN','CAPA','CARN','CCC','CCRN','CDDN','CDONA/LTC','CEN','CENAs','CETN','CGFNS','CGRN','CHN','CHT RN','CLNC','CN','CNA','CNAA','CNC','CNM','CNN','CNO','CNOR','CNRN','CNS','COHN','COHN-S','CPAN','CPN (C)','CPNP','CPON','CPP','CRANA','CRNA','CRNFA','CRNH','CRNI','CRNO','CRNP','CRRN','CSN','CTN','CUNP','CURN','CWCN','DNSc','DON','DSN','EN','ENA','ENPC','FAAN','FNP','GN','GNP','HNC','IAFN','ICN','INCC','INS','ITNS','LNC','LPN ','LVN','MICN','MN','MNEd','MSN','NA','ND','NENA','NH','NICs','NNNHP','NNP','NOC','NP','NPP','NSYICU','NVSPV','NZNO','OCN','OGP','ONC','PHN','PMH-NP','PN','PNP','RCNA','RGN','RMG','RMN','RN','RNAC','RNC','RNFA','RNMH','RNR','RPN','SN','SRN','TNCC','WHCNP','WHNP','WOCN')
    OR  B0023 = 1  ) then 1 end B0023,
CASE WHEN ( e.e_titlecode IN ('!','@','=','N')  OR  B0024 = 1  ) then 1 end B0024,
CASE WHEN (  ( numberemployees >=   51  AND numberemployees <=  100    )  ) then 1 end B0025,
CASE WHEN (  ( numberemployees >=   2501  AND numberemployees <=  5000    )  ) then 1 end B0026,
CASE WHEN ( e.e_titlecode IN ('/','X')   OR  B0027 = 1  ) then 1 end B0027,
CASE WHEN ( e.e_titlecode IN ('1','2','4','5','9','A','C','D') ) then 1 end B0028,
CASE WHEN ( e.e_titlecode IN ('2','4','5','9','E','F','I','J','K','W','$','%','&',')','@') ) then 1 end B0029,
CASE WHEN ( e.e_titlecode IN (':')   OR  B0030 = 1  ) then 1 end B0030,
CASE WHEN ( e.e_titlecode IN ('1','2','5','9','#','C','F','G','H','I','O')   AND  B0031 = 1  ) then 1 end B0031,
CASE WHEN ( e.e_titlecode NOT IN ('8','V',   '+'   ,  ':') or e.e_titlecode is NULL  ) then 1 end B0032,
B0033,
CASE WHEN ( ( numberemployees > 50 AND e_titlecode  IN ('$','@','%','{','1','2','4','5','9','A','C','D','E','F','G','H','I','J','K','W') )  OR e.e_highincomeexecflag = 1 ) then 1 end B0034,
CASE WHEN ( e.e_proftitle IN ( 'AAEM','AAPA','AAPS','ABQAURP','ASOPA','CUPA','EDF','FACCP','NAEMSP','NBCOPA','OPA-C','PA-C','PA','DO','MD','RFDS','FS','ME','OB','DC','DDS','DMD','DPM','DPT','DVM' )   OR amiflag=1   OR  B0035 = 1  ) then 1 end B0035,
CASE WHEN ( e.e_titlecode IN ('!','@','=','N','Q')   OR ( B0036 = 1 AND e.e_titlecode NOT IN ('8','V','+',':')  )  OR ( ( numberemployees >=1 AND numberemployees <= 10)  AND e.e_titlecode IN ('1','2','3','4','5','9','(',')','[','_','=','>','C','E','F','I','J','K','Q','S','W') ) ) then 1 end B0036,
CASE WHEN ( governmentflag = 'Y'  OR
databasesegmentationcode IN (5,6,7,8)   OR  B0037 = 1  ) then 1 end B0037,
CASE WHEN ( fortuneranking >= 1 AND fortuneranking <= 500 ) then 1 end B0038,
CASE WHEN ( e.e_titlecode IN ('1','5','9','C','E','F','I','W','%','\\','M','R')  OR  B0039 = 1 OR ( ( numberemployees >=1 AND numberemployees <= 10) AND e.e_titlecode IN ('1','2','3','4','5','9','(',')','[','_','=','>','C','E','F','I','J','K','Q','S','W') ) ) then 1 end B0039,
CASE WHEN ( B0040 = 1 OR amiflag = 1 OR e.e_proftitle IN ( 'AAEM','AAPA','AAPS','ABQAURP','ASOPA','CUPA','EDF','FACCP','NAEMSP','NBCOPA','OPA-C','PA-C','PA','DO','MD','RFDS','FS','ME','OB','DC','DDS','DMD','DPM','DPT','DVM' ) OR B0035 = 1 OR e.e_proftitle IN ('AIN','ANM','ANNA','ANP','AOCN','AORN','APN','APRN','ARN','ARNP','ASN','ASORN','BAA (N)','BAN','BIG','Bsc.N','BSN','CAPA','CARN','CCC','CCRN','CDDN','CDONA/LTC','CEN','CENAs','CETN','CGFNS','CGRN','CHN','CHT RN','CLNC','CN','CNA','CNAA','CNC','CNM','CNN','CNO','CNOR','CNRN','CNS','COHN','COHN-S','CPAN','CPN (C)','CPNP','CPON','CPP','CRANA','CRNA','CRNFA','CRNH','CRNI','CRNO','CRNP','CRRN','CSN','CTN','CUNP','CURN','CWCN','DNSc','DON','DSN','EN','ENA','ENPC','FAAN','FNP','GN','GNP','HNC','IAFN','ICN','INCC','INS','ITNS','LNC','LPN ','LVN','MICN','MN','MNEd','MSN','NA','ND','NENA','NH','NICs','NNNHP','NNP','NOC','NP','NPP','NSYICU','NVSPV','NZNO','OCN','OGP','ONC','PHN','PMH-NP','PN','PNP','RCNA','RGN','RMG','RMN','RN','RNAC','RNC','RNFA','RNMH','RNR','RPN','SN','SRN','TNCC','WHCNP','WHNP','WOCN') OR  B0023 = 1  OR B0033 = 1 OR  B0042 = 1  OR  B0114 = 1 ) then 1 end B0040,
B0041,
B0042,
B0043,
CASE WHEN ( e.e_titlecode IN ('1','5','9','?','_','$','^','P')   OR  B0044 = 1  ) then 1 end B0044,
CASE WHEN ( (numberemployees > 50 AND e_titlecode  IN ('$','@','%','{','1','2','4','5','9','A','C','D','E','F','G','H','I','J','K','W'))  OR e.e_highincomeexecflag = 1 ) then 1 end B0045,
CASE WHEN (   B0046 = 1  ) then 1 end B0046,
CASE WHEN ( e.e_titlecode IN ('!','@','=','N')  OR  B0047 = 1  ) then 1 end B0047,
CASE WHEN ( e.e_titlecode IN ('-','\\','%','M','Q','R','T')   OR ( B0048 = 1 AND e.e_titlecode NOT IN ('8','V','+',']',':','')  ) ) then 1 end B0048,
CASE WHEN (  ( numberemployees >=   501  AND numberemployees <=  1000    )  ) then 1 end B0049,
CASE WHEN ( numberemployees  >= 5001  ) then 1 end B0050,
B0051,
CASE WHEN ( governmentflag = 'Y'  OR databasesegmentationcode IN (5,6,7,8)   OR  B0052 = 1  ) then 1 end B0052,
B0053,
CASE WHEN ( e.e_titlecode IN ('1','2','5','9','#','C','F','G','H','I','O')   OR ( B0054 = 1  )) then 1 end B0054,
CASE WHEN ( e.e_titlecode IN ('!','@','=','N')  OR  B0055 = 1  ) then 1 end B0055,
CASE WHEN ( e.e_titlecode IN ('$','^','P')   OR  B0056 = 1  ) then 1 end B0056,
CASE WHEN ( e.e_titlecode IN ('=')   OR  B0057 = 1  ) then 1 end B0057,
CASE WHEN ( e.e_titlecode IN ('!','@','=','N')  OR  B0058 = 1  ) then 1 end B0058,
CASE WHEN ( e.e_titlecode IN ('!','@','=','N')  OR  B0059 = 1  ) then 1 end B0059,
B0060,
B0061,
CASE WHEN ( e.e_titlecode IN ('/','X')   OR  B0062 = 1  ) then 1 end B0062,
CASE WHEN ( e.e_titlecode IN ('#','F','G','H','O')   OR ( B0063 = 1 AND e.e_titlecode NOT IN ('8','V','+',']',':','')  ) ) then 1 end B0063,
CASE WHEN ( numberemployees >=   1001  AND numberemployees <=  2500    )   then 1 end B0064,
CASE WHEN (  (e.e_titlecode IN ('!','@','=','N') AND  B0065 = 1  ) OR B0065b = 1 ) then 1 end B0065,
B0066,
B0067,
CASE WHEN (  ( numberemployees >=   1  AND numberemployees <=  500    )  ) then 1 end B0068,
CASE WHEN ( e.e_titlecode IN ('$','@','%','1','2','4','9','A','C','D','E','F')  ) then 1 end B0069,
CASE WHEN ( e.e_titlecode IN ('=')   OR  B0070 = 1  ) then 1 end B0070,
CASE WHEN ( e.e_titlecode IN ('1','2','5','9','#','C','F','G','H','I','O')   OR ( B0071 = 1  ) ) then 1 end B0071,
B0072,
B0073,
B0074,
B0075,
B0076,
B0077,
CASE WHEN ( e.e_titlecode IN ('&','T','-')   OR ( B0078 = 1 AND e.e_titlecode NOT IN ('8','V','+',']',':','')  ) ) then 1 end B0078,
CASE WHEN ( e.e_titlecode IN ('(') ) then 1 end B0079,
CASE WHEN ( e.e_titlecode IN ('=')   OR  B0080 = 1  ) then 1 end B0080,
CASE WHEN ( e.e_titlecode IN ('^','P')   OR  B0081 = 1  ) then 1 end B0081,
B0082,
CASE WHEN ( e.e_titlecode IN ('A','C','D') ) then 1 end B0083,
CASE WHEN ( e.e_titlecode IN ('#','F','G','H','O')  OR  B0084 = 1  ) then 1 end B0084,
CASE WHEN ( companyholdingstatus= 1 ) then 1 end B0085,
CASE WHEN ( e.e_titlecode IN ('=')   OR  B0086 = 1  ) then 1 end B0086,
CASE WHEN ( governmentflag = 'Y'  OR
databasesegmentationcode IN (5,6,7,8)   OR  B0087 = 1  ) then 1 end B0087,
CASE WHEN ( e.e_titlecode IN ('#','F','G','H','O')   OR  B0088 = 1  ) then 1 end B0088,
B0089,
CASE WHEN ( e.e_titlecode IN ('!','@','=','N')  OR  B0090 = 1  ) then 1 end B0090,
B0091,
B0092,
CASE WHEN ( e.e_titlecode IN      ('1','2','4','5','6','9','$','%' ,  ')'   ,   ','   , '@', 'C','E', 'F','G','H','I','J','K','L','M','N','O','P','Q',
'R', 'S','T','V','W','X','Y' ) ) then 1 end B0093,
CASE WHEN ( e.e_titlecode IN ('!','@','=','N')  OR  B0094 = 1  ) then 1 end B0094,
CASE WHEN ( e.e_titlecode IN ('^','P')   OR  B0095 = 1  ) then 1 end B0095,
CASE WHEN ( e.e_titlecode IN ('X','S')   OR ( B0096 = 1 AND e.e_titlecode IN ('1','5','9','^','_','C','I','M','P','W') ) ) then 1 end B0096,
CASE WHEN ( e.e_titlecode IN ('&','T','-')   OR ( B0097 = 1 AND e.e_titlecode NOT IN ('8','V','+',']',':','')  ) ) then 1 end B0097,
B0098,
B0099,
B0100,
CASE WHEN (  ( numberemployees >=   1  AND numberemployees <=  49    )  ) then 1 end B0101,
B0102,
CASE WHEN ( e.e_titlecode IN ('/','X','S')   OR  B0103 = 1  ) then 1 end B0103,
B0104,
B0105,
CASE WHEN ( outputvolume>= 1000000   OR corporateoutputvolume>=  1000000  ) then 1 end B0106,
CASE WHEN (  ( numberemployees >=   5  AND numberemployees <=  49    )  ) then 1 end B0107,
B0108,
---CASE WHEN ( e.e_titlecode IN (':')   AND  B0109 = 1  ) then 1 end B0109,
CASE WHEN ( e.e_titlecode IN ('3','?','_','{','>') ) then 1 end B0110,
B0111,
CASE WHEN ( e.e_titlecode IN ('@','=','N') ) then 1 end B0112,
CASE WHEN ( e.e_titlecode IN ('&','T','-')   OR ( B0113 = 1 AND e.e_titlecode NOT IN ('8','V','+',']',':','')  ) ) then 1 end B0113,
B0114,
CASE WHEN (  ( numberemployees >=   1  AND numberemployees <=  4    )  ) then 1 end B0115,
B0116,
CASE WHEN ( e.e_titlecode IN ('!','@','=','N')   AND  B0117 = 1  ) then 1 end B0117,
CASE WHEN ( e.e_titlecode IN ('A','C','D') ) then 1 end B0118,
B0119,
CASE WHEN ( growingbusinessflag = '+' ) then 1 end B0120,
B0121,
CASE WHEN ( e.e_titlecode IN ('V') OR  B0122 = 1  ) then 1 end B0122,
CASE WHEN ( e.e_titlecode IN ('!','@','=','N')  OR  B0123 = 1  ) then 1 end B0123,
B0124,
B0125,
B0126,
CASE WHEN ( e.e_titlecode IN ('V') OR  B0127 = 1  ) then 1 end B0127,
CASE WHEN ( e.e_titlecode IN (':')   OR  B0128 = 1  ) then 1 end B0128,
CASE WHEN ( e.e_titlecode IN ('%','\\','M')  OR ( B0129 = 1  ) ) then 1 end B0129,
CASE WHEN ( e.e_titlecode IN ('1','2','5','9','#','C','F','G','H','I','O')   AND  B0130 = 1  ) then 1 end B0130,
CASE WHEN ( e.e_titlecode IN ('Y')   OR B0131=1 ) then 1 end B0131,
CASE WHEN ( e.e_titlecode IN ('#','F','G','H','O')   OR  B0132 = 1  ) then 1 end B0132,
CASE WHEN ( e.e_titlecode IN ('-','%','\\','R','T')   OR  B0133 = 1  ) then 1 end B0133,
B0134,
CASE WHEN ( ltrim(rtrim(companyholdingstatus)) IN ('','0') ) then 1 end B0135,
B0136,
CASE WHEN ( e.e_titlecode IN ('$','^','P')   OR  B0137 = 1  ) then 1 end B0137,
B0138,
CASE WHEN (  ( numberemployees >=   1  AND numberemployees <=  500    ) AND (e.e_titlecode NOT IN ('8','V','+',':') or e.e_titlecode is NULL)  ) then 1 end B0139,
CASE WHEN ( e.e_titlecode IN ('/','X')   OR  B0140 = 1  ) then 1 end B0140,
CASE WHEN (e.e_titlecode IN ('1','9','C') and s_truefranchiseflag='Y' ) then 1 end B0141,

CASE WHEN (fortuneranking >= 1 AND fortuneranking <= 1000 ) then 1 end B0142,

CASE WHEN ( (ltrim(rtrim(outputvolume)) != '' AND outputvolume > 0 AND outputvolume < 500)   OR (ltrim(rtrim(corporateoutputvolume)) != '' AND corporateoutputvolume > 0 AND corporateoutputvolume <  500  )) then 1 end B0143,

CASE WHEN ( (outputvolume >= 500 AND outputvolume < 1000)  OR (corporateoutputvolume >=500 AND  corporateoutputvolume < 1000  )) then 1 end B0144,

CASE WHEN ( (outputvolume >= 1000 AND outputvolume < 5000)  OR (corporateoutputvolume >=1000 AND  corporateoutputvolume < 5000  )) then 1 end B0145,

CASE WHEN ( (outputvolume >= 5000 AND outputvolume < 10000)  OR (corporateoutputvolume >=5000 AND  corporateoutputvolume < 10000  )) then 1 end B0146,

CASE WHEN ( (outputvolume >= 10000 AND outputvolume < 20000)  OR (corporateoutputvolume >=10000 AND  corporateoutputvolume < 20000  )) then 1 end B0147,

CASE WHEN ( (outputvolume >= 20000 AND outputvolume < 50000)  OR (corporateoutputvolume >=20000 AND  corporateoutputvolume < 50000  )) then 1 end B0148,

CASE WHEN ( (outputvolume >= 50000 AND outputvolume < 100000)  OR (corporateoutputvolume >=50000 AND  corporateoutputvolume < 100000  )) then 1 end B0149,

CASE WHEN ( (outputvolume >= 100000 AND outputvolume < 500000)  OR (corporateoutputvolume >=100000 AND  corporateoutputvolume < 500000  )) then 1 end B0150,

CASE WHEN ( (outputvolume >= 500000 AND outputvolume < 1000000)  OR (corporateoutputvolume >=500000 AND  corporateoutputvolume < 1000000  )) then 1 end B0151,

CASE WHEN(
			(ltrim(rtrim(yearestablished)) !='' AND ltrim(rtrim(yearestablished)) != '.' AND yearestablished !=0 AND ((cast(date_part(year,getdate()) as int) - yearestablished) <= 5 )
			)
			OR
			((ltrim(rtrim(yearestablished)) ='' OR ltrim(rtrim(yearestablished)) ='.' OR yearestablished=0)
			AND  ((cast(date_part(year,getdate()) as int) - yearfirstappeared) <= 5))
         ) then 1  END  B0152,

CASE WHEN(
			(ltrim(rtrim(yearestablished)) !='' AND ltrim(rtrim(yearestablished)) != '.' AND yearestablished !=0 AND ((cast(date_part(year,getdate()) as int) - yearestablished) >5)
			)
			OR
			((ltrim(rtrim(yearestablished)) ='' OR ltrim(rtrim(yearestablished)) ='.' OR yearestablished=0)
			AND  ((cast(date_part(year,getdate()) as int) - yearfirstappeared) > 5))
        ) then 1  END  B0153,


CASE WHEN ( e.e_titlecode IN ('3', '{', '>', '4', '(', '?', 'W', 'K') ) then 1 end B0299,
CASE WHEN ( e.e_titlecode IN ('&', '%', '\\', 'R', '-', 'T') ) then 1 end B0300,
CASE WHEN ( e.e_titlecode IN ('F', 'H', 'G', '#', 'O')  ) then 1 end B0301,
CASE WHEN ( e.e_titlecode IN ('^', 'P', 'L', '7')  ) then 1 end B0302,
CASE WHEN ( e.e_titlecode IN ('[', 'S', '/', 'X')  ) then 1 end B0303,

-- may segments updated processing
---CASE WHEN ( s_truefranchiseflag = 'Y' ) then 1 end B0304,
---CASE WHEN ( businessstatuscode = 1    ) then 1 end B0305,
CASE WHEN ( businessstatuscode = 3    ) then 1 end B0306,
CASE WHEN ( businessstatuscode = 2    ) then 1 end B0307,
/*
CASE WHEN ( businessstatuscode = 9 ) then 1 end B0308,
CASE WHEN ( e.e_vendorethnicity IN ('BS','ET','NG')) then 1 end B0309,
CASE WHEN ( e.e_vendorethnicgroup='B') then 1 end B0310,
CASE WHEN ( e.e_vendorethnicgroup='C') then 1 end B0311,
CASE WHEN ( e.e_vendorethnicgroup='E') then 1 end B0312,
CASE WHEN ( e.e_vendorethnicgroup='F') then 1 end B0313,
CASE WHEN ( e.e_vendorethnicgroup='H') then 1 end B0314,
CASE WHEN ( e.e_vendorethnicgroup='J') then 1 end B0315,
CASE WHEN ( e.e_vendorethnicgroup='M') then 1 end B0316,
CASE WHEN ( e.e_vendorethnicgroup='I') then 1 end B0317,
CASE WHEN ( e.e_vendorethnicgroup='N') then 1 end B0318,
CASE WHEN ( e.e_vendorethnicgroup='P') then 1 end B0319,
CASE WHEN ( e.e_vendorethnicgroup='S') then 1 end B0320,
CASE WHEN ( e.e_vendorethnicgroup='A') then 1 end B0321,
CASE WHEN ( e.e_vendorethnicgroup='W') then 1 end B0322,
  */
CASE WHEN ( squarefootage8 IN ('1','2')) then 1 end B0323,
CASE WHEN ( squarefootage8 IN ('3','4')) then 1 end B0324,
CASE WHEN ( squarefootage8 IN ('5','6')) then 1 end B0325,
CASE WHEN ( squarefootage8 IN ('7','8')) then 1 end B0326,
CASE WHEN ( substring(exp_acc,4,1) IN ('F','G') ) then 1 end B0327,
CASE WHEN ( substring(exp_adv,4,1) IN ('C','D','E','F','G') ) then 1 end B0328,
CASE WHEN ( substring(exp_ins,4,1) IN ('D','E','F','G') ) then 1 end B0329,
CASE WHEN ( substring(exp_leg,4,1) IN ('F','G') ) then 1 end B0330,
CASE WHEN ( substring(exp_ofc,4,1) IN ('C','D','E','F','G') ) then 1 end B0331,
CASE WHEN ( substring(exp_pac,4,1) IN ('E','F','G') ) then 1 end B0332,
CASE WHEN ( substring(exp_pay,4,1) IN ('B','C','D','E','F','G') ) then 1 end B0333,
CASE WHEN ( substring(exp_prn,4,1) IN ('F','G') ) then 1 end B0334,
CASE WHEN ( substring(exp_pro,4,1) IN ('D','E','F','G') ) then 1 end B0335,
CASE WHEN ( substring(exp_rnt,4,1) IN ('B','C','D','E','F','G') ) then 1 end B0336,
CASE WHEN ( substring(exp_cmp,4,1) IN ('F','G') ) then 1 end B0337,
CASE WHEN ( substring(exp_com,4,1) IN ('C','D','E','F','G') ) then 1 end B0338,
CASE WHEN ( substring(exp_clc,4,1) IN ('C','D','E','F','G') ) then 1 end B0339,
CASE WHEN ( substring(exp_utl,4,1) IN ('D','E','F','G') ) then 1 end B0340,
/*
CASE WHEN ( creditalphascore='A+') then 1 end B0341,
CASE WHEN ( creditalphascore='A') then 1 end B0342,
CASE WHEN ( creditalphascore='B+') then 1 end B0343,
CASE WHEN ( creditalphascore='B') then 1 end B0344,
CASE WHEN ( creditalphascore='C+') then 1 end B0345,
CASE WHEN ( creditalphascore='C') then 1 end B0346,
CASE WHEN ( creditalphascore='I') then 1 end B0347,
CASE WHEN ( creditalphascore='U') then 1 end B0348,
CASE WHEN ( e.e_proftitle IN ('AGT') ) then 1 end B0349,
  */
CASE WHEN ( e.e_proftitle IN ('CNM') ) then 1 end B0350,
CASE WHEN ( e.e_proftitle IN ('CNP') ) then 1 end B0351,
CASE WHEN ( e.e_proftitle IN ('CPA') ) then 1 end B0352,
CASE WHEN ( e.e_proftitle IN ('DC')  ) then 1 end B0353,
CASE WHEN ( e.e_proftitle IN ('DDS') ) then 1 end B0354,
CASE WHEN ( e.e_proftitle IN ('DO')  ) then 1 end B0355,
CASE WHEN ( e.e_proftitle IN ('DMD') ) then 1 end B0356,
CASE WHEN ( e.e_proftitle IN ('DPM') ) then 1 end B0357,
CASE WHEN ( e.e_proftitle IN ('DPT') ) then 1 end B0358,
CASE WHEN ( e.e_proftitle IN ('DVM') ) then 1 end B0359,
CASE WHEN ( e.e_proftitle IN ('LPN') ) then 1 end B0360,
CASE WHEN ( e.e_proftitle IN ('MD')  ) then 1 end B0361,
CASE WHEN ( e.e_proftitle IN ('NP')  ) then 1 end B0362,
CASE WHEN ( e.e_proftitle IN ('OD')  ) then 1 end B0363,
CASE WHEN ( e.e_proftitle IN ('OT')  ) then 1 end B0364,
CASE WHEN ( e.e_proftitle IN ('PA')  ) then 1 end B0365,
CASE WHEN ( e.e_proftitle IN ('PE')  ) then 1 end B0366,
CASE WHEN ( e.e_proftitle IN ('PHD') ) then 1 end B0367,
CASE WHEN ( e.e_proftitle IN ('PT')  ) then 1 end B0368,
CASE WHEN ( e.e_proftitle IN ('RN')  ) then 1 end B0369,
CASE WHEN ( e.e_proftitle IN ('ND')  ) then 1 end B0370,
/*
CASE WHEN ( websiteflag='1'  ) then 1 end B0371,
CASE WHEN (mailingdetailflag IN ('D','') or mailingdetailflag is NULL ) then 1 end B0372,
CASE WHEN ( e.e_emailflag IN ('1','2')  ) then 1 end B0373,
CASE WHEN ( phonenumber NOT IN ('0000000','') ) then 1 end B0374,
  */
  CASE
     WHEN nbrcnewadddate = '00000000'
	    then null
	  else
		case
		  when datediff(day, to_date(b.nbrcnewadddate,'YYYYMMDD'), getdate()) <= 365 then 1
		    end
		END as B0375,
---CASE WHEN ( aclflag='1'  ) then 1 end B0376,
---CASE WHEN ( amiflag='1' ) then 1 end B0377,
B0378,
B0379,
B0380,
B0381,
B0382,
B0383,
B0384,
B0385,
B0386,
B0387,
B0388,
B0389,
B0390,
B0391,
B0392,
B0393,
B0394,
B0395,
B0396,
B0397,
B0398,
---
CASE WHEN	e_levelcode in ('1','2') and (e_departmentcode in ('47') or B0387=1) then 1 end	B0399,
CASE WHEN	e_levelcode in ('1','2') and (e_departmentcode in ('51') or B0398=1) then 1 end	B0400,
CASE WHEN	e_levelcode in ('1','2') and (e_departmentcode in ('55') or B0395=1) then 1 end	B0401,
CASE WHEN	e_levelcode in ('1','2') and (e_departmentcode in ('55') or B0396=1) then 1 end	B0402,
CASE WHEN	e_levelcode in ('1','2') and (e_departmentcode in ('56') or B0391=1) then 1 end	B0403,
CASE WHEN	e_levelcode in ('1','2') and (e_departmentcode in ('58') or B0393=1) then 1 end	B0404,
CASE WHEN	e_levelcode in ('1','2') and (e_departmentcode in ('59') or B0392=1) then 1 end	B0405,
CASE WHEN	e_levelcode in ('1','2') and (e_departmentcode in ('60') or B0385=1) then 1 end	B0406,
CASE WHEN	e_levelcode in ('1','2') and (e_departmentcode in ('61') or B0380=1) then 1 end	B0407,
CASE WHEN	e_levelcode in ('1','2') and (e_departmentcode in ('62') or B0397=1) then 1 end	B0408,
CASE WHEN	e_levelcode in ('1','2') and (e_departmentcode in ('66') or B0383=1) then 1 end	B0409,
CASE WHEN	e_levelcode in ('1','2') and (e_departmentcode in ('68') or B0384=1) then 1 end	B0410,
CASE WHEN	e_levelcode in ('1','2') and (e_departmentcode in ('73') or B0389=1) then 1 end	B0411,
CASE WHEN	e_levelcode in ('1','2') and (e_departmentcode in ('78') or B0394=1) then 1 end	B0412,
CASE WHEN	e_levelcode in ('1','2') and (e_departmentcode in ('83') or B0390=1) then 1 end	B0413,
CASE WHEN	e_levelcode in ('1','2') and (e_departmentcode in ('88') or B0388=1) then 1 end	B0414,
CASE WHEN	e_levelcode in ('1','2') and e_departmentcode in ('48')	then 1 end	B0415,
CASE WHEN	e_levelcode in ('1','2') and e_departmentcode in ('81')	then 1 end	B0416,
CASE WHEN	e_levelcode in ('1','2') and e_departmentcode in ('86')	then 1 end	B0417,
CASE WHEN	e_levelcode in ('1','2') and e_departmentcode in ('87')	then 1 end	B0418,
CASE WHEN	e_levelcode in ('1','2') and (e_functionalareacode in ('4412','4427') or B0382=1)	then 1 end B0419,
CASE WHEN	e_levelcode in ('1','2') and e_functionalareacode in ('4422') then 1 end B0420,
CASE WHEN	e_levelcode in ('1','2') and (e_functionalareacode in ('6615','7706','7709','7710','8115') or B0386=1)	then 1 end	B0421,
---
B0422,
B0423,
B0424,
B0425,
B0426,
B0427,
B0428,
B0429,
B0430,
B0431,
B0432,
B0433,
B0434,
B0435,
B0436,
B0437,
B0438,
B0439,
B0440,
B0441,
B0442,
B0443,
B0444,
B0445,
B0446,
B0447,
B0448,
B0449,
B0450,
B0451,
B0452,
B0453,
B0454,
B0455,
B0456,
---
CASE WHEN numberemployees >= 1000 then 1 end B0457,
CASE WHEN numberemployees between 100 and 499 then 1 end B0458,
CASE WHEN numberemployees between 1 and 9 then 1 end B0459,
CASE WHEN numberemployees between 10 and 49 then 1 end B0460,
CASE WHEN (e.e_proftitle IN('AAEM','AAPA','AAPS','ABQAURP','ASOPA','CUPA','EDF','FACCP','NAEMSP','NBCOPA','OPA-C','PA-C','PA','DO','MD','RFDS','FS','ME','OB','DC','DMD','DPM','DPT')  OR
                  amiflag=1 OR B0461 = 1) then 1 end B0461,
B0462,
B0463,
B0464,
CASE WHEN e.e_titlecode IN('1','2','5','9','#','C','F','G','H','I','O')  OR B0465 = 1 then 1 end B0465,
B0466,
B0467,
CASE WHEN e_functionalareacode in('4407','4423','4426','5620','5918','6620','7702','7703','7706','7708','7709','7711','8119') then 1 end B0468,
B0469,
B0470,
CASE WHEN e_rolecode in('2000','3000','4000','5000','6000','') and e_functionalareacode in('6502','6504','6505','6508','6509','6512') then 1 end B0471,
CASE WHEN e_rolecode in('2000','3000','4000') and e_functionalareacode in('4703','4705','4706','4708','4713','4720') then 1 end B0472,
CASE WHEN e_rolecode in('4000','5000','6000','') and ( e_functionalareacode in ('8119') or B0473 = 1 ) then 1 end B0473,
CASE WHEN e.e_titlecode='C' or e_rolecode='1005' then 1 end B0474,
CASE WHEN e.e_titlecode='F' or (e_rolecode='1007' and e_departmentcode='44') then 1 end B0475,
CASE WHEN e.e_titlecode='%' or (e_rolecode='1007' and e_departmentcode='68') then 1 end B0476,
CASE WHEN e.e_titlecode='E' or e_rolecode='1006' then 1 end B0477,
CASE WHEN e.e_titlecode='@' or (e_rolecode='1007' and e_departmentcode='65') then 1 end B0478,
CASE WHEN e.e_titlecode='@' OR (e_rolecode='1007' and e_departmentcode='65') OR
                               (e_rolecode='1007' and e_departmentcode in('47','88') and B0479 = 1) then 1 end B0479,
CASE WHEN e_rolecode='1007' and e_functionalareacode in('4405','6001','6502','6506','6509','6818','8602') then 1 end B0480,
CASE WHEN e.e_titlecode='$' or (e_rolecode='1007' and e_departmentcode='87') then 1 end B0481,
CASE WHEN e_rolecode='1007' AND
          e_functionalareacode in ('4405','4410','4419','4427','4705','4706','4708','5101','5909','5915','5916','6106','6107','6508','6606','6613','7312','8208','8305','8610','8612','8613','8808','8809') then 1 end B0482,
CASE WHEN e_rolecode='1007' AND
          e_functionalareacode in ('4426','5610','5906','5908','5909','5911','5917','5918','6107','6108','6508','6509','6703','7212','8101','8121','8122','8301') then 1 end B0483,
CASE WHEN e_titlecode in('$','%','@','C','E','F') or e_rolecode in('1005','1006','1007') then 1 end B0484,
CASE WHEN e_titlecode='4' OR
         (e_rolecode='1005' and  e_functionalareacode in('4405','4417','4419','5101','5614','5916','6001','6106','6507','6509','6613','6812','6823','6826','6837','8101','8107','8203','8613','8803','8806')) then 1 end B0485,
CASE WHEN e_titlecode='I' or e_rolecode='1008' then 1 end B0486,
CASE WHEN e_titlecode='N' OR (e_rolecode in('1010','1011','1012','1099','2000') and e_departmentcode='65') then 1 end B0487,
CASE WHEN e_titlecode='?' Or (e_rolecode in('1010','1011','1012','1099','2000') and e_departmentcode in('62','87') ) then 1 end B0488,
CASE WHEN e_titlecode='1' or e_rolecode='1001' then 1 end B0489,
CASE WHEN e_titlecode='9' or e_rolecode='1001' then 1 end B0490,
CASE WHEN e_titlecode='A' or e_rolecode='1002' then 1 end B0491,
CASE WHEN e_titlecode='J' or e_rolecode='1009' then 1 end B0492,
CASE WHEN (e_titlecode in('$','%','@','C','E','F') OR e_rolecode in('1005','1006','1007'))
            and numberemployees < 50
              and B0493 =  1
              AND (cast(date_part(year,getdate()) as int) - yearfirstappeared <=5 OR cast(date_part(year,getdate()) as int) - yearestablished <= 5) then 1 end B0493,
CASE WHEN ((e_titlecode IN('1','2','C') OR e_rolecode='1001') and numberemployees < 25) OR e_functionalareacode in('6900','8602','8613') then 1 end B0494,
---
---new segs
 CASE WHEN	e_functionalareacode=4407 and e_levelcode=1	then 1 end	B0495,
CASE WHEN	e_functionalareacode=4412 and e_levelcode=1	then 1 end	B0496,
CASE WHEN	e_functionalareacode=4417 and e_levelcode=1	then 1 end	B0497,
CASE WHEN	e_functionalareacode=4422 and e_levelcode in (1,2)	then 1 end	B0498,
CASE WHEN	e_departmentcode=44 and e_levelcode in (3,4)	then 1 end	B0499,
CASE WHEN	e_departmentcode=55 and e_levelcode=1	then 1 end	B0500,
CASE WHEN	e_functionalareacode in (5616,5620,5621,5627)	then 1 end	B0501,
CASE WHEN	e_functionalareacode in (5628)	then 1 end	B0502,
CASE WHEN	e_functionalareacode in (5613,5614)	then 1 end	B0503,
CASE WHEN	e_functionalareacode in (7312,7316) and e_levelcode in (1,2)	then 1 end	B0504,
CASE WHEN	e_departmentcode=86 and e_levelcode in (1,2)	then 1 end	B0505,
CASE WHEN	e_departmentcode=47 and e_levelcode in (1,2)	then 1 end	B0506,
CASE WHEN	e_functionalareacode in (4703,4704) and e_levelcode in (1,2)	then 1 end	B0507,
CASE WHEN	e_functionalareacode in (4703,4705) and e_levelcode in (1,2)	then 1 end	B0508,
CASE WHEN	e_functionalareacode in (4708,6703) and e_levelcode in (1,2,5)	then 1 end	B0509,
CASE WHEN	e_functionalareacode in (4708,6703) and e_levelcode in (3,4)	then 1 end	B0510,
CASE WHEN	e_departmentcode=61 and e_levelcode in (1,2)	then 1 end	B0511,
CASE WHEN	e_departmentcode=61 and e_levelcode in (3,4,5)	then 1 end	B0512,
CASE WHEN	e_functionalareacode in (5101) and e_levelcode in (1,2)	then 1 end	B0513,
CASE WHEN	e_departmentcode=58 and e_levelcode in (1,2)	then 1 end	B0514,
CASE WHEN	e_departmentcode=58 and e_levelcode in (1,2)	then 1 end	B0515,
CASE WHEN	e_functionalareacode in (6502) and e_levelcode in (1,2)	then 1 end	B0516,
CASE WHEN	e_functionalareacode in (6507,6508) and e_levelcode in (1,2)	then 1 end	B0517,
CASE WHEN	e_departmentcode=65 and e_levelcode in (1,2)	then 1 end	B0518,
CASE WHEN	e_functionalareacode in (6812) and e_levelcode in (1,2)	then 1 end	B0519,
CASE WHEN	e_functionalareacode in (6812) and e_levelcode in (3,4,5)	then 1 end	B0520,
CASE WHEN	e_functionalareacode in (6823) and e_levelcode in (1,2)	then 1 end	B0521,
CASE WHEN	e_functionalareacode in (6823) and e_levelcode in (3,4,5)	then 1 end	B0522,
CASE WHEN	e_functionalareacode in (8803) and e_levelcode in (1,2)	then 1 end	B0523,
CASE WHEN	e_functionalareacode in (8304,8312,8313) and e_levelcode in (1,2)	then 1 end	B0524,
CASE WHEN	e_titlecode='2'	then 1 end	B0525,
CASE WHEN	e_rolecode IN ('1005','1006','1007')	then 1 end	B0526,
CASE WHEN	e_rolecode='1002'	then 1 end	B0527,
CASE WHEN	e_rolecode='1001'	then 1 end	B0528,
CASE WHEN	e_rolecode='1006'	then 1 end	B0529,
CASE WHEN	e_rolecode IN ('1001','1007','1008') and (e_departmentcode='87'	or e_functionalareacode in(4404,4701,4801,5604,5613,6001,6102,6501,6601,6802,7702,7801,8104,8301,8601)) then 1 end	B0530,
CASE WHEN	e_rolecode='1007' and e_departmentcode='44'	then 1 end	B0531,
CASE WHEN	e_rolecode='1007' and e_departmentcode='65'	then 1 end	B0532,
CASE WHEN	e_rolecode='1007' and e_departmentcode='68'	then 1 end	B0533,
CASE WHEN	e_rolecode IN ('1008','1009','1010')	then 1 end	B0534,
CASE WHEN	e_rolecode IN ('1008','1009','1010') and e_departmentcode='87'	then 1 end	B0535,
CASE WHEN	e_rolecode IN ('1008','1009','1010') and e_departmentcode='44'	then 1 end	B0536,
CASE WHEN	e_rolecode IN ('1008','1009','1010') and e_departmentcode='65'	then 1 end	B0537,
CASE WHEN	e_rolecode IN ('1008','1009','1010') and e_departmentcode='68'	then 1 end	B0538,
CASE WHEN	e_rolecode IN ('1008','1009','1010') and e_departmentcode='61'	then 1 end	B0539,
CASE WHEN	e_rolecode IN ('1008','1009','1010') and e_departmentcode='81'	then 1 end	B0540,
CASE WHEN	e_rolecode IN ('1008','1009','1010') and e_departmentcode='86'	then 1 end	B0541,
CASE WHEN	e_rolecode IN ('1008','1009','1010') and e_departmentcode='73'	then 1 end	B0542,
CASE WHEN	e_rolecode IN ('1099','2000')	then 1 end	B0543,
CASE WHEN	e_rolecode IN ('1099','2000') and e_departmentcode='87'	then 1 end	B0544,
CASE WHEN	e_rolecode IN ('1099','2000') and e_departmentcode='44'	then 1 end	B0545,
CASE WHEN	e_rolecode IN ('1099','2000') and e_departmentcode='65'	then 1 end	B0546,
CASE WHEN	e_rolecode IN ('1099','2000') and e_departmentcode='68'	then 1 end	B0547,
CASE WHEN	e_rolecode IN ('1099','2000') and e_departmentcode='61'	then 1 end	B0548,
CASE WHEN	e_rolecode IN ('1099','2000') and e_departmentcode='81'	then 1 end	B0549,
CASE WHEN	e_rolecode IN ('1099','2000') and e_departmentcode='86'	then 1 end	B0550,
CASE WHEN	e_rolecode IN ('1099','2000') and e_departmentcode='73'	then 1 end	B0551,
CASE WHEN	e_rolecode IN ('1005','1006','1007') and B0552 = 1	then 1 end	B0552,
CASE WHEN	e_rolecode IN ('1005','1006','1007') and B0553 = 1	then 1 end	B0553,
CASE WHEN	e_rolecode IN ('1005','1006','1007') and B0554 = 1	then 1 end	B0554,
CASE WHEN	e_rolecode IN ('1005','1006','1007') and B0555 = 1	then 1 end	B0555,
CASE WHEN	e_rolecode IN ('1005','1006','1007') and B0556 = 1	then 1 end	B0556,
CASE WHEN	e_rolecode IN ('1005','1006','1007') and B0557 = 1	then 1 end	B0557,
CASE WHEN	e_rolecode IN ('1005','1006','1007') and B0558 = 1	then 1 end	B0558,
CASE WHEN	e_rolecode IN ('1005','1006','1007') and B0559 = 1	then 1 end	B0559,
CASE WHEN	e_rolecode IN ('1005','1006','1007') and B0560 = 1	then 1 end	B0560,
CASE WHEN	e_rolecode IN ('1005','1006','1007') and B0561 = 1	then 1 end	B0561,
CASE WHEN	e_rolecode IN ('1005','1006','1007') and B0562 = 1	then 1 end	B0562,
CASE WHEN	e_rolecode IN ('1005','1006','1007') and B0563 = 1	then 1 end	B0563,
CASE WHEN	e_levelcode IN ('1','2') and B0564 = 1	then 1 end	B0564,
CASE WHEN	e_levelcode IN ('1','2') and B0565 = 1	then 1 end	B0565,
CASE WHEN	e_levelcode IN ('1','2') and B0566 = 1	then 1 end	B0566,
CASE WHEN	e_levelcode IN ('1','2') and B0567 = 1	then 1 end	B0567,
CASE WHEN	e_levelcode IN ('1','2') and B0568 = 1	then 1 end	B0568,
CASE WHEN	e_levelcode IN ('1','2') and B0569 = 1	then 1 end	B0569,
CASE WHEN	e_levelcode IN ('1','2') and B0570 = 1	then 1 end	B0570,
CASE WHEN	e_levelcode IN ('1','2') and B0571 = 1	then 1 end	B0571,
CASE WHEN	e_levelcode IN ('1','2') and B0572 = 1	then 1 end	B0572,
CASE WHEN	e_levelcode IN ('1','2') and B0573 = 1	then 1 end	B0573,
CASE WHEN	e_levelcode IN ('1','2') and B0574 = 1	then 1 end	B0574,
CASE WHEN	e_levelcode IN ('1','2') and B0575 = 1	then 1 end	B0575,
CASE WHEN	e_levelcode IN ('1','2') and e_gender='F'	then 1 end	B0576,
CASE WHEN	e_levelcode IN ('1','2') and companyholdingstatus='1'	then 1 end	B0577,
CASE WHEN	e_levelcode IN ('1','2') and companyholdingstatus='0'	then 1 end	B0578,
CASE WHEN	B0579 = 1	then 1 end	B0579,
CASE WHEN	e_rolecode='1001' and e_gender='F'	then 1 end	B0580,
CASE WHEN	actualemployees=1 or numberemployees=1 or cottagecode != '' or cottagecode='C'	then 1 end	B0581,
CASE WHEN	numberemployees >=1 and numberemployees < 50 and ((year(getdate()) - yearestablished <=5) or yearcode <= 5)	then 1 end	B0582,

CASE WHEN	companyholdingstatus='0'	then 1 end	B0583,
CASE WHEN	companyholdingstatus='1'	then 1 end	B0584,
CASE WHEN	s_truefranchiseflag='Y' 	then 1 end	B0585,

CASE WHEN (CurrentTransactionCode = 'A' or
          datediff(day, cast(nbrcnewadddate as date), getdate()) <= 100 ) and (CurrentTransactionCode !='' or nbrcnewadddate !='') then 1 end	B0586,



CASE WHEN (	(numberemployees >= 1 and numberemployees <= 500)	) then 1 end	B0587,

CASE WHEN	(numberemployees >= 1 and numberemployees <= 9)	then 1 end	B0588,
CASE WHEN	(numberemployees >= 10 and numberemployees <= 50)	then 1 end	B0589,
CASE WHEN	(numberemployees >= 51 and numberemployees <= 100)	then 1 end	B0590,
CASE WHEN	(numberemployees >= 101 and numberemployees <= 250)	then 1 end	B0591
---
from digital.business_exec_fullset e join
digital.business_flag_ecdata2 b on (b.abinumber = e.abinumber)
left outer join digital.business_sic_segments_full_nodup_aws s
 on s.abinumber=b.abinumber
 where ltrim(rtrim(e.e_firstname)) >'' and
  b.state != 'PR' and b.state != 'VI'
 and ( ltrim(rtrim(fulfillmentflag)) != '' and fulfillmentflag != 'N');
---and isnumeric(zipcode) = 1;
---(213,134,318 row(s) affected)  02:58:00  05:02:02    ---QA (789295 row(s) affected)



insert into digital.business_segments_aws (
id, orig_id, e_executivesourcecode, e_contactid, e_vendorid2, abinumber, e_individualid, e_familyid, e_firstname, e_lastname, phonenumber, email, orig_email, m_address_mailing, m_city_mailing, m_state_mailing, m_zipcode_mailing, m_zipfour_mailing, address, city, state, zipcode, zipfour, m_address_landmark, m_city_landmark, m_state_landmark, m_zipcode_landmark, m_zipfour_landmark, e_homeaddress, e_homecity, e_homestate, e_homezipcode, e_homezip4,
fulfillmentflag, dataset,
B0001, B0002, B0003, B0004, B0005, B0006, B0007, B0008, B0009, B0010, B0011, B0012, B0013, B0014, B0015, B0016, B0017, B0018, B0019, B0020, B0021, B0022, B0023, B0024, B0025, B0026, B0027, B0028, B0029, B0030, B0031, B0032, B0033, B0034, B0035, B0036, B0037, B0038, B0039, B0040, B0041, B0042, B0043, B0044, B0045, B0046, B0047, B0048, B0049, B0050, B0051, B0052, B0053, B0054, B0055, B0056, B0057, B0058, B0059, B0060, B0061, B0062, B0063, B0064, B0065, B0066, B0067, B0068, B0069, B0070, B0071, B0072, B0073, B0074, B0075, B0076, B0077, B0078, B0079, B0080, B0081, B0082, B0083, B0084, B0085, B0086, B0087, B0088, B0089, B0090, B0091, B0092, B0093, B0094, B0095, B0096, B0097, B0098, B0099, B0100, B0101, B0102, B0103, B0104, B0105, B0106, B0107, B0108, B0110, B0111, B0112, B0113, B0114, B0115, B0116, B0117, B0118, B0119, B0120, B0121, B0122, B0123, B0124, B0125, B0126, B0127, B0128, B0129, B0130, B0131, B0132, B0133, B0134, B0135, B0136, B0137, B0138, B0139, B0140, B0141, B0142, B0143, B0144, B0145, B0146, B0147, B0148, B0149, B0150, B0151, B0152, B0153, B0299, B0300, B0301, B0302, B0303, B0306, B0307, B0323, B0324, B0325, B0326, B0327, B0328, B0329, B0330, B0331, B0332, B0333, B0334, B0335, B0336, B0337, B0338, B0339, B0340, B0350, B0351, B0352, B0353, B0354, B0355, B0356, B0357, B0358, B0359, B0360, B0361, B0362, B0363, B0364, B0365, B0366, B0367, B0368, B0369, B0370, B0375, B0378, B0379, B0380, B0381, B0382, B0383, B0384, B0385, B0386, B0387, B0388, B0389, B0390, B0391, B0392, B0393, B0394, B0395, B0396, B0397, B0398, B0399, B0400, B0401, B0402, B0403, B0404, B0405, B0406, B0407, B0408, B0409, B0410, B0411, B0412, B0413, B0414, B0415, B0416, B0417, B0418, B0419, B0420, B0421, B0422, B0423, B0424, B0425, B0426, B0427, B0428, B0429, B0430, B0431, B0432, B0433, B0434, B0435, B0436, B0437, B0438, B0439, B0440, B0441, B0442, B0443, B0444, B0445, B0446, B0447, B0448, B0449, B0450, B0451, B0452, B0453, B0454, B0455, B0456,
B0457,B0458,B0459,B0460,B0461,B0462,B0463,B0464,B0465,B0466,B0467,B0468,B0469,B0470,B0471,B0472,B0473,B0474,B0475,B0476,B0477,B0478,B0479,B0480,B0481,B0482,B0483,B0484,B0485,B0486,B0487,B0488,B0489,B0490,B0491,B0492,B0493,B0494
B0001, B0002, B0003, B0004, B0005, B0006, B0007, B0008, B0009, B0010, B0011, B0012, B0013, B0014, B0015, B0016, B0017, B0018, B0019, B0020, B0021, B0022, B0023, B0024, B0025, B0026, B0027, B0028, B0029, B0030, B0031, B0032, B0033, B0034, B0035, B0036, B0037, B0038, B0039, B0040, B0041, B0042, B0043, B0044, B0045, B0046, B0047, B0048, B0049, B0050, B0051, B0052, B0053, B0054, B0055, B0056, B0057, B0058, B0059, B0060, B0061, B0062, B0063, B0064, B0065, B0066, B0067, B0068, B0069, B0070, B0071, B0072, B0073, B0074, B0075, B0076, B0077, B0078, B0079, B0080, B0081, B0082, B0083, B0084, B0085, B0086, B0087, B0088, B0089, B0090, B0091, B0092, B0093, B0094, B0095, B0096, B0097, B0098, B0099, B0100, B0101, B0102, B0103, B0104, B0105, B0106, B0107, B0108, B0110, B0111, B0112, B0113, B0114, B0115, B0116, B0117, B0118, B0119, B0120, B0121, B0122, B0123, B0124, B0125, B0126, B0127, B0128, B0129, B0130, B0131, B0132, B0133, B0134, B0135, B0136, B0137, B0138, B0139, B0140, B0141, B0142, B0143, B0144, B0145, B0146, B0147, B0148, B0149, B0150, B0151, B0152, B0153, B0299, B0300, B0301, B0302, B0303, B0306, B0307, B0323, B0324, B0325, B0326, B0327, B0328, B0329, B0330, B0331, B0332, B0333, B0334, B0335, B0336, B0337, B0338, B0339, B0340, B0350, B0351, B0352, B0353, B0354, B0355, B0356, B0357, B0358, B0359, B0360, B0361, B0362, B0363, B0364, B0365, B0366, B0367, B0368, B0369, B0370, B0375, B0378, B0379, B0380, B0381, B0382, B0383, B0384, B0385, B0386, B0387, B0388, B0389, B0390, B0391, B0392, B0393, B0394, B0395, B0396, B0397, B0398, B0399, B0400, B0401, B0402, B0403, B0404, B0405, B0406, B0407, B0408, B0409, B0410, B0411, B0412, B0413, B0414, B0415, B0416, B0417, B0418, B0419, B0420, B0421, B0422, B0423, B0424, B0425, B0426, B0427, B0428, B0429, B0430, B0431, B0432, B0433, B0434, B0435, B0436, B0437, B0438, B0439, B0440, B0441, B0442, B0443, B0444, B0445, B0446, B0447, B0448, B0449, B0450, B0451, B0452, B0453, B0454, B0455, B0456,
B0457,B0458,B0459,B0460,B0461,B0462,B0463,B0464,B0465,B0466,B0467,B0468,B0469,B0470,B0471,B0472,B0473,B0474,B0475,B0476,B0477,B0478,B0479,B0480,B0481,B0482,B0483,B0484,B0485,B0486,B0487,B0488,B0489,B0490,B0491,B0492,B0493,B0494,
B0495, B0496, B0497, B0498, B0499, B0500, B0501, B0502, B0503, B0504, B0505, B0506, B0507, B0508, B0509, B0510, B0511, B0512, B0513, B0514, B0515, B0516, B0517, B0518,
B0519, B0520, B0521, B0522,	B0523, B0524, B0525, B0526, B0527, B0528, B0529, B0530, B0531, B0532, B0533, B0534, B0535, B0536, B0537, B0538, B0539, B0540, B0541, B0542,
B0543, B0544, B0545, B0546, B0547, B0548, B0549, B0550, B0551, B0552, B0553, B0554, B0555, B0556, B0557, B0558, B0559, B0560, B0561, B0562, B0563, B0564, B0565, B0566,
B0567, B0568, B0569, B0570, B0571, B0572, B0573, B0574, B0575, B0576, B0577, B0578, B0579, B0580, B0581, B0582, B0583, B0584, B0585, B0586, B0587, B0588, B0589, B0590,
B0591
)
select * from digital.business_email_nonmatches_segments_aws;
---(73,447,912 row(s) affected)          ---QA (266171 row(s) affected)

---Begin Explode
drop table if exists digital.business_segments_bb_vv_aws;

create table digital.business_segments_bb_vv_aws as
select
--updated New_Id
--case
--when trim(e_contactid) != '' then e_contactid
--when trim(abinumber) != ''  then abinumber
--ELSE '000000000'
--END New_ID,
case when ltrim(rtrim(abinumber)) != '' AND (ltrim(rtrim(e_executivesourcecode)) = '' OR e_executivesourcecode = 36) then 'B'
  when ltrim(rtrim(abinumber)) = '' OR ( ltrim(rtrim(e_executivesourcecode)) != '' AND e_executivesourcecode != 36) Then 'V'  END +
case
when ltrim(rtrim(e_contactid)) != '' then e_contactid
when ltrim(rtrim(abinumber)) != ''  then abinumber
ELSE '000000000'
END  +
'-'+
case when (ltrim(rtrim(e_vendorid2)) = '00' OR e_vendorid2  = 36 ) then 'B' ELSE 'V' END  +
 ID  +
 '-'+
 case when ltrim(rtrim(e_vendorid2)) = '' then '0' else e_vendorid2 end
 business_Exec_ID ,
 id,
 e_executivesourcecode,
 abinumber,
 e_vendorid2,
e_firstname     ,
e_lastname      ,
phonenumber     ,
email   ,
orig_email,
m_address_mailing       ,
m_city_mailing  ,
m_state_mailing ,
m_zipcode_mailing       ,
m_zipfour_mailing       ,
address ,
city    ,
state   ,
zipcode ,
zipfour ,
m_address_landmark      ,
m_city_landmark ,
m_state_landmark        ,
m_zipcode_landmark      ,
m_zipfour_landmark      ,
e_homeaddress,
e_homecity,
e_homestate,
e_homezipcode,
e_homezip4,
fulfillmentflag,
dataset,
B0001	,
B0002	,
B0003	,
B0004	,
B0005	,
B0006	,
B0007	,
B0008	,
B0009	,
B0010	,
B0011	,
B0012	,
B0013	,
B0014	,
B0015	,
B0016	,
B0017	,
B0018	,
B0019	,
B0020	,
B0021	,
B0022	,
B0023	,
B0024	,
B0025	,
B0026	,
B0027	,
B0028	,
B0029	,
B0030	,
B0031	,
B0032	,
B0033	,
B0034	,
B0035	,
B0036	,
B0037	,
B0038	,
B0039	,
B0040	,
B0041	,
B0042	,
B0043	,
B0044	,
B0045	,
B0046	,
B0047	,
B0048	,
B0049	,
B0050	,
B0051	,
B0052	,
B0053	,
B0054	,
B0055	,
B0056	,
B0057	,
B0058	,
B0059	,
B0060	,
B0061	,
B0062	,
B0063	,
B0064	,
B0065	,
B0066	,
B0067	,
B0068	,
B0069	,
B0070	,
B0071	,
B0072	,
B0073	,
B0074	,
B0075	,
B0076	,
B0077	,
B0078	,
B0079	,
B0080	,
B0081	,
B0082	,
B0083	,
B0084	,
B0085	,
B0086	,
B0087	,
B0088	,
B0089	,
B0090	,
B0091	,
B0092	,
B0093	,
B0094	,
B0095	,
B0096	,
B0097	,
B0098	,
B0099	,
B0100	,
B0101	,
B0102	,
B0103	,
B0104	,
B0105	,
B0106	,
B0107	,
B0108	,
B0110	,
B0111	,
B0112	,
B0113	,
B0114	,
B0115	,
B0116	,
B0117	,
B0118	,
B0119	,
B0120	,
B0121	,
B0122	,
B0123	,
B0124	,
B0125	,
B0126	,
B0127	,
B0128	,
B0129	,
B0130	,
B0131	,
B0132	,
B0133	,
B0134	,
B0135	,
B0136	,
B0137	,
B0138	,
B0139	,
B0140	,
B0141	,
B0142	,
B0143	,
B0144	,
B0145	,
B0146	,
B0147	,
B0148	,
B0149	,
B0150	,
B0151	,
B0152	,
B0153	,
B0299	,
B0300	,
B0301	,
B0302	,
B0303	,
B0306	,
B0307	,
B0323	,
B0324	,
B0325	,
B0326	,
B0327	,
B0328	,
B0329	,
B0330	,
B0331	,
B0332	,
B0333	,
B0334	,
B0335	,
B0336	,
B0337	,
B0338	,
B0339	,
B0340	,
B0350	,
B0351	,
B0352	,
B0353	,
B0354	,
B0355	,
B0356	,
B0357	,
B0358	,
B0359	,
B0360	,
B0361	,
B0362	,
B0363	,
B0364	,
B0365	,
B0366	,
B0367	,
B0368	,
B0369	,
B0370	,
B0375	,
B0378	,
B0379	,
B0380	,
B0381	,
B0382	,
B0383	,
B0384	,
B0385	,
B0386	,
B0387	,
B0388	,
B0389	,
B0390	,
B0391	,
B0392	,
B0393	,
B0394	,
B0395	,
B0396	,
B0397	,
B0398	,
B0399	,
B0400	,
B0401	,
B0402	,
B0403	,
B0404	,
B0405	,
B0406	,
B0407	,
B0408	,
B0409	,
B0410	,
B0411	,
B0412	,
B0413	,
B0414	,
B0415	,
B0416	,
B0417	,
B0418	,
B0419	,
B0420	,
B0421	,
B0422	,
B0423	,
B0424	,
B0425	,
B0426	,
B0427	,
B0428	,
B0429	,
B0430	,
B0431	,
B0432	,
B0433	,
B0434	,
B0435	,
B0436	,
B0437	,
B0438	,
B0439	,
B0440	,
B0441	,
B0442	,
B0443	,
B0444	,
B0445	,
B0446	,
B0447	,
B0448	,
B0449	,
B0450	,
B0451	,
B0452	,
B0453	,
B0454	,
B0455	,
B0456	,
---
B0457   ,
B0458   ,
B0459   ,
B0460   ,
B0461   ,
B0462   ,
B0463   ,
B0464   ,
B0465   ,
B0466   ,
B0467   ,
B0468   ,
B0469   ,
B0470   ,
B0471   ,
B0472   ,
B0473   ,
B0474   ,
B0475   ,
B0476   ,
B0477   ,
B0478   ,
B0479   ,
B0480   ,
B0481   ,
B0482   ,
B0483   ,
B0484   ,
B0485   ,
B0486   ,
B0487   ,
B0488   ,
B0489   ,
B0490   ,
B0491   ,
B0492   ,
B0493   ,
B0494   ,
---
B0495	,
B0496	,
B0497	,
B0498	,
B0499	,
B0500	,
B0501	,
B0502	,
B0503	,
B0504	,
B0505	,
B0506	,
B0507	,
B0508	,
B0509	,
B0510	,
B0511	,
B0512	,
B0513	,
B0514	,
B0515	,
B0516	,
B0517	,
B0518	,
B0519	,
B0520	,
B0521	,
B0522	,
B0523	,
B0524	,
B0525	,
B0526	,
B0527	,
B0528	,
B0529	,
B0530	,
B0531	,
B0532	,
B0533	,
B0534	,
B0535	,
B0536	,
B0537	,
B0538	,
B0539	,
B0540	,
B0541	,
B0542	,
B0543	,
B0544	,
B0545	,
B0546	,
B0547	,
B0548	,
B0549	,
B0550	,
B0551	,
B0552	,
B0553	,
B0554	,
B0555	,
B0556	,
B0557	,
B0558	,
B0559	,
B0560	,
B0561	,
B0562	,
B0563	,
B0564	,
B0565	,
B0566	,
B0567	,
B0568	,
B0569	,
B0570	,
B0571	,
B0572	,
B0573	,
B0574	,
B0575	,
B0576	,
B0577	,
B0578	,
B0579	,
B0580	,
B0581	,
B0582	,
B0583	,
B0584	,
B0585	,
B0586	,
B0587	,
B0588	,
B0589	,
B0590	,
B0591
---seqnum=identity(int,1,1)
from digital.business_segments_aws
where   ( ( ltrim(rtrim(e_executivesourcecode)) = '' OR e_executivesourcecode = 36 )
AND ( ltrim(rtrim(e_vendorid2)) = '00' OR e_vendorid2 = 36  ) )
OR
 (( ltrim(rtrim(e_executivesourcecode)) != '' AND e_executivesourcecode != 36 )
AND ( ltrim(rtrim(e_vendorid2)) != '00' AND e_vendorid2 != 36  ) );
---(251,876,631 row(s) affected) 04:35:07         ----QA (956658 row(s) affected)

insert into digital.business_segments_bb_vv_aws (
business_Exec_ID,
id,
e_executivesourcecode,
abinumber,
e_vendorid2,
e_firstname,
e_lastname,
phonenumber,
email,
orig_email,
m_address_mailing,
m_city_mailing,
m_state_mailing,
m_zipcode_mailing,
m_zipfour_mailing,
address,
city,
state,
zipcode,
zipfour,
m_address_landmark,
m_city_landmark,
m_state_landmark,
m_zipcode_landmark,
m_zipfour_landmark,
e_homeaddress,
e_homecity,
e_homestate,
e_homezipcode,
e_homezip4,
fulfillmentflag,
dataset,
B0001	,
B0002	,
B0003	,
B0004	,
B0005	,
B0006	,
B0007	,
B0008	,
B0009	,
B0010	,
B0011	,
B0012	,
B0013	,
B0014	,
B0015	,
B0016	,
B0017	,
B0018	,
B0019	,
B0020	,
B0021	,
B0022	,
B0023	,
B0024	,
B0025	,
B0026	,
B0027	,
B0028	,
B0029	,
B0030	,
B0031	,
B0032	,
B0033	,
B0034	,
B0035	,
B0036	,
B0037	,
B0038	,
B0039	,
B0040	,
B0041	,
B0042	,
B0043	,
B0044	,
B0045	,
B0046	,
B0047	,
B0048	,
B0049	,
B0050	,
B0051	,
B0052	,
B0053	,
B0054	,
B0055	,
B0056	,
B0057	,
B0058	,
B0059	,
B0060	,
B0061	,
B0062	,
B0063	,
B0064	,
B0065	,
B0066	,
B0067	,
B0068	,
B0069	,
B0070	,
B0071	,
B0072	,
B0073	,
B0074	,
B0075	,
B0076	,
B0077	,
B0078	,
B0079	,
B0080	,
B0081	,
B0082	,
B0083	,
B0084	,
B0085	,
B0086	,
B0087	,
B0088	,
B0089	,
B0090	,
B0091	,
B0092	,
B0093	,
B0094	,
B0095	,
B0096	,
B0097	,
B0098	,
B0099	,
B0100	,
B0101	,
B0102	,
B0103	,
B0104	,
B0105	,
B0106	,
B0107	,
B0108	,
B0110	,
B0111	,
B0112	,
B0113	,
B0114	,
B0115	,
B0116	,
B0117	,
B0118	,
B0119	,
B0120	,
B0121	,
B0122	,
B0123	,
B0124	,
B0125	,
B0126	,
B0127	,
B0128	,
B0129	,
B0130	,
B0131	,
B0132	,
B0133	,
B0134	,
B0135	,
B0136	,
B0137	,
B0138	,
B0139	,
B0140	,
B0141	,
B0142	,
B0143	,
B0144	,
B0145	,
B0146	,
B0147	,
B0148	,
B0149	,
B0150	,
B0151	,
B0152	,
B0153	,
B0299	,
B0300	,
B0301	,
B0302	,
B0303	,
B0306	,
B0307	,
B0323	,
B0324	,
B0325	,
B0326	,
B0327	,
B0328	,
B0329	,
B0330	,
B0331	,
B0332	,
B0333	,
B0334	,
B0335	,
B0336	,
B0337	,
B0338	,
B0339	,
B0340	,
B0350	,
B0351	,
B0352	,
B0353	,
B0354	,
B0355	,
B0356	,
B0357	,
B0358	,
B0359	,
B0360	,
B0361	,
B0362	,
B0363	,
B0364	,
B0365	,
B0366	,
B0367	,
B0368	,
B0369	,
B0370	,
B0375	,
B0378	,
B0379	,
B0380	,
B0381	,
B0382	,
B0383	,
B0384	,
B0385	,
B0386	,
B0387	,
B0388	,
B0389	,
B0390	,
B0391	,
B0392	,
B0393	,
B0394	,
B0395	,
B0396	,
B0397	,
B0398	,
B0399	,
B0400	,
B0401	,
B0402	,
B0403	,
B0404	,
B0405	,
B0406	,
B0407	,
B0408	,
B0409	,
B0410	,
B0411	,
B0412	,
B0413	,
B0414	,
B0415	,
B0416	,
B0417	,
B0418	,
B0419	,
B0420	,
B0421	,
B0422	,
B0423	,
B0424	,
B0425	,
B0426	,
B0427	,
B0428	,
B0429	,
B0430	,
B0431	,
B0432	,
B0433	,
B0434	,
B0435	,
B0436	,
B0437	,
B0438	,
B0439	,
B0440	,
B0441	,
B0442	,
B0443	,
B0444	,
B0445	,
B0446	,
B0447	,
B0448	,
B0449	,
B0450	,
B0451	,
B0452	,
B0453	,
B0454	,
B0455	,
B0456   ,
---
B0457   ,
B0458   ,
B0459   ,
B0460   ,
B0461   ,
B0462   ,
B0463   ,
B0464   ,
B0465   ,
B0466   ,
B0467   ,
B0468   ,
B0469   ,
B0470   ,
B0471   ,
B0472   ,
B0473   ,
B0474   ,
B0475   ,
B0476   ,
B0477   ,
B0478   ,
B0479   ,
B0480   ,
B0481   ,
B0482   ,
B0483   ,
B0484   ,
B0485   ,
B0486   ,
B0487   ,
B0488   ,
B0489   ,
B0490   ,
B0491   ,
B0492   ,
B0493   ,
B0494   ,
---
B0495	,
B0496	,
B0497	,
B0498	,
B0499	,
B0500	,
B0501	,
B0502	,
B0503	,
B0504	,
B0505	,
B0506	,
B0507	,
B0508	,
B0509	,
B0510	,
B0511	,
B0512	,
B0513	,
B0514	,
B0515	,
B0516	,
B0517	,
B0518	,
B0519	,
B0520	,
B0521	,
B0522	,
B0523	,
B0524	,
B0525	,
B0526	,
B0527	,
B0528	,
B0529	,
B0530	,
B0531	,
B0532	,
B0533	,
B0534	,
B0535	,
B0536	,
B0537	,
B0538	,
B0539	,
B0540	,
B0541	,
B0542	,
B0543	,
B0544	,
B0545	,
B0546	,
B0547	,
B0548	,
B0549	,
B0550	,
B0551	,
B0552	,
B0553	,
B0554	,
B0555	,
B0556	,
B0557	,
B0558	,
B0559	,
B0560	,
B0561	,
B0562	,
B0563	,
B0564	,
B0565	,
B0566	,
B0567	,
B0568	,
B0569	,
B0570	,
B0571	,
B0572	,
B0573	,
B0574	,
B0575	,
B0576	,
B0577	,
B0578	,
B0579	,
B0580	,
B0581	,
B0582	,
B0583	,
B0584	,
B0585	,
B0586	,
B0587	,
B0588	,
B0589	,
B0590	,
B0591
)
select
--updated New_Id
--case
--when trim(e_contactid) != '' then e_contactid
--when trim(abinumber) != ''  then abinumber
--ELSE '000000000'
--END New_ID,
case when ltrim(rtrim(abinumber)) != '' AND (ltrim(rtrim(e_executivesourcecode)) = '' OR e_executivesourcecode = 36) then 'B'
when ltrim(rtrim(abinumber)) = '' OR ( ltrim(rtrim(e_executivesourcecode)) != '' AND e_executivesourcecode != 36) Then 'V'  END +
case
when ltrim(rtrim(e_contactid)) != '' then e_contactid
when ltrim(rtrim(abinumber)) != ''  then abinumber
ELSE '000000000'
END  +
 '-'+
 --case when (trim(e_vendorid2) = '00' OR e_vendorid2  = 36 ) then 'B' ELSE 'V' END,
 case when ltrim(rtrim(abinumber)) != '' AND (ltrim(rtrim(e_executivesourcecode)) = '' OR e_executivesourcecode = 36) then 'B' ELSE 'V' END +
 ID  +
 '-'+
 case when ltrim(rtrim(e_vendorid2)) = '' then '0' else e_vendorid2 end
 business_Exec_ID ,
 id,
 e_executivesourcecode,
 abinumber,
 e_vendorid2,
e_firstname     ,
e_lastname      ,
phonenumber     ,
'' email   ,
'' orig_email,
m_address_mailing       ,
m_city_mailing  ,
m_state_mailing ,
m_zipcode_mailing       ,
m_zipfour_mailing       ,
address ,
city    ,
state   ,
zipcode ,
zipfour ,
m_address_landmark      ,
m_city_landmark ,
m_state_landmark        ,
m_zipcode_landmark      ,
m_zipfour_landmark      ,
e_homeaddress,
e_homecity,
e_homestate,
e_homezipcode,
e_homezip4,
fulfillmentflag,
dataset,
B0001	,
B0002	,
B0003	,
B0004	,
B0005	,
B0006	,
B0007	,
B0008	,
B0009	,
B0010	,
B0011	,
B0012	,
B0013	,
B0014	,
B0015	,
B0016	,
B0017	,
B0018	,
B0019	,
B0020	,
B0021	,
B0022	,
B0023	,
B0024	,
B0025	,
B0026	,
B0027	,
B0028	,
B0029	,
B0030	,
B0031	,
B0032	,
B0033	,
B0034	,
B0035	,
B0036	,
B0037	,
B0038	,
B0039	,
B0040	,
B0041	,
B0042	,
B0043	,
B0044	,
B0045	,
B0046	,
B0047	,
B0048	,
B0049	,
B0050	,
B0051	,
B0052	,
B0053	,
B0054	,
B0055	,
B0056	,
B0057	,
B0058	,
B0059	,
B0060	,
B0061	,
B0062	,
B0063	,
B0064	,
B0065	,
B0066	,
B0067	,
B0068	,
B0069	,
B0070	,
B0071	,
B0072	,
B0073	,
B0074	,
B0075	,
B0076	,
B0077	,
B0078	,
B0079	,
B0080	,
B0081	,
B0082	,
B0083	,
B0084	,
B0085	,
B0086	,
B0087	,
B0088	,
B0089	,
B0090	,
B0091	,
B0092	,
B0093	,
B0094	,
B0095	,
B0096	,
B0097	,
B0098	,
B0099	,
B0100	,
B0101	,
B0102	,
B0103	,
B0104	,
B0105	,
B0106	,
B0107	,
B0108	,
B0110	,
B0111	,
B0112	,
B0113	,
B0114	,
B0115	,
B0116	,
B0117	,
B0118	,
B0119	,
B0120	,
B0121	,
B0122	,
B0123	,
B0124	,
B0125	,
B0126	,
B0127	,
B0128	,
B0129	,
B0130	,
B0131	,
B0132	,
B0133	,
B0134	,
B0135	,
B0136	,
B0137	,
B0138	,
B0139	,
B0140	,
B0141	,
B0142	,
B0143	,
B0144	,
B0145	,
B0146	,
B0147	,
B0148	,
B0149	,
B0150	,
B0151	,
B0152	,
B0153	,
B0299	,
B0300	,
B0301	,
B0302	,
B0303	,
B0306	,
B0307	,
B0323	,
B0324	,
B0325	,
B0326	,
B0327	,
B0328	,
B0329	,
B0330	,
B0331	,
B0332	,
B0333	,
B0334	,
B0335	,
B0336	,
B0337	,
B0338	,
B0339	,
B0340	,
B0350	,
B0351	,
B0352	,
B0353	,
B0354	,
B0355	,
B0356	,
B0357	,
B0358	,
B0359	,
B0360	,
B0361	,
B0362	,
B0363	,
B0364	,
B0365	,
B0366	,
B0367	,
B0368	,
B0369	,
B0370	,
B0375	,
B0378	,
B0379	,
B0380	,
B0381	,
B0382	,
B0383	,
B0384	,
B0385	,
B0386	,
B0387	,
B0388	,
B0389	,
B0390	,
B0391	,
B0392	,
B0393	,
B0394	,
B0395	,
B0396	,
B0397	,
B0398	,
B0399	,
B0400	,
B0401	,
B0402	,
B0403	,
B0404	,
B0405	,
B0406	,
B0407	,
B0408	,
B0409	,
B0410	,
B0411	,
B0412	,
B0413	,
B0414	,
B0415	,
B0416	,
B0417	,
B0418	,
B0419	,
B0420	,
B0421	,
B0422	,
B0423	,
B0424	,
B0425	,
B0426	,
B0427	,
B0428	,
B0429	,
B0430	,
B0431	,
B0432	,
B0433	,
B0434	,
B0435	,
B0436	,
B0437	,
B0438	,
B0439	,
B0440	,
B0441	,
B0442	,
B0443	,
B0444	,
B0445	,
B0446	,
B0447	,
B0448	,
B0449	,
B0450	,
B0451	,
B0452	,
B0453	,
B0454	,
B0455	,
B0456	,
---
B0457   ,
B0458   ,
B0459   ,
B0460   ,
B0461   ,
B0462   ,
B0463   ,
B0464   ,
B0465   ,
B0466   ,
B0467   ,
B0468   ,
B0469   ,
B0470   ,
B0471   ,
B0472   ,
B0473   ,
B0474   ,
B0475   ,
B0476   ,
B0477   ,
B0478   ,
B0479   ,
B0480   ,
B0481   ,
B0482   ,
B0483   ,
B0484   ,
B0485   ,
B0486   ,
B0487   ,
B0488   ,
B0489   ,
B0490   ,
B0491   ,
B0492   ,
B0493   ,
B0494   ,
---
B0495	,
B0496	,
B0497	,
B0498	,
B0499	,
B0500	,
B0501	,
B0502	,
B0503	,
B0504	,
B0505	,
B0506	,
B0507	,
B0508	,
B0509	,
B0510	,
B0511	,
B0512	,
B0513	,
B0514	,
B0515	,
B0516	,
B0517	,
B0518	,
B0519	,
B0520	,
B0521	,
B0522	,
B0523	,
B0524	,
B0525	,
B0526	,
B0527	,
B0528	,
B0529	,
B0530	,
B0531	,
B0532	,
B0533	,
B0534	,
B0535	,
B0536	,
B0537	,
B0538	,
B0539	,
B0540	,
B0541	,
B0542	,
B0543	,
B0544	,
B0545	,
B0546	,
B0547	,
B0548	,
B0549	,
B0550	,
B0551	,
B0552	,
B0553	,
B0554	,
B0555	,
B0556	,
B0557	,
B0558	,
B0559	,
B0560	,
B0561	,
B0562	,
B0563	,
B0564	,
B0565	,
B0566	,
B0567	,
B0568	,
B0569	,
B0570	,
B0571	,
B0572	,
B0573	,
B0574	,
B0575	,
B0576	,
B0577	,
B0578	,
B0579	,
B0580	,
B0581	,
B0582	,
B0583	,
B0584	,
B0585	,
B0586	,
B0587	,
B0588	,
B0589	,
B0590	,
B0591
from digital.business_segments_aws
where   ( ( ltrim(rtrim(e_executivesourcecode)) = '' OR e_executivesourcecode = 36 )
AND ( ltrim(rtrim(e_vendorid2)) != '00' AND e_vendorid2 != 36  ) )
OR
 (( ltrim(rtrim(e_executivesourcecode)) != '' AND e_executivesourcecode != 36 )
AND ( ltrim(rtrim(e_vendorid2)) = '00' OR  e_vendorid2 = 36  ) );
---(4907115 row(s) affected)      ---QA (18657 row(s) affected)

insert into digital.business_segments_bb_vv_aws (
business_Exec_ID,
id,
e_executivesourcecode,
abinumber,
e_vendorid2,
e_firstname,
e_lastname,
phonenumber,
email,
orig_email,
m_address_mailing,
m_city_mailing,
m_state_mailing,
m_zipcode_mailing,
m_zipfour_mailing,
address,
city,
state,
zipcode,
zipfour,
m_address_landmark,
m_city_landmark,
m_state_landmark,
m_zipcode_landmark,
m_zipfour_landmark,
e_homeaddress,
e_homecity,
e_homestate,
e_homezipcode,
e_homezip4,
fulfillmentflag,
dataset,
B0001	,
B0002	,
B0003	,
B0004	,
B0005	,
B0006	,
B0007	,
B0008	,
B0009	,
B0010	,
B0011	,
B0012	,
B0013	,
B0014	,
B0015	,
B0016	,
B0017	,
B0018	,
B0019	,
B0020	,
B0021	,
B0022	,
B0023	,
B0024	,
B0025	,
B0026	,
B0027	,
B0028	,
B0029	,
B0030	,
B0031	,
B0032	,
B0033	,
B0034	,
B0035	,
B0036	,
B0037	,
B0038	,
B0039	,
B0040	,
B0041	,
B0042	,
B0043	,
B0044	,
B0045	,
B0046	,
B0047	,
B0048	,
B0049	,
B0050	,
B0051	,
B0052	,
B0053	,
B0054	,
B0055	,
B0056	,
B0057	,
B0058	,
B0059	,
B0060	,
B0061	,
B0062	,
B0063	,
B0064	,
B0065	,
B0066	,
B0067	,
B0068	,
B0069	,
B0070	,
B0071	,
B0072	,
B0073	,
B0074	,
B0075	,
B0076	,
B0077	,
B0078	,
B0079	,
B0080	,
B0081	,
B0082	,
B0083	,
B0084	,
B0085	,
B0086	,
B0087	,
B0088	,
B0089	,
B0090	,
B0091	,
B0092	,
B0093	,
B0094	,
B0095	,
B0096	,
B0097	,
B0098	,
B0099	,
B0100	,
B0101	,
B0102	,
B0103	,
B0104	,
B0105	,
B0106	,
B0107	,
B0108	,
B0110	,
B0111	,
B0112	,
B0113	,
B0114	,
B0115	,
B0116	,
B0117	,
B0118	,
B0119	,
B0120	,
B0121	,
B0122	,
B0123	,
B0124	,
B0125	,
B0126	,
B0127	,
B0128	,
B0129	,
B0130	,
B0131	,
B0132	,
B0133	,
B0134	,
B0135	,
B0136	,
B0137	,
B0138	,
B0139	,
B0140	,
B0141	,
B0142	,
B0143	,
B0144	,
B0145	,
B0146	,
B0147	,
B0148	,
B0149	,
B0150	,
B0151	,
B0152	,
B0153	,
B0299	,
B0300	,
B0301	,
B0302	,
B0303	,
B0306	,
B0307	,
B0323	,
B0324	,
B0325	,
B0326	,
B0327	,
B0328	,
B0329	,
B0330	,
B0331	,
B0332	,
B0333	,
B0334	,
B0335	,
B0336	,
B0337	,
B0338	,
B0339	,
B0340	,
B0350	,
B0351	,
B0352	,
B0353	,
B0354	,
B0355	,
B0356	,
B0357	,
B0358	,
B0359	,
B0360	,
B0361	,
B0362	,
B0363	,
B0364	,
B0365	,
B0366	,
B0367	,
B0368	,
B0369	,
B0370	,
B0375	,
B0378	,
B0379	,
B0380	,
B0381	,
B0382	,
B0383	,
B0384	,
B0385	,
B0386	,
B0387	,
B0388	,
B0389	,
B0390	,
B0391	,
B0392	,
B0393	,
B0394	,
B0395	,
B0396	,
B0397	,
B0398	,
B0399	,
B0400	,
B0401	,
B0402	,
B0403	,
B0404	,
B0405	,
B0406	,
B0407	,
B0408	,
B0409	,
B0410	,
B0411	,
B0412	,
B0413	,
B0414	,
B0415	,
B0416	,
B0417	,
B0418	,
B0419	,
B0420	,
B0421	,
B0422	,
B0423	,
B0424	,
B0425	,
B0426	,
B0427	,
B0428	,
B0429	,
B0430	,
B0431	,
B0432	,
B0433	,
B0434	,
B0435	,
B0436	,
B0437	,
B0438	,
B0439	,
B0440	,
B0441	,
B0442	,
B0443	,
B0444	,
B0445	,
B0446	,
B0447	,
B0448	,
B0449	,
B0450	,
B0451	,
B0452	,
B0453	,
B0454	,
B0455	,
B0456	,
---
B0457   ,
B0458   ,
B0459   ,
B0460   ,
B0461   ,
B0462   ,
B0463   ,
B0464   ,
B0465   ,
B0466   ,
B0467   ,
B0468   ,
B0469   ,
B0470   ,
B0471   ,
B0472   ,
B0473   ,
B0474   ,
B0475   ,
B0476   ,
B0477   ,
B0478   ,
B0479   ,
B0480   ,
B0481   ,
B0482   ,
B0483   ,
B0484   ,
B0485   ,
B0486   ,
B0487   ,
B0488   ,
B0489   ,
B0490   ,
B0491   ,
B0492   ,
B0493   ,
B0494   ,
---
B0495	,
B0496	,
B0497	,
B0498	,
B0499	,
B0500	,
B0501	,
B0502	,
B0503	,
B0504	,
B0505	,
B0506	,
B0507	,
B0508	,
B0509	,
B0510	,
B0511	,
B0512	,
B0513	,
B0514	,
B0515	,
B0516	,
B0517	,
B0518	,
B0519	,
B0520	,
B0521	,
B0522	,
B0523	,
B0524	,
B0525	,
B0526	,
B0527	,
B0528	,
B0529	,
B0530	,
B0531	,
B0532	,
B0533	,
B0534	,
B0535	,
B0536	,
B0537	,
B0538	,
B0539	,
B0540	,
B0541	,
B0542	,
B0543	,
B0544	,
B0545	,
B0546	,
B0547	,
B0548	,
B0549	,
B0550	,
B0551	,
B0552	,
B0553	,
B0554	,
B0555	,
B0556	,
B0557	,
B0558	,
B0559	,
B0560	,
B0561	,
B0562	,
B0563	,
B0564	,
B0565	,
B0566	,
B0567	,
B0568	,
B0569	,
B0570	,
B0571	,
B0572	,
B0573	,
B0574	,
B0575	,
B0576	,
B0577	,
B0578	,
B0579	,
B0580	,
B0581	,
B0582	,
B0583	,
B0584	,
B0585	,
B0586	,
B0587	,
B0588	,
B0589	,
B0590	,
B0591
)
select
--updated New_Id
--case
--when trim(e_contactid) != '' then e_contactid
--when trim(abinumber) != ''  then abinumber
--ELSE '000000000'
--END New_ID,
case when ltrim(rtrim(abinumber)) != '' AND (ltrim(rtrim(e_executivesourcecode)) = '' OR e_executivesourcecode = 36) then 'B'
when ltrim(rtrim(abinumber)) = '' OR ( ltrim(rtrim(e_executivesourcecode)) != '' AND e_executivesourcecode != 36) Then 'V'  END +
case
when ltrim(rtrim(e_contactid)) != '' then e_contactid
when ltrim(rtrim(abinumber)) != ''  then abinumber
ELSE '000000000'
END  +
 '-'+
 case when (ltrim(rtrim(e_vendorid2)) = '00' OR e_vendorid2  = 36 ) then 'B' ELSE 'V' END  +
 ID  +
 '-'+
 case when ltrim(rtrim(e_vendorid2)) = '' then '0' else e_vendorid2 end
 business_Exec_ID ,
 id,
 e_executivesourcecode,
 abinumber,
 e_vendorid2,
e_firstname     ,
e_lastname      ,
phonenumber     ,
email   ,
orig_email,
'' m_address_mailing       ,
'' m_city_mailing  ,
'' m_state_mailing ,
'' m_zipcode_mailing       ,
'' m_zipfour_mailing       ,
'' address ,
'' city    ,
'' state   ,
'' zipcode ,
'' zipfour ,
'' m_address_landmark      ,
'' m_city_landmark ,
'' m_state_landmark        ,
'' m_zipcode_landmark      ,
'' m_zipfour_landmark      ,
'' e_homeaddress,
'' e_homecity,
'' e_homestate,
'' e_homezipcode,
'' e_homezip4,
fulfillmentflag,
dataset,
B0001	,
B0002	,
B0003	,
B0004	,
B0005	,
B0006	,
B0007	,
B0008	,
B0009	,
B0010	,
B0011	,
B0012	,
B0013	,
B0014	,
B0015	,
B0016	,
B0017	,
B0018	,
B0019	,
B0020	,
B0021	,
B0022	,
B0023	,
B0024	,
B0025	,
B0026	,
B0027	,
B0028	,
B0029	,
B0030	,
B0031	,
B0032	,
B0033	,
B0034	,
B0035	,
B0036	,
B0037	,
B0038	,
B0039	,
B0040	,
B0041	,
B0042	,
B0043	,
B0044	,
B0045	,
B0046	,
B0047	,
B0048	,
B0049	,
B0050	,
B0051	,
B0052	,
B0053	,
B0054	,
B0055	,
B0056	,
B0057	,
B0058	,
B0059	,
B0060	,
B0061	,
B0062	,
B0063	,
B0064	,
B0065	,
B0066	,
B0067	,
B0068	,
B0069	,
B0070	,
B0071	,
B0072	,
B0073	,
B0074	,
B0075	,
B0076	,
B0077	,
B0078	,
B0079	,
B0080	,
B0081	,
B0082	,
B0083	,
B0084	,
B0085	,
B0086	,
B0087	,
B0088	,
B0089	,
B0090	,
B0091	,
B0092	,
B0093	,
B0094	,
B0095	,
B0096	,
B0097	,
B0098	,
B0099	,
B0100	,
B0101	,
B0102	,
B0103	,
B0104	,
B0105	,
B0106	,
B0107	,
B0108	,
B0110	,
B0111	,
B0112	,
B0113	,
B0114	,
B0115	,
B0116	,
B0117	,
B0118	,
B0119	,
B0120	,
B0121	,
B0122	,
B0123	,
B0124	,
B0125	,
B0126	,
B0127	,
B0128	,
B0129	,
B0130	,
B0131	,
B0132	,
B0133	,
B0134	,
B0135	,
B0136	,
B0137	,
B0138	,
B0139	,
B0140	,
B0141	,
B0142	,
B0143	,
B0144	,
B0145	,
B0146	,
B0147	,
B0148	,
B0149	,
B0150	,
B0151	,
B0152	,
B0153	,
B0299	,
B0300	,
B0301	,
B0302	,
B0303	,
B0306	,
B0307	,
B0323	,
B0324	,
B0325	,
B0326	,
B0327	,
B0328	,
B0329	,
B0330	,
B0331	,
B0332	,
B0333	,
B0334	,
B0335	,
B0336	,
B0337	,
B0338	,
B0339	,
B0340	,
B0350	,
B0351	,
B0352	,
B0353	,
B0354	,
B0355	,
B0356	,
B0357	,
B0358	,
B0359	,
B0360	,
B0361	,
B0362	,
B0363	,
B0364	,
B0365	,
B0366	,
B0367	,
B0368	,
B0369	,
B0370	,
B0375	,
B0378	,
B0379	,
B0380	,
B0381	,
B0382	,
B0383	,
B0384	,
B0385	,
B0386	,
B0387	,
B0388	,
B0389	,
B0390	,
B0391	,
B0392	,
B0393	,
B0394	,
B0395	,
B0396	,
B0397	,
B0398	,
B0399	,
B0400	,
B0401	,
B0402	,
B0403	,
B0404	,
B0405	,
B0406	,
B0407	,
B0408	,
B0409	,
B0410	,
B0411	,
B0412	,
B0413	,
B0414	,
B0415	,
B0416	,
B0417	,
B0418	,
B0419	,
B0420	,
B0421	,
B0422	,
B0423	,
B0424	,
B0425	,
B0426	,
B0427	,
B0428	,
B0429	,
B0430	,
B0431	,
B0432	,
B0433	,
B0434	,
B0435	,
B0436	,
B0437	,
B0438	,
B0439	,
B0440	,
B0441	,
B0442	,
B0443	,
B0444	,
B0445	,
B0446	,
B0447	,
B0448	,
B0449	,
B0450	,
B0451	,
B0452	,
B0453	,
B0454	,
B0455	,
B0456	,
---
B0457   ,
B0458   ,
B0459   ,
B0460   ,
B0461   ,
B0462   ,
B0463   ,
B0464   ,
B0465   ,
B0466   ,
B0467   ,
B0468   ,
B0469   ,
B0470   ,
B0471   ,
B0472   ,
B0473   ,
B0474   ,
B0475   ,
B0476   ,
B0477   ,
B0478   ,
B0479   ,
B0480   ,
B0481   ,
B0482   ,
B0483   ,
B0484   ,
B0485   ,
B0486   ,
B0487   ,
B0488   ,
B0489   ,
B0490   ,
B0491   ,
B0492   ,
B0493   ,
B0494   ,
---
B0495	,
B0496	,
B0497	,
B0498	,
B0499	,
B0500	,
B0501	,
B0502	,
B0503	,
B0504	,
B0505	,
B0506	,
B0507	,
B0508	,
B0509	,
B0510	,
B0511	,
B0512	,
B0513	,
B0514	,
B0515	,
B0516	,
B0517	,
B0518	,
B0519	,
B0520	,
B0521	,
B0522	,
B0523	,
B0524	,
B0525	,
B0526	,
B0527	,
B0528	,
B0529	,
B0530	,
B0531	,
B0532	,
B0533	,
B0534	,
B0535	,
B0536	,
B0537	,
B0538	,
B0539	,
B0540	,
B0541	,
B0542	,
B0543	,
B0544	,
B0545	,
B0546	,
B0547	,
B0548	,
B0549	,
B0550	,
B0551	,
B0552	,
B0553	,
B0554	,
B0555	,
B0556	,
B0557	,
B0558	,
B0559	,
B0560	,
B0561	,
B0562	,
B0563	,
B0564	,
B0565	,
B0566	,
B0567	,
B0568	,
B0569	,
B0570	,
B0571	,
B0572	,
B0573	,
B0574	,
B0575	,
B0576	,
B0577	,
B0578	,
B0579	,
B0580	,
B0581	,
B0582	,
B0583	,
B0584	,
B0585	,
B0586	,
B0587	,
B0588	,
B0589	,
B0590	,
B0591
from digital.business_segments_aws
where   ( ( ltrim(rtrim(e_executivesourcecode)) = '' OR e_executivesourcecode = 36 )
AND ( ltrim(rtrim(e_vendorid2)) != '00' AND e_vendorid2 != 36  ) )
OR
 (( ltrim(rtrim(e_executivesourcecode)) != '' AND e_executivesourcecode != 36 )
AND ( ltrim(rtrim(e_vendorid2)) = '00' OR  e_vendorid2 = 36  ) );
---(4907115 row(s) affected)       ---QA (18657 row(s) affected)
---END Explode

drop table if exists digital.consumer_email_full_compressed;

create table digital.consumer_email_full_compressed as
select id, individualid, emailaddress, vendorid2, firstname, lastname , move_ind, familyid
   from digital.consumer_email_fullset;
---(1,135,306,298 row(s) affected)     ---QA (797114 row(s) affected)

drop table if exists digital.consumer_exec_matches_aws;

create table digital.consumer_exec_matches_aws as
select e.*
from digital.business_segments_aws e
   where
        e.e_individualid in(
		   select distinct e_individualid
                     from digital.business_exec_fullset
					  where e_individualid != '000000000000' and ltrim(rtrim(e_firstname)) >''
				     	 );
---(174090 rows affected)

drop table if exists digital.consumer_email_enhancements_aws;

create table digital.consumer_email_enhancements_aws as
select row_number() over (partition by 1)+37000004335361 row_id,
---select identity(bigint,37000004335361,1) row_id,
  em.vendorid2 em_vendorid,   em.id  em_id, em.individualid em_indiv_id, em.emailaddress em_emailaddress, em.firstname em_firstname, em.lastname em_lastname, e.*
from digital.consumer_exec_matches_aws e join
  (select c.id, c.individualid, c.emailaddress, c.firstname, c.lastname , c.VendorID2
    from digital.consumer_email_fullset c where  c.individualid in
	(select distinct e_individualid
                     from digital.business_exec_fullset
					  where e_individualid != '000000000000' and ltrim(rtrim(e_firstname)) >'' )
         ) em
on ( em.individualid = e.e_individualid)
order by em_vendorid;
---			     	 );
---(67,512,717 row(s) affected)    ---QA (560217 row(s) affected)   560217

drop table if exists digital.consumer_exec_family_matches_aws;

create table digital.consumer_exec_family_matches_aws as
select e.*
from   digital.business_segments_aws e
  where e.e_familyid in
     (select distinct e_familyid from digital.business_exec_fullset
      where e_familyid != '000000000000'
      and ( e_individualid != '' and  e_individualid != '000000000000')
        );
---(45,809,374 row(s) affected)      ---QA (175659 row(s) affected)

drop table if exists digital.consumer_email_family_enhancements_aws;

create table digital.consumer_email_family_enhancements_aws as
select row_number() over (partition by 1)+44000004335854 row_id, em.vendorid2 em_vendorid,  em.id em_id, em.familyid em_family_id, em.emailaddress em_emailaddress, e.*
---select identity(bigint,44000004335854,1) row_id, em.vendorid2 em_vendorid,  em.id em_id, em.familyid em_family_id, em.emailaddress em_emailaddress, e.*
from digital.consumer_exec_family_matches_aws e join
(
select e.id, e.familyid, e.emailaddress, e.vendorid2 , e.move_ind, e.firstname, e.lastname
from   digital.consumer_email_full_compressed e
  where
      e.familyid in(select distinct e_familyid from digital.business_exec_fullset
                where e_familyid != '000000000000' and ( e_individualid != '' and  e_individualid != '000000000000') )
   ) em

on ( em.familyid = e.e_familyid)
where 1 = 1
order by em_vendorid;
---(191,050,322 row(s) affected)     ---QA (1153591 row(s) affected)

insert into digital.business_segments_bb_vv_aws (
business_Exec_ID,
id,
e_executivesourcecode,
abinumber,
e_vendorid2,
e_firstname,
e_lastname,
phonenumber,
email,
orig_email,
m_address_mailing,
m_city_mailing,
m_state_mailing,
m_zipcode_mailing,
m_zipfour_mailing,
address,
city, state, zipcode, zipfour,
m_address_landmark, m_city_landmark, m_state_landmark, m_zipcode_landmark, m_zipfour_landmark,
e_homeaddress, e_homecity, e_homestate, e_homezipcode, e_homezip4,
fulfillmentflag,
dataset,
B0001, B0002, B0003, B0004, B0005, B0006, B0007, B0008, B0009, B0010, B0011, B0012, B0013, B0014, B0015, B0016, B0017, B0018, B0019, B0020, B0021, B0022, B0023, B0024, B0025, B0026, B0027, B0028, B0029, B0030, B0031, B0032, B0033, B0034, B0035, B0036, B0037, B0038, B0039, B0040, B0041, B0042, B0043, B0044, B0045, B0046, B0047, B0048, B0049, B0050, B0051, B0052, B0053, B0054, B0055, B0056, B0057, B0058, B0059, B0060, B0061, B0062, B0063, B0064, B0065, B0066, B0067, B0068, B0069, B0070, B0071, B0072, B0073, B0074, B0075, B0076, B0077, B0078, B0079, B0080, B0081, B0082, B0083, B0084, B0085, B0086, B0087, B0088, B0089, B0090, B0091, B0092, B0093, B0094, B0095, B0096, B0097, B0098, B0099, B0100, B0101, B0102, B0103, B0104, B0105, B0106, B0107, B0108, B0110, B0111, B0112, B0113, B0114, B0115, B0116, B0117, B0118, B0119, B0120, B0121, B0122, B0123, B0124, B0125, B0126, B0127, B0128, B0129, B0130, B0131, B0132, B0133, B0134, B0135, B0136, B0137, B0138, B0139, B0140, B0141, B0142, B0143, B0144, B0145, B0146, B0147, B0148, B0149, B0150, B0151, B0152, B0153, B0299, B0300, B0301, B0302, B0303, B0306, B0307, B0323, B0324, B0325, B0326, B0327, B0328, B0329, B0330, B0331, B0332, B0333, B0334, B0335, B0336, B0337, B0338, B0339, B0340, B0350, B0351, B0352, B0353, B0354, B0355, B0356, B0357, B0358, B0359, B0360, B0361, B0362, B0363, B0364, B0365, B0366, B0367, B0368, B0369, B0370, B0375, B0378, B0379, B0380, B0381, B0382, B0383, B0384, B0385, B0386, B0387, B0388, B0389, B0390, B0391, B0392, B0393, B0394, B0395, B0396, B0397, B0398, B0399, B0400, B0401, B0402, B0403, B0404, B0405, B0406, B0407, B0408, B0409, B0410, B0411, B0412, B0413, B0414, B0415, B0416, B0417, B0418, B0419, B0420, B0421, B0422, B0423, B0424, B0425, B0426, B0427, B0428, B0429, B0430, B0431, B0432, B0433, B0434, B0435, B0436, B0437, B0438, B0439, B0440, B0441, B0442, B0443, B0444, B0445, B0446, B0447, B0448, B0449, B0450, B0451, B0452, B0453, B0454, B0455, B0456,
---
B0457   ,
B0458   ,
B0459   ,
B0460   ,
B0461   ,
B0462   ,
B0463   ,
B0464   ,
B0465   ,
B0466   ,
B0467   ,
B0468   ,
B0469   ,
B0470   ,
B0471   ,
B0472   ,
B0473   ,
B0474   ,
B0475   ,
B0476   ,
B0477   ,
B0478   ,
B0479   ,
B0480   ,
B0481   ,
B0482   ,
B0483   ,
B0484   ,
B0485   ,
B0486   ,
B0487   ,
B0488   ,
B0489   ,
B0490   ,
B0491   ,
B0492   ,
B0493   ,
B0494   ,
---
B0495	,
B0496	,
B0497	,
B0498	,
B0499	,
B0500	,
B0501	,
B0502	,
B0503	,
B0504	,
B0505	,
B0506	,
B0507	,
B0508	,
B0509	,
B0510	,
B0511	,
B0512	,
B0513	,
B0514	,
B0515	,
B0516	,
B0517	,
B0518	,
B0519	,
B0520	,
B0521	,
B0522	,
B0523	,
B0524	,
B0525	,
B0526	,
B0527	,
B0528	,
B0529	,
B0530	,
B0531	,
B0532	,
B0533	,
B0534	,
B0535	,
B0536	,
B0537	,
B0538	,
B0539	,
B0540	,
B0541	,
B0542	,
B0543	,
B0544	,
B0545	,
B0546	,
B0547	,
B0548	,
B0549	,
B0550	,
B0551	,
B0552	,
B0553	,
B0554	,
B0555	,
B0556	,
B0557	,
B0558	,
B0559	,
B0560	,
B0561	,
B0562	,
B0563	,
B0564	,
B0565	,
B0566	,
B0567	,
B0568	,
B0569	,
B0570	,
B0571	,
B0572	,
B0573	,
B0574	,
B0575	,
B0576	,
B0577	,
B0578	,
B0579	,
B0580	,
B0581	,
B0582	,
B0583	,
B0584	,
B0585	,
B0586	,
B0587	,
B0588	,
B0589	,
B0590	,
B0591
)
select
--updated New_Id
--case
--when trim(e_contactid) != '' then e_contactid
--when trim(abinumber) != ''  then abinumber
--ELSE '000000000'
--END New_ID,
case when ltrim(rtrim(abinumber)) != '' AND (ltrim(rtrim(e_executivesourcecode)) = '' OR e_executivesourcecode = 36) then 'B'
when ltrim(rtrim(abinumber)) = '' OR ( ltrim(rtrim(e_executivesourcecode)) != '' AND e_executivesourcecode != 36) Then 'V'  END +
case
when ltrim(rtrim(e_contactid)) != '' then e_contactid
when ltrim(rtrim(abinumber)) != ''  then abinumber
ELSE '000000000'
END  +
 '-'+
 case when (ltrim(rtrim(em_vendorid)) = '00' OR em_vendorid  = 36 ) then 'B' ELSE 'V' END  +
 Right('00000000000000'+row_id ,14)  +
 '-'+
 case when ltrim(rtrim(em_vendorid)) = '' then '0' else em_vendorid end
 business_Exec_ID ,
 em_id  ,
 e_executivesourcecode,
 abinumber,
 em_vendorid,
e_firstname     ,
e_lastname      ,
phonenumber     ,
---case when ltrim(rtrim(em_emailaddress)) = '' then em_emailaddress else lower(substring(convert(varchar(max),HashBytes('MD5',lower(LTRIM(RTRIM(em_emailaddress)))),1),3,32)) end em_emailaddress,
case when ltrim(rtrim(em_emailaddress)) = '' then em_emailaddress else md5(lower(trim(em_emailaddress))) end em_emailaddress,
em_emailaddress,
'' m_address_mailing       ,
'' m_city_mailing  ,
'' m_state_mailing ,
'' m_zipcode_mailing       ,
'' m_zipfour_mailing       ,
'' address ,
'' city    ,
'' state   ,
'' zipcode ,
'' zipfour ,
'' m_address_landmark      ,
'' m_city_landmark ,
'' m_state_landmark        ,
'' m_zipcode_landmark      ,
'' m_zipfour_landmark      ,
'' e_homeaddress,
'' e_homecity,
'' e_homestate,
'' e_homezipcode,
'' e_homezip4,
'' fulfillmentflag,
'CONSUMER_EMAIL_INDIV' dataset,
B0001	,
B0002	,
B0003	,
B0004	,
B0005	,
B0006	,
B0007	,
B0008	,
B0009	,
B0010	,
B0011	,
B0012	,
B0013	,
B0014	,
B0015	,
B0016	,
B0017	,
B0018	,
B0019	,
B0020	,
B0021	,
B0022	,
B0023	,
B0024	,
B0025	,
B0026	,
B0027	,
B0028	,
B0029	,
B0030	,
B0031	,
B0032	,
B0033	,
B0034	,
B0035	,
B0036	,
B0037	,
B0038	,
B0039	,
B0040	,
B0041	,
B0042	,
B0043	,
B0044	,
B0045	,
B0046	,
B0047	,
B0048	,
B0049	,
B0050	,
B0051	,
B0052	,
B0053	,
B0054	,
B0055	,
B0056	,
B0057	,
B0058	,
B0059	,
B0060	,
B0061	,
B0062	,
B0063	,
B0064	,
B0065	,
B0066	,
B0067	,
B0068	,
B0069	,
B0070	,
B0071	,
B0072	,
B0073	,
B0074	,
B0075	,
B0076	,
B0077	,
B0078	,
B0079	,
B0080	,
B0081	,
B0082	,
B0083	,
B0084	,
B0085	,
B0086	,
B0087	,
B0088	,
B0089	,
B0090	,
B0091	,
B0092	,
B0093	,
B0094	,
B0095	,
B0096	,
B0097	,
B0098	,
B0099	,
B0100	,
B0101	,
B0102	,
B0103	,
B0104	,
B0105	,
B0106	,
B0107	,
B0108	,
B0110	,
B0111	,
B0112	,
B0113	,
B0114	,
B0115	,
B0116	,
B0117	,
B0118	,
B0119	,
B0120	,
B0121	,
B0122	,
B0123	,
B0124	,
B0125	,
B0126	,
B0127	,
B0128	,
B0129	,
B0130	,
B0131	,
B0132	,
B0133	,
B0134	,
B0135	,
B0136	,
B0137	,
B0138	,
B0139	,
B0140	,
B0141	,
B0142	,
B0143	,
B0144	,
B0145	,
B0146	,
B0147	,
B0148	,
B0149	,
B0150	,
B0151	,
B0152	,
B0153	,
B0299	,
B0300	,
B0301	,
B0302	,
B0303	,
B0306	,
B0307	,
B0323	,
B0324	,
B0325	,
B0326	,
B0327	,
B0328	,
B0329	,
B0330	,
B0331	,
B0332	,
B0333	,
B0334	,
B0335	,
B0336	,
B0337	,
B0338	,
B0339	,
B0340	,
B0350	,
B0351	,
B0352	,
B0353	,
B0354	,
B0355	,
B0356	,
B0357	,
B0358	,
B0359	,
B0360	,
B0361	,
B0362	,
B0363	,
B0364	,
B0365	,
B0366	,
B0367	,
B0368	,
B0369	,
B0370	,
B0375	,
B0378	,
B0379	,
B0380	,
B0381	,
B0382	,
B0383	,
B0384	,
B0385	,
B0386	,
B0387	,
B0388	,
B0389	,
B0390	,
B0391	,
B0392	,
B0393	,
B0394	,
B0395	,
B0396	,
B0397	,
B0398	,
B0399	,
B0400	,
B0401	,
B0402	,
B0403	,
B0404	,
B0405	,
B0406	,
B0407	,
B0408	,
B0409	,
B0410	,
B0411	,
B0412	,
B0413	,
B0414	,
B0415	,
B0416	,
B0417	,
B0418	,
B0419	,
B0420	,
B0421	,
B0422	,
B0423	,
B0424	,
B0425	,
B0426	,
B0427	,
B0428	,
B0429	,
B0430	,
B0431	,
B0432	,
B0433	,
B0434	,
B0435	,
B0436	,
B0437	,
B0438	,
B0439	,
B0440	,
B0441	,
B0442	,
B0443	,
B0444	,
B0445	,
B0446	,
B0447	,
B0448	,
B0449	,
B0450	,
B0451	,
B0452	,
B0453	,
B0454	,
B0455	,
B0456   ,
---
B0457   ,
B0458   ,
B0459   ,
B0460   ,
B0461   ,
B0462   ,
B0463   ,
B0464   ,
B0465   ,
B0466   ,
B0467   ,
B0468   ,
B0469   ,
B0470   ,
B0471   ,
B0472   ,
B0473   ,
B0474   ,
B0475   ,
B0476   ,
B0477   ,
B0478   ,
B0479   ,
B0480   ,
B0481   ,
B0482   ,
B0483   ,
B0484   ,
B0485   ,
B0486   ,
B0487   ,
B0488   ,
B0489   ,
B0490   ,
B0491   ,
B0492   ,
B0493   ,
B0494   ,
---
B0495	,
B0496	,
B0497	,
B0498	,
B0499	,
B0500	,
B0501	,
B0502	,
B0503	,
B0504	,
B0505	,
B0506	,
B0507	,
B0508	,
B0509	,
B0510	,
B0511	,
B0512	,
B0513	,
B0514	,
B0515	,
B0516	,
B0517	,
B0518	,
B0519	,
B0520	,
B0521	,
B0522	,
B0523	,
B0524	,
B0525	,
B0526	,
B0527	,
B0528	,
B0529	,
B0530	,
B0531	,
B0532	,
B0533	,
B0534	,
B0535	,
B0536	,
B0537	,
B0538	,
B0539	,
B0540	,
B0541	,
B0542	,
B0543	,
B0544	,
B0545	,
B0546	,
B0547	,
B0548	,
B0549	,
B0550	,
B0551	,
B0552	,
B0553	,
B0554	,
B0555	,
B0556	,
B0557	,
B0558	,
B0559	,
B0560	,
B0561	,
B0562	,
B0563	,
B0564	,
B0565	,
B0566	,
B0567	,
B0568	,
B0569	,
B0570	,
B0571	,
B0572	,
B0573	,
B0574	,
B0575	,
B0576	,
B0577	,
B0578	,
B0579	,
B0580	,
B0581	,
B0582	,
B0583	,
B0584	,
B0585	,
B0586	,
B0587	,
B0588	,
B0589	,
B0590	,
B0591
from digital.consumer_email_enhancements_aws;
---(67512717 row(s) affected)   02:40:08      ---QA (560217 row(s) affected)


insert into digital.business_segments_bb_vv_aws  (
business_Exec_ID,
id,
e_executivesourcecode,
abinumber,
e_vendorid2,
e_firstname,
e_lastname,
phonenumber,
email,
orig_email,
m_address_mailing,
m_city_mailing,
m_state_mailing,
m_zipcode_mailing,
m_zipfour_mailing,
address,
city, state, zipcode, zipfour,
m_address_landmark, m_city_landmark, m_state_landmark, m_zipcode_landmark, m_zipfour_landmark,
e_homeaddress, e_homecity, e_homestate, e_homezipcode, e_homezip4,
fulfillmentflag,
dataset,
B0001, B0002, B0003, B0004, B0005, B0006, B0007, B0008, B0009, B0010, B0011, B0012, B0013, B0014, B0015, B0016, B0017, B0018, B0019, B0020, B0021, B0022, B0023, B0024, B0025, B0026, B0027, B0028, B0029, B0030, B0031, B0032, B0033, B0034, B0035, B0036, B0037, B0038, B0039, B0040, B0041, B0042, B0043, B0044, B0045, B0046, B0047, B0048, B0049, B0050, B0051, B0052, B0053, B0054, B0055, B0056, B0057, B0058, B0059, B0060, B0061, B0062, B0063, B0064, B0065, B0066, B0067, B0068, B0069, B0070, B0071, B0072, B0073, B0074, B0075, B0076, B0077, B0078, B0079, B0080, B0081, B0082, B0083, B0084, B0085, B0086, B0087, B0088, B0089, B0090, B0091, B0092, B0093, B0094, B0095, B0096, B0097, B0098, B0099, B0100, B0101, B0102, B0103, B0104, B0105, B0106, B0107, B0108, B0110, B0111, B0112, B0113, B0114, B0115, B0116, B0117, B0118, B0119, B0120, B0121, B0122, B0123, B0124, B0125, B0126, B0127, B0128, B0129, B0130, B0131, B0132, B0133, B0134, B0135, B0136, B0137, B0138, B0139, B0140, B0141, B0142, B0143, B0144, B0145, B0146, B0147, B0148, B0149, B0150, B0151, B0152, B0153, B0299, B0300, B0301, B0302, B0303, B0306, B0307, B0323, B0324, B0325, B0326, B0327, B0328, B0329, B0330, B0331, B0332, B0333, B0334, B0335, B0336, B0337, B0338, B0339, B0340, B0350, B0351, B0352, B0353, B0354, B0355, B0356, B0357, B0358, B0359, B0360, B0361, B0362, B0363, B0364, B0365, B0366, B0367, B0368, B0369, B0370, B0375, B0378, B0379, B0380, B0381, B0382, B0383, B0384, B0385, B0386, B0387, B0388, B0389, B0390, B0391, B0392, B0393, B0394, B0395, B0396, B0397, B0398, B0399, B0400, B0401, B0402, B0403, B0404, B0405, B0406, B0407, B0408, B0409, B0410, B0411, B0412, B0413, B0414, B0415, B0416, B0417, B0418, B0419, B0420, B0421, B0422, B0423, B0424, B0425, B0426, B0427, B0428, B0429, B0430, B0431, B0432, B0433, B0434, B0435, B0436, B0437, B0438, B0439, B0440, B0441, B0442, B0443, B0444, B0445, B0446, B0447, B0448, B0449, B0450, B0451, B0452, B0453, B0454, B0455, B0456,
---
B0457   ,
B0458   ,
B0459   ,
B0460   ,
B0461   ,
B0462   ,
B0463   ,
B0464   ,
B0465   ,
B0466   ,
B0467   ,
B0468   ,
B0469   ,
B0470   ,
B0471   ,
B0472   ,
B0473   ,
B0474   ,
B0475   ,
B0476   ,
B0477   ,
B0478   ,
B0479   ,
B0480   ,
B0481   ,
B0482   ,
B0483   ,
B0484   ,
B0485   ,
B0486   ,
B0487   ,
B0488   ,
B0489   ,
B0490   ,
B0491   ,
B0492   ,
B0493   ,
B0494   ,
---
B0495	,
B0496	,
B0497	,
B0498	,
B0499	,
B0500	,
B0501	,
B0502	,
B0503	,
B0504	,
B0505	,
B0506	,
B0507	,
B0508	,
B0509	,
B0510	,
B0511	,
B0512	,
B0513	,
B0514	,
B0515	,
B0516	,
B0517	,
B0518	,
B0519	,
B0520	,
B0521	,
B0522	,
B0523	,
B0524	,
B0525	,
B0526	,
B0527	,
B0528	,
B0529	,
B0530	,
B0531	,
B0532	,
B0533	,
B0534	,
B0535	,
B0536	,
B0537	,
B0538	,
B0539	,
B0540	,
B0541	,
B0542	,
B0543	,
B0544	,
B0545	,
B0546	,
B0547	,
B0548	,
B0549	,
B0550	,
B0551	,
B0552	,
B0553	,
B0554	,
B0555	,
B0556	,
B0557	,
B0558	,
B0559	,
B0560	,
B0561	,
B0562	,
B0563	,
B0564	,
B0565	,
B0566	,
B0567	,
B0568	,
B0569	,
B0570	,
B0571	,
B0572	,
B0573	,
B0574	,
B0575	,
B0576	,
B0577	,
B0578	,
B0579	,
B0580	,
B0581	,
B0582	,
B0583	,
B0584	,
B0585	,
B0586	,
B0587	,
B0588	,
B0589	,
B0590	,
B0591
)
select
--updated New_Id
--case
--when trim(e_contactid) != '' then e_contactid
--when trim(abinumber) != ''  then abinumber
--ELSE '000000000'
--END New_ID,
 case when ltrim(rtrim(abinumber)) != '' AND (ltrim(rtrim(e_executivesourcecode)) = '' OR e_executivesourcecode = 36) then 'B'
when ltrim(rtrim(abinumber)) = '' OR ( ltrim(rtrim(e_executivesourcecode)) != '' AND e_executivesourcecode != 36) Then 'V'  END +
case
when ltrim(rtrim(e_contactid)) != '' then e_contactid
when ltrim(rtrim(abinumber)) != ''  then abinumber
ELSE '000000000'
END  +
 '-'+
 case when (ltrim(rtrim(em_vendorid)) = '00' OR em_vendorid  = 36 ) then 'B' ELSE 'V' END  +
 Right('00000000000000'+row_id ,14)  +
 '-'+
 case when ltrim(rtrim(em_vendorid)) = '' then '0' else em_vendorid end
 business_Exec_ID ,
 em_id ,
 e_executivesourcecode,
 abinumber,
 em_vendorid,
e_firstname     ,
e_lastname      ,
phonenumber     ,
---case when ltrim(rtrim(em_emailaddress)) = '' then em_emailaddress else lower(substring(convert(varchar(max),HashBytes('MD5',lower(LTRIM(RTRIM(em_emailaddress)))),1),3,32)) end em_emailaddress,
case when ltrim(rtrim(em_emailaddress)) = '' then em_emailaddress else md5(lower(trim(em_emailaddress))) end em_emailaddress,
em_emailaddress,
'' m_address_mailing       ,
'' m_city_mailing  ,
'' m_state_mailing ,
'' m_zipcode_mailing       ,
'' m_zipfour_mailing       ,
'' address ,
'' city    ,
'' state   ,
'' zipcode ,
'' zipfour ,
'' m_address_landmark      ,
'' m_city_landmark ,
'' m_state_landmark        ,
'' m_zipcode_landmark      ,
'' m_zipfour_landmark      ,
'' e_homeaddress,
'' e_homecity,
'' e_homestate,
'' e_homezipcode,
'' e_homezip4,
'' fulfillmentflag,
'CONSUMER_EMAIL_FAMILY' dataset,
B0001	,
B0002	,
B0003	,
B0004	,
B0005	,
B0006	,
B0007	,
B0008	,
B0009	,
B0010	,
B0011	,
B0012	,
B0013	,
B0014	,
B0015	,
B0016	,
B0017	,
B0018	,
B0019	,
B0020	,
B0021	,
B0022	,
B0023	,
B0024	,
B0025	,
B0026	,
B0027	,
B0028	,
B0029	,
B0030	,
B0031	,
B0032	,
B0033	,
B0034	,
B0035	,
B0036	,
B0037	,
B0038	,
B0039	,
B0040	,
B0041	,
B0042	,
B0043	,
B0044	,
B0045	,
B0046	,
B0047	,
B0048	,
B0049	,
B0050	,
B0051	,
B0052	,
B0053	,
B0054	,
B0055	,
B0056	,
B0057	,
B0058	,
B0059	,
B0060	,
B0061	,
B0062	,
B0063	,
B0064	,
B0065	,
B0066	,
B0067	,
B0068	,
B0069	,
B0070	,
B0071	,
B0072	,
B0073	,
B0074	,
B0075	,
B0076	,
B0077	,
B0078	,
B0079	,
B0080	,
B0081	,
B0082	,
B0083	,
B0084	,
B0085	,
B0086	,
B0087	,
B0088	,
B0089	,
B0090	,
B0091	,
B0092	,
B0093	,
B0094	,
B0095	,
B0096	,
B0097	,
B0098	,
B0099	,
B0100	,
B0101	,
B0102	,
B0103	,
B0104	,
B0105	,
B0106	,
B0107	,
B0108	,
B0110	,
B0111	,
B0112	,
B0113	,
B0114	,
B0115	,
B0116	,
B0117	,
B0118	,
B0119	,
B0120	,
B0121	,
B0122	,
B0123	,
B0124	,
B0125	,
B0126	,
B0127	,
B0128	,
B0129	,
B0130	,
B0131	,
B0132	,
B0133	,
B0134	,
B0135	,
B0136	,
B0137	,
B0138	,
B0139	,
B0140	,
B0141	,
B0142	,
B0143	,
B0144	,
B0145	,
B0146	,
B0147	,
B0148	,
B0149	,
B0150	,
B0151	,
B0152	,
B0153	,
B0299	,
B0300	,
B0301	,
B0302	,
B0303	,
B0306	,
B0307	,
B0323	,
B0324	,
B0325	,
B0326	,
B0327	,
B0328	,
B0329	,
B0330	,
B0331	,
B0332	,
B0333	,
B0334	,
B0335	,
B0336	,
B0337	,
B0338	,
B0339	,
B0340	,
B0350	,
B0351	,
B0352	,
B0353	,
B0354	,
B0355	,
B0356	,
B0357	,
B0358	,
B0359	,
B0360	,
B0361	,
B0362	,
B0363	,
B0364	,
B0365	,
B0366	,
B0367	,
B0368	,
B0369	,
B0370	,
B0375	,
B0378	,
B0379	,
B0380	,
B0381	,
B0382	,
B0383	,
B0384	,
B0385	,
B0386	,
B0387	,
B0388	,
B0389	,
B0390	,
B0391	,
B0392	,
B0393	,
B0394	,
B0395	,
B0396	,
B0397	,
B0398	,
B0399	,
B0400	,
B0401	,
B0402	,
B0403	,
B0404	,
B0405	,
B0406	,
B0407	,
B0408	,
B0409	,
B0410	,
B0411	,
B0412	,
B0413	,
B0414	,
B0415	,
B0416	,
B0417	,
B0418	,
B0419	,
B0420	,
B0421	,
B0422	,
B0423	,
B0424	,
B0425	,
B0426	,
B0427	,
B0428	,
B0429	,
B0430	,
B0431	,
B0432	,
B0433	,
B0434	,
B0435	,
B0436	,
B0437	,
B0438	,
B0439	,
B0440	,
B0441	,
B0442	,
B0443	,
B0444	,
B0445	,
B0446	,
B0447	,
B0448	,
B0449	,
B0450	,
B0451	,
B0452	,
B0453	,
B0454	,
B0455	,
B0456   ,
---
B0457   ,
B0458   ,
B0459   ,
B0460   ,
B0461   ,
B0462   ,
B0463   ,
B0464   ,
B0465   ,
B0466   ,
B0467   ,
B0468   ,
B0469   ,
B0470   ,
B0471   ,
B0472   ,
B0473   ,
B0474   ,
B0475   ,
B0476   ,
B0477   ,
B0478   ,
B0479   ,
B0480   ,
B0481   ,
B0482   ,
B0483   ,
B0484   ,
B0485   ,
B0486   ,
B0487   ,
B0488   ,
B0489   ,
B0490   ,
B0491   ,
B0492   ,
B0493   ,
B0494   ,
---
B0495	,
B0496	,
B0497	,
B0498	,
B0499	,
B0500	,
B0501	,
B0502	,
B0503	,
B0504	,
B0505	,
B0506	,
B0507	,
B0508	,
B0509	,
B0510	,
B0511	,
B0512	,
B0513	,
B0514	,
B0515	,
B0516	,
B0517	,
B0518	,
B0519	,
B0520	,
B0521	,
B0522	,
B0523	,
B0524	,
B0525	,
B0526	,
B0527	,
B0528	,
B0529	,
B0530	,
B0531	,
B0532	,
B0533	,
B0534	,
B0535	,
B0536	,
B0537	,
B0538	,
B0539	,
B0540	,
B0541	,
B0542	,
B0543	,
B0544	,
B0545	,
B0546	,
B0547	,
B0548	,
B0549	,
B0550	,
B0551	,
B0552	,
B0553	,
B0554	,
B0555	,
B0556	,
B0557	,
B0558	,
B0559	,
B0560	,
B0561	,
B0562	,
B0563	,
B0564	,
B0565	,
B0566	,
B0567	,
B0568	,
B0569	,
B0570	,
B0571	,
B0572	,
B0573	,
B0574	,
B0575	,
B0576	,
B0577	,
B0578	,
B0579	,
B0580	,
B0581	,
B0582	,
B0583	,
B0584	,
B0585	,
B0586	,
B0587	,
B0588	,
B0589	,
B0590	,
B0591
from digital.consumer_email_family_enhancements_aws e;
---(191,050,322 row(s) affected) 01:06:00       ---QA (1153591 row(s) affected)

select dataset,count(*) from digital.business_segments_bb_vv_aws group by dataset order by dataset;











