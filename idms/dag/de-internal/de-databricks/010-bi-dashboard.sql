/*Product group lookup table as 2021/01/18*/
DROP TABLE IF EXISTS reports.product_group_lookup;

CREATE TABLE reports.product_group_lookup AS
        SELECT DISTINCT
            inventory_item_id,
            CASE
                WHEN inventory_item_id IN (
                    '15615',
                    '15617'
                ) THEN
                    'API Solutions'
                WHEN inventory_item_id IN (
                    '14079',
                    '14077'
                ) THEN
                    'AS400'
                WHEN inventory_item_id IN (
                    '13223',
                    '20485',
                    '10623',
                    '41185',
                    '42429',
                    '5749',
                    '45875',
                    '30393',
                    '40519',
                    '119568',
                    '39917',
                    '13339',
                    '30397',
                    '42463',
                    '127328',
                    '8667',
                    '9171',
                    '5755',
                    '14179',
                    '88572',
                    '24869',
                    '41889',
                    '134420',
                    '125616',
                    '8075',
                    '129432',
                    '24871',
                    '42431',
                    '5751',
                    '45876',
                    '9043',
                    '41891',
                    '8071',
                    '127329',
                    '129431',
                    '42459',
                    '42461',
                    '142431',
                    '5688',
                    '5711'
                ) THEN
                    'Core DaaP'
                WHEN inventory_item_id IN (
                    '42251',
                    '41879',
                    '45884',
                    '41205',
                    '45879',
                    '140429',
                    '142432',
                    '43988',
                    '45881',
                    '41211',
                    '42249',
                    '144429',
                    '148429'
                ) THEN
                    'Credit Solutions'
                WHEN inventory_item_id IN (
                    '147429',
                    '147430'
                ) THEN
                    'Data Axle for Salesforce'
                WHEN inventory_item_id IN (
                    '119571',
                    '115569',
                    '13023',
                    '127238',
                    '139429',
                    '127239',
                    '125630',
                    '20091',
                    '20093',
                    '15479',
                    '40799',
                    '35775',
                    '38089',
                    '7899',
                    '8769',
                    '143429',
                    '9101',
                    '12093',
                    '7889',
                    '127428',
                    '6101',
                    '8337',
                    '9107',
                    '7865',
                    '13229',
                    '40609',
                    '14133',
                    '7847',
                    '7921',
                    '7797',
                    '8923',
                    '7725',
                    '8241',
                    '117568',
                    '127424',
                    '8699',
                    '41221',
                    '127425',
                    '46011',
                    '13057',
                    '127421',
                    '13093',
                    '127422',
                    '127312',
                    '127313',
                    '127314',
                    '127315',
                    '127310',
                    '127311',
                    '127308',
                    '127309',
                    '7773',
                    '40681',
                    '13349',
                    '13351',
                    '127419',
                    '127420',
                    '72568',
                    '125628',
                    '7883',
                    '13181',
                    '13183'
                ) THEN
                    'Data Processing'
                WHEN inventory_item_id IN (
                    '125618',
                    '125624',
                    '125619',
                    '125625',
                    '125620',
                    '125623',
                    '137425',
                    '137423'
                ) THEN
                    'Direct Mail'
                WHEN inventory_item_id IN (
                    '43288',
                    '45874',
                    '45748',
                    '33597',
                    '33607',
                    '33623',
                    '33617',
                    '33541',
                    '42972',
                    '103568',
                    '6927',
                    '45316',
                    '45280',
                    '45321',
                    '97569',
                    '45749',
                    '41223',
                    '41743',
                    '41759',
                    '46026',
                    '46018',
                    '45137',
                    '45134',
                    '41751',
                    '46149',
                    '46019',
                    '46027',
                    '37487',
                    '34705',
                    '27789',
                    '34713',
                    '68570',
                    '23696',
                    '23697',
                    '23622',
                    '27369',
                    '34707',
                    '23594',
                    '23595',
                    '42621',
                    '23624',
                    '27909',
                    '23667',
                    '38389',
                    '38391',
                    '38393',
                    '27919',
                    '27937',
                    '27939',
                    '27941',
                    '27921',
                    '27923',
                    '27925',
                    '27927',
                    '27929',
                    '27931',
                    '27933',
                    '27935',
                    '23659',
                    '27907',
                    '38369',
                    '38371',
                    '38373',
                    '27911',
                    '27913',
                    '27915',
                    '27917',
                    '28609',
                    '28611',
                    '28613',
                    '23652',
                    '45296',
                    '23702',
                    '23700',
                    '23705',
                    '23701',
                    '23703',
                    '127408',
                    '127409',
                    '23699',
                    '23630',
                    '23629',
                    '34715',
                    '68571',
                    '23706',
                    '34461',
                    '42623',
                    '33759',
                    '37275',
                    '33761',
                    '43457',
                    '43657',
                    '43539',
                    '34473',
                    '43494',
                    '43499',
                    '43662',
                    '90568',
                    '43616',
                    '43368',
                    '43688',
                    '43479',
                    '43371',
                    '43397',
                    '43732',
                    '43418',
                    '42627',
                    '33763',
                    '42629',
                    '33765',
                    '43540',
                    '43658',
                    '43458',
                    '34477',
                    '43459',
                    '43513',
                    '43500',
                    '43514',
                    '43726',
                    '43515',
                    '42633',
                    '43522',
                    '43727',
                    '43592',
                    '43593',
                    '43496',
                    '43585',
                    '43619',
                    '43372',
                    '43480',
                    '43472',
                    '43419',
                    '43398',
                    '43399',
                    '43700',
                    '34475',
                    '43621',
                    '43620',
                    '43420',
                    '43709',
                    '43541',
                    '43728',
                    '42553',
                    '46151',
                    '43461',
                    '43473',
                    '43689',
                    '43737',
                    '43542',
                    '43715',
                    '43701',
                    '42663',
                    '33791',
                    '43422',
                    '43608',
                    '42639',
                    '33773',
                    '43690',
                    '43462',
                    '43586',
                    '42641',
                    '37309',
                    '33775',
                    '43659',
                    '43400',
                    '43423',
                    '43474',
                    '42643',
                    '33777',
                    '43424',
                    '43374',
                    '43416',
                    '33793',
                    '43545',
                    '42741',
                    '42711',
                    '42725',
                    '43663',
                    '43481',
                    '43622',
                    '43401',
                    '43594',
                    '43595',
                    '43660',
                    '43482',
                    '43369',
                    '43546',
                    '43380',
                    '43691',
                    '33781',
                    '43510',
                    '43425',
                    '43426',
                    '43428',
                    '43429',
                    '43463',
                    '43547',
                    '33783',
                    '43381',
                    '42661',
                    '37349',
                    '43439',
                    '43498',
                    '43733',
                    '43549',
                    '43550',
                    '43692',
                    '43693',
                    '43664',
                    '43402',
                    '42657',
                    '33785',
                    '43665',
                    '43551',
                    '43694',
                    '43430',
                    '43495',
                    '43596',
                    '43597',
                    '43392',
                    '43738',
                    '43376',
                    '43486',
                    '42659',
                    '33787',
                    '43487',
                    '42665',
                    '33795',
                    '42667',
                    '37361',
                    '33797',
                    '43471',
                    '43470',
                    '43533',
                    '43431',
                    '43552',
                    '43625',
                    '43702',
                    '43527',
                    '37365',
                    '42669',
                    '33799',
                    '43587',
                    '42671',
                    '33801',
                    '43432',
                    '43703',
                    '43626',
                    '43433',
                    '43704',
                    '43534',
                    '43588',
                    '43483',
                    '43435',
                    '43393',
                    '43666',
                    '43610',
                    '43613',
                    '43614',
                    '43667',
                    '43517',
                    '43491',
                    '42631',
                    '42673',
                    '33803',
                    '43717',
                    '43464',
                    '43734',
                    '42675',
                    '33805',
                    '43403',
                    '43589',
                    '43627',
                    '34469',
                    '33517',
                    '42677',
                    '33807',
                    '42679',
                    '33809',
                    '43628',
                    '43404',
                    '43436',
                    '33811',
                    '42637',
                    '42649',
                    '43598',
                    '43405',
                    '43523',
                    '43406',
                    '37469',
                    '42685',
                    '33813',
                    '43536',
                    '42687',
                    '33815',
                    '42689',
                    '33817',
                    '43377',
                    '43475',
                    '43599',
                    '42691',
                    '33819',
                    '43394',
                    '43378',
                    '43600',
                    '43695',
                    '43655',
                    '33769',
                    '33837',
                    '33839',
                    '33859',
                    '43437',
                    '43590',
                    '43705',
                    '43634',
                    '42693',
                    '33821',
                    '33823',
                    '43555',
                    '43407',
                    '33825',
                    '42697',
                    '43408',
                    '33827',
                    '43409',
                    '33829',
                    '42703',
                    '33833',
                    '43676',
                    '43635',
                    '43718',
                    '42755',
                    '42713',
                    '42647',
                    '43497',
                    '42737',
                    '37521',
                    '42653',
                    '43518',
                    '42699',
                    '42705',
                    '37499',
                    '42715',
                    '43411',
                    '43410',
                    '42707',
                    '43706',
                    '43438',
                    '43601',
                    '43711',
                    '33841',
                    '42719',
                    '33843',
                    '43639',
                    '34465',
                    '43640',
                    '43696',
                    '33845',
                    '43735',
                    '43492',
                    '43493',
                    '43442',
                    '43739',
                    '43602',
                    '33847',
                    '43443',
                    '43476',
                    '43719',
                    '43641',
                    '43444',
                    '43524',
                    '43519',
                    '43591',
                    '43642',
                    '43445',
                    '43412',
                    '34467',
                    '43643',
                    '43556',
                    '43669',
                    '43395',
                    '43615',
                    '33849',
                    '42727',
                    '43721',
                    '43484',
                    '43558',
                    '43722',
                    '43697',
                    '43477',
                    '43570',
                    '43644',
                    '43465',
                    '43611',
                    '43520',
                    '43729',
                    '43654',
                    '33771',
                    '33851',
                    '33853',
                    '43525',
                    '43661',
                    '43488',
                    '42635',
                    '43446',
                    '43447',
                    '43648',
                    '34471',
                    '43466',
                    '43649',
                    '43670',
                    '42681',
                    '43573',
                    '42729',
                    '42731',
                    '37515',
                    '42739',
                    '37523',
                    '33861',
                    '42651',
                    '42655',
                    '42701',
                    '42717',
                    '37501',
                    '43574',
                    '43714',
                    '43698',
                    '43528',
                    '43529',
                    '43427',
                    '43450',
                    '43449',
                    '43413',
                    '43650',
                    '43451',
                    '43651',
                    '43699',
                    '43603',
                    '43452',
                    '43453',
                    '43454',
                    '42733',
                    '33855',
                    '43485',
                    '43489',
                    '43414',
                    '43604',
                    '43652',
                    '43379',
                    '43605',
                    '43606',
                    '33835',
                    '42743',
                    '33863',
                    '43653',
                    '33865',
                    '43455',
                    '43538',
                    '42747',
                    '43720',
                    '33867',
                    '33871',
                    '43511',
                    '42645',
                    '42749',
                    '33869',
                    '43575',
                    '43415',
                    '43521',
                    '43469',
                    '42683',
                    '43456',
                    '42735',
                    '37519',
                    '42751',
                    '42709',
                    '42723',
                    '37507',
                    '43740',
                    '43490',
                    '43672',
                    '43673',
                    '43417',
                    '43576',
                    '43584',
                    '37535',
                    '42753',
                    '33873',
                    '42757',
                    '33875',
                    '43731',
                    '43674',
                    '43391',
                    '43310',
                    '43317',
                    '43318',
                    '43563',
                    '43321',
                    '43313',
                    '43345',
                    '43325',
                    '43323',
                    '43328',
                    '43330',
                    '43333',
                    '43336',
                    '43630',
                    '43800',
                    '43344',
                    '43341',
                    '43342',
                    '43338',
                    '43315',
                    '43319',
                    '43348',
                    '43349',
                    '43350',
                    '43560',
                    '43314',
                    '43320',
                    '43562',
                    '43346',
                    '43566',
                    '43564',
                    '43569'
                ) THEN
                    'Directories'
                WHEN inventory_item_id IN (
                    '38133',
                    '9087',
                    '136420',
                    '141429',
                    '46015',
                    '46010',
                    '46000',
                    '46002',
                    '46001',
                    '42557',
                    '45854',
                    '84568',
                    '127268',
                    '84569',
                    '41771',
                    '46009',
                    '46008',
                    '46007',
                    '45855',
                    '127319',
                    '43048',
                    '45852',
                    '45848',
                    '45853',
                    '46003',
                    '46004',
                    '73570',
                    '46013',
                    '141430',
                    '46006',
                    '45851',
                    '128420',
                    '79569',
                    '79570',
                    '79571',
                    '43072',
                    '79568',
                    '146429',
                    '38309',
                    '31985',
                    '108568',
                    '129430',
                    '127378',
                    '129429',
                    '127318'
                ) THEN
                    'Genie'
                WHEN inventory_item_id IN (
                    '116568',
                    '116572',
                    '142429',
                    '142430'
                ) THEN
                    'Inboxable'
                WHEN inventory_item_id IN (
                    '127258',
                    '46288'
                ) THEN
                    'Local Listings Application'
                WHEN inventory_item_id IN (
                    '150429',
                    '150430'
                ) THEN
                    'Local Results'
                WHEN inventory_item_id IN (
                    '129423',
                    '129425',
                    '129421',
                    '129424',
                    '129426',
                    '29571',
                    '36023',
                    '74568',
                    '36015',
                    '35995',
                    '36017',
                    '35999',
                    '36001',
                    '36007',
                    '36005',
                    '129428'
                ) THEN
                    'Marketzone'
                WHEN inventory_item_id IN (
                    '80569',
                    '80570',
                    '127248',
                    '127298',
                    '127278',
                    '80568',
                    '80577',
                    '80573',
                    '127279',
                    '83569',
                    '127280',
                    '80575',
                    '80571',
                    '80572',
                    '83568',
                    '85568'
                ) THEN
                    'Reference Solutions'
                WHEN inventory_item_id IN (
                    '119574',
                    '127348',
                    '8599',
                    '43970',
                    '43980',
                    '151430',
                    '116574',
                    '133447',
                    '137426',
                    '137424',
                    '137428',
                    '132420',
                    '116575',
                    '135420',
                    '125608',
                    '125610',
                    '72574',
                    '72573',
                    '125612',
                    '125614',
                    '125615',
                    '131420',
                    '72570',
                    '125613',
                    '137429',
                    '114568',
                    '43968',
                    '43976',
                    '115568',
                    '127388',
                    '65570',
                    '137422',
                    '65569',
                    '65568',
                    '64569',
                    '116570',
                    '116571',
                    '132421',
                    '116573',
                    '8919'
                ) THEN
                    'Service'
                ELSE
                    'Others'
            END product_group,
            case when inventory_item_id in (
                    8071,
                    8075,
                    10623,
                    24869,
                    24871,
                    30393,
                    41889,
                    42459,
                    42461,
                    44754,
                    125608,
                    125610,
                    125616,
                    125618,
                    125619,
                    127328,
                    127329,
                    142431)
                     then ('Y') else ('N') end usa_inventory_item_flg
        FROM
            interna.ebsprod_gaap_detail;
            

/*Division and BU lookup as of 2021/01/18*/
DROP TABLE if exists reports.division_group_lookup;
CREATE TABLE reports.division_group_lookup 
    AS
        SELECT DISTINCT
            segment2,
            CASE
                WHEN segment2 IN (
                    '001000',
                    '002000',
                    '028000',
                    '059000',
                    '068000',
                    '070000',
                    '071000',
                    '073000',
                    '075000',
                    '093000',
                    '095000',
                    '360000',
                    '730000',
                    '950050'
                ) THEN
                    'Data Axle USA'
                WHEN segment2 IN (
                    '287000'
                ) THEN
                    'Data Axle USA (CAD)'
                WHEN segment2 IN (
                    '038010',
                    '043000',
                    '038000',
                    '098000'
                ) THEN
                    'MIT-Marketing & Insights Team'
                WHEN segment2 IN (
                    '017004'
                ) THEN
                    'Credit Solutions'
                WHEN segment2 IN (
                    '003000',
                    '015000',
                    '021000',
                    '056000',
                    '057000'
                ) THEN
                    'Genie'
                WHEN segment2 IN (
                    '089500'
                ) THEN
                    'Genie (CAD)'
                WHEN segment2 IN (
                    '080000',
                    '084000',
                    '085000',
                    '083000',
                    '089700'
                ) THEN
                    'Data Axle (CAD)'
                WHEN segment2 IN (
                    '063000',
                    '111000',
                    '120000',
                    '237000',
                    '390000'
                ) THEN
                    'Reference Solutions'
                WHEN segment2 IN (
                    '089600'
                ) THEN
                    'Reference Solutions (CAD)'
                WHEN segment2 IN (
                    '023000',
                    '011000'
                ) THEN
                    'Reference Solutions/Gov'
                WHEN segment2 IN (
                    '015016'
                ) THEN
                    'Strategic Accounts'
                WHEN segment2 IN (
                    '012000',
                    '189500',
                    '380000',
                    '900009'
                ) THEN
                    'Strategic Accounts (Dissolved for 2021)'
                WHEN segment2 IN (
                    '086000'
                ) THEN
                    'Strategic Accounts (CAD)'
                WHEN segment2 IN (
                    '861000'
                ) THEN
                    'Polk City Directories'
                WHEN segment2 IN (
                    '006000',
                    '024000',
                    '026000',
                    '022000',
                    '069000',
                    '074000'
                ) THEN
                    'Reseller'
                WHEN segment2 IN (
                    '420000',
                    '421000'
                ) THEN
                    'IDS-Data and DP'
                WHEN segment2 IN (
                    '428000'
                ) THEN
                    'American Express'
                WHEN segment2 IN (
                    '946509'
                ) THEN
                    'DTS-Marketing Database Clients'
                WHEN segment2 IN (
                    '947000',
                    '940099'
                ) THEN
                    'YMI-Retention Email Platform Clients'
                WHEN segment2 IN (
                    '015015'
                ) THEN
                    'SGENT- Enterprise Genie'
                WHEN segment2 IN (
                    '009000'
                ) THEN
                    'Licensing'
                WHEN segment2 IN (
                    '029500'
                ) THEN
                    'Licensing'
                WHEN substring(segment2, 1, 2) IN (
                    '85',
                    '87'
                ) THEN
                    'Genie'
                ELSE
                    'Others'
            END divisions,
/* Business Unit */
            CASE
                WHEN segment2 IN (
                    '001000',
                    '002000',
                    '028000',
                    '059000',
                    '068000',
                    '070000',
                    '071000',
                    '073000',
                    '075000',
                    '093000',
                    '095000',
                    '360000',
                    '730000',
                    '950050',
                    '287000',
                    '038010',
                    '043000',
                    '038000',
                    '098000',
                    '017004',
                    '003000',
                    '015000',
                    '021000',
                    '056000',
                    '057000',
                    '089500',
                    '080000',
                    '084000',
                    '085000',
                    '083000',
                    '089700',
                    '063000',
                    '111000',
                    '120000',
                    '237000',
                    '390000',
                    '089600',
                    '023000',
                    '011000',
                    '015016',
                    '012000',
                    '189500',
                    '380000',
                    '900009',
                    '086000',
                    '861000',
                    '006000',
                    '024000',
                    '026000',
                    '022000',
                    '069000',
                    '074000'
                ) THEN
                    'LMS'
                WHEN substring(segment2, 1, 2) IN (
                    '85',
                    '87'
                ) THEN
                    'LMS'
                WHEN segment2 IN (
                    '420000',
                    '421000',
                    '428000',
                    '946509',
                    '947000',
                    '015015',
                    '009000',
                    '940099',
                    '029500'
                ) THEN
                    'Enterprise'
                WHEN segment2 IN (
                    '029500'
                ) THEN
                    'Express-Update'
                ELSE
                    'Others'
            END business_units
        FROM
            interna.ebsprod_gaap_detail;
			
/* Revenue Type 2021/01/18*/
    drop TABLE if exists reports.revenue_type_lookup;
CREATE TABLE reports.revenue_type_lookup 
    AS
        SELECT DISTINCT
            inventory_item_id,
            CASE
                WHEN inventory_item_id IN (
                    '142430',
                    '116572',
                    '116568',
                    '142429',
                    '129423',
                    '129425',
                    '129421',
                    '129424',
                    '129426',
                    '29571',
                    '36023',
                    '74568',
                    '36015',
                    '35995',
                    '36017',
                    '35999',
                    '36001',
                    '36007',
                    '36005',
                    '129428'
                ) THEN
                    'Full Service Solutions'
                WHEN inventory_item_id IN (
                    '43288',
                    '45874',
                    '13223',
                    '20485',
                    '45748',
                    '33597',
                    '33607',
                    '33623',
                    '33617',
                    '33541',
                    '42972',
                    '5711',
                    '5688',
                    '103568',
                    '10623',
                    '14079',
                    '14077',
                    '41185',
                    '42429',
                    '5749',
                    '41181',
                    '45875',
                    '35387',
                    '41183',
                    '35293',
                    '6927',
                    '30393',
                    '45316',
                    '45280',
                    '45321',
                    '40519',
                    '119571',
                    '119574',
                    '119568',
                    '97569',
                    '39917',
                    '42209',
                    '15615',
                    '13339',
                    '30397',
                    '42463',
                    '127328',
                    '8667',
                    '9171',
                    '5755',
                    '45749',
                    '41223',
                    '41743',
                    '41759',
                    '46026',
                    '46018',
                    '45137',
                    '45134',
                    '41751',
                    '46149',
                    '46019',
                    '46027',
                    '14179',
                    '88572',
                    '24869',
                    '41889',
                    '134420',
                    '37487',
                    '34705',
                    '27789',
                    '34713',
                    '68570',
                    '23696',
                    '23697',
                    '23622',
                    '27369',
                    '34707',
                    '23594',
                    '23595',
                    '42621',
                    '23624',
                    '27909',
                    '23667',
                    '38389',
                    '38391',
                    '38393',
                    '27919',
                    '27937',
                    '27939',
                    '27941',
                    '27921',
                    '27923',
                    '27925',
                    '27927',
                    '27929',
                    '27931',
                    '27933',
                    '27935',
                    '23659',
                    '27907',
                    '38369',
                    '38371',
                    '38373',
                    '27911',
                    '27913',
                    '27915',
                    '27917',
                    '28609',
                    '28611',
                    '28613',
                    '23652',
                    '45296',
                    '23702',
                    '23700',
                    '23705',
                    '23701',
                    '23703',
                    '127408',
                    '127409',
                    '23699',
                    '23630',
                    '23629',
                    '34715',
                    '68571',
                    '23706',
                    '34461',
                    '42623',
                    '33759',
                    '37275',
                    '33761',
                    '43457',
                    '43657',
                    '43539',
                    '34473',
                    '43494',
                    '43499',
                    '43662',
                    '90568',
                    '43616',
                    '43368',
                    '43688',
                    '43479',
                    '43371',
                    '43397',
                    '43732',
                    '43418',
                    '42627',
                    '33763',
                    '42629',
                    '33765',
                    '43540',
                    '43658',
                    '43458',
                    '34477',
                    '43459',
                    '43513',
                    '43500',
                    '43514',
                    '43726',
                    '43515',
                    '42633',
                    '43522',
                    '43727',
                    '43592',
                    '43593',
                    '43496',
                    '43585',
                    '43619',
                    '43372',
                    '43480',
                    '43472',
                    '43419',
                    '43398',
                    '43399',
                    '43700',
                    '34475',
                    '43621',
                    '43620',
                    '43420',
                    '43709',
                    '43541',
                    '43728',
                    '42553',
                    '46151',
                    '43461',
                    '43473',
                    '43689',
                    '43737',
                    '43542',
                    '43715',
                    '43701',
                    '42663',
                    '33791',
                    '43422',
                    '43608',
                    '42639',
                    '33773',
                    '43690',
                    '43462',
                    '43586',
                    '42641',
                    '37309',
                    '33775',
                    '43659',
                    '43400',
                    '43423',
                    '43474',
                    '42643',
                    '33777',
                    '43424',
                    '43374',
                    '43416',
                    '33793',
                    '43545',
                    '42741',
                    '42711',
                    '42725',
                    '43663',
                    '43481',
                    '43622',
                    '43401',
                    '43594',
                    '43595',
                    '43660',
                    '43482',
                    '43369',
                    '43546',
                    '43380',
                    '43691',
                    '33781',
                    '43510',
                    '43425',
                    '43426',
                    '43428',
                    '43429',
                    '43463',
                    '43547',
                    '33783',
                    '43381',
                    '42661',
                    '37349',
                    '43439',
                    '43498',
                    '43733',
                    '43549',
                    '43550',
                    '43692',
                    '43693',
                    '43664',
                    '43402',
                    '42657',
                    '33785',
                    '43665',
                    '43551',
                    '43694',
                    '43430',
                    '43495',
                    '43596',
                    '43597',
                    '43392',
                    '43738',
                    '43376',
                    '43486',
                    '42659',
                    '33787',
                    '43487',
                    '42665',
                    '33795',
                    '42667',
                    '37361',
                    '33797',
                    '43471',
                    '43470',
                    '43533',
                    '43431',
                    '43552',
                    '43625',
                    '43702',
                    '43527',
                    '37365',
                    '42669',
                    '33799',
                    '43587',
                    '42671',
                    '33801',
                    '43432',
                    '43703',
                    '43626',
                    '43433',
                    '43704',
                    '43534',
                    '43588',
                    '43483',
                    '43435',
                    '43393',
                    '43666',
                    '43610',
                    '43613',
                    '43614',
                    '43667',
                    '43517',
                    '43491',
                    '42631',
                    '42673',
                    '33803',
                    '43717',
                    '43464',
                    '43734',
                    '42675',
                    '33805',
                    '43403',
                    '43589',
                    '43627',
                    '34469',
                    '33517',
                    '42677',
                    '33807',
                    '42679',
                    '33809',
                    '43628',
                    '43404',
                    '43436',
                    '33811',
                    '42637',
                    '42649',
                    '43598',
                    '43405',
                    '43523',
                    '43406',
                    '37469',
                    '42685',
                    '33813',
                    '43536',
                    '42687',
                    '33815',
                    '42689',
                    '33817',
                    '43377',
                    '43475',
                    '43599',
                    '42691',
                    '33819',
                    '43394',
                    '43378',
                    '43600',
                    '43695',
                    '43655',
                    '33769',
                    '33837',
                    '33839',
                    '33859',
                    '43437',
                    '43590',
                    '43705',
                    '43634',
                    '42693',
                    '33821',
                    '33823',
                    '43555',
                    '43407',
                    '33825',
                    '42697',
                    '43408',
                    '33827',
                    '43409',
                    '33829',
                    '42703',
                    '33833',
                    '43676',
                    '43635',
                    '43718',
                    '42755',
                    '42713',
                    '42647',
                    '43497',
                    '42737',
                    '37521',
                    '42653',
                    '43518',
                    '42699',
                    '42705',
                    '37499',
                    '42715',
                    '43411',
                    '43410',
                    '42707',
                    '43706',
                    '43438',
                    '43601',
                    '43711',
                    '33841',
                    '42719',
                    '33843',
                    '43639',
                    '34465',
                    '43640',
                    '43696',
                    '33845',
                    '43735',
                    '43492',
                    '43493',
                    '43442',
                    '43739',
                    '43602',
                    '33847',
                    '43443',
                    '43476',
                    '43719',
                    '43641',
                    '43444',
                    '43524',
                    '43519',
                    '43591',
                    '43642',
                    '43445',
                    '43412',
                    '34467',
                    '43643',
                    '43556',
                    '43669',
                    '43395',
                    '43615',
                    '33849',
                    '42727',
                    '43721',
                    '43484',
                    '43558',
                    '43722',
                    '43697',
                    '43477',
                    '43570',
                    '43644',
                    '43465',
                    '43611',
                    '43520',
                    '43729',
                    '43654',
                    '33771',
                    '33851',
                    '33853',
                    '43525',
                    '43661',
                    '43488',
                    '42635',
                    '43446',
                    '43447',
                    '43648',
                    '34471',
                    '43466',
                    '43649',
                    '43670',
                    '42681',
                    '43573',
                    '42729',
                    '42731',
                    '37515',
                    '42739',
                    '37523',
                    '33861',
                    '42651',
                    '42655',
                    '42701',
                    '42717',
                    '37501',
                    '43574',
                    '43714',
                    '43698',
                    '43528',
                    '43529',
                    '43427',
                    '43450',
                    '43449',
                    '43413',
                    '43650',
                    '43451',
                    '43651',
                    '43699',
                    '43603',
                    '43452',
                    '43453',
                    '43454',
                    '42733',
                    '33855',
                    '43485',
                    '43489',
                    '43414',
                    '43604',
                    '43652',
                    '43379',
                    '43605',
                    '43606',
                    '33835',
                    '42743',
                    '33863',
                    '43653',
                    '33865',
                    '43455',
                    '43538',
                    '42747',
                    '43720',
                    '33867',
                    '33871',
                    '43511',
                    '42645',
                    '42749',
                    '33869',
                    '43575',
                    '43415',
                    '43521',
                    '43469',
                    '42683',
                    '43456',
                    '42735',
                    '37519',
                    '42751',
                    '42709',
                    '42723',
                    '37507',
                    '43740',
                    '43490',
                    '43672',
                    '43673',
                    '43417',
                    '43576',
                    '43584',
                    '37535',
                    '42753',
                    '33873',
                    '42757',
                    '33875',
                    '43731',
                    '43674',
                    '43391',
                    '43310',
                    '43317',
                    '43318',
                    '43563',
                    '43321',
                    '43313',
                    '43345',
                    '43325',
                    '43323',
                    '43328',
                    '43330',
                    '43333',
                    '43336',
                    '43630',
                    '43800',
                    '43344',
                    '43341',
                    '43342',
                    '43338',
                    '43315',
                    '43319',
                    '43348',
                    '43349',
                    '43350',
                    '43560',
                    '43314',
                    '43320',
                    '43562',
                    '43346',
                    '43566',
                    '43564',
                    '43569',
                    '125616',
                    '127348',
                    '8075',
                    '129432',
                    '24871',
                    '42431',
                    '5751',
                    '45876',
                    '44754',
                    '9043',
                    '41891',
                    '8071',
                    '127329',
                    '129431',
                    '42459',
                    '42461',
                    '142431',
                    '8599',
                    '43970',
                    '43980',
                    '151430',
                    '116574',
                    '133447',
                    '125618',
                    '125624',
                    '125619',
                    '125625',
                    '125620',
                    '125623',
                    '137425',
                    '137426',
                    '137423',
                    '137424',
                    '137428',
                    '132420',
                    '116575',
                    '135420',
                    '125608',
                    '125610',
                    '72574',
                    '72573',
                    '125612',
                    '125614',
                    '125615',
                    '131420',
                    '72570',
                    '125613',
                    '137429',
                    '114568',
                    '43968',
                    '43976',
                    '115568',
                    '127388',
                    '65570',
                    '137422',
                    '65569',
                    '65568',
                    '64569',
                    '115569',
                    '116570',
                    '116571',
                    '13023',
                    '127238',
                    '139429',
                    '127239',
                    '125630',
                    '20091',
                    '20093',
                    '15479',
                    '40799',
                    '35775',
                    '38089',
                    '7899',
                    '8769',
                    '143429',
                    '9101',
                    '12093',
                    '7889',
                    '127428',
                    '6101',
                    '8337',
                    '9107',
                    '7865',
                    '13229',
                    '40609',
                    '14133',
                    '15617',
                    '7847',
                    '7921',
                    '7797',
                    '8923',
                    '7725',
                    '8241',
                    '117568',
                    '127424',
                    '8699',
                    '132421',
                    '41221',
                    '127425',
                    '46011',
                    '13057',
                    '127421',
                    '13093',
                    '127422',
                    '127312',
                    '127313',
                    '127314',
                    '127315',
                    '127310',
                    '127311',
                    '127308',
                    '127309',
                    '7773',
                    '40681',
                    '13349',
                    '13351',
                    '127419',
                    '127420',
                    '72568',
                    '125628',
                    '7883',
                    '13181',
                    '13183',
                    '116573',
                    '8919'
                ) THEN
                    'Not Classified'
                WHEN inventory_item_id IN (
                    '42251',
                    '41205',
                    '45879',
                    '140429',
                    '43988',
                    '45881',
                    '42249',
                    '38133',
                    '9087',
                    '136420',
                    '46015',
                    '46010',
                    '46000',
                    '46002',
                    '46001',
                    '42557',
                    '45854',
                    '84568',
                    '127268',
                    '84569',
                    '41771',
                    '46009',
                    '46008',
                    '46007',
                    '150429',
                    '150430',
                    '43048',
                    '45852',
                    '45848',
                    '45853',
                    '46003',
                    '46004',
                    '73570',
                    '46013',
                    '46006',
                    '128420',
                    '79569',
                    '79570',
                    '79571',
                    '43072',
                    '79568',
                    '80569',
                    '80570',
                    '127248',
                    '127298',
                    '127278',
                    '80568',
                    '80577',
                    '80573',
                    '83569',
                    '80575',
                    '80571',
                    '80572',
                    '83568',
                    '85568',
                    '146429',
                    '147429',
                    '147430',
                    '38309',
                    '31985',
                    '108568',
                    '127378',
                    '129429'
                ) THEN
                    'Subscription'
                WHEN inventory_item_id IN (
                    '41879',
                    '45884',
                    '142432',
                    '141429',
                    '45855',
                    '127319',
                    '141430',
                    '45851',
                    '46288',
                    '127258',
                    '127279',
                    '127280',
                    '144429',
                    '148429',
                    '129430',
                    '127318'
                ) THEN
                    'Transactional'
                ELSE
                    'Not Classified'
            END revenue_type
        FROM
            interna.ebsprod_gaap_detail;
            
/*Sub-product group lookup table as 2021/02/01*/
drop TABLE if exists reports.subproduct_lookup;
CREATE TABLE reports.subproduct_lookup     AS
SELECT
  DISTINCT inventory_item_id,
  CASE
    WHEN inventory_item_id IN ('8599') then 'Account management'
    WHEN inventory_item_id IN (
      '132420',
      '135420',
      '127388',
      '65570',
      '65569',
      '65568',
      '64569'
    ) then 'Ad Deployment'
    WHEN inventory_item_id IN (
      '143429',
      '9101',
      '9107',
      '8241',
      '117568',
      '13349',
      '13351'
    ) then 'Address Hygiene'
    WHEN inventory_item_id IN ('15615', '15617') then 'API Solutions'
    WHEN inventory_item_id IN (
      '119571',
      '115569',
      '13023',
      '127238',
      '139429',
      '127239',
      '125630',
      '20091',
      '20093',
      '15479',
      '40799',
      '38089',
      '14133',
      '13057',
      '127421',
      '13093',
      '127422',
      '127312',
      '127313',
      '127314',
      '127315',
      '127310',
      '127311',
      '127308',
      '127309'
    ) then 'Append'
    WHEN inventory_item_id IN ('129430') then 'Auto Credits'
    WHEN inventory_item_id IN ('13223', '146429') then 'B2C Link'
    WHEN inventory_item_id IN ('144429') then 'Bizminer'
    WHEN inventory_item_id IN (
      '129423',
      '129425',
      '129421',
      '129424',
      '129426',
      '129428'
    ) then 'Black or Ruby'
    WHEN inventory_item_id IN ('20485') then 'Brokered Data'
    WHEN inventory_item_id IN ('10623') then 'Business Church Data'
    WHEN inventory_item_id IN (
      '42251',
      '41879',
      '45884',
      '41205',
      '43988',
      '45881',
      '42249'
    ) then 'Business Credit Report'
    WHEN inventory_item_id IN (
      '42429',
      '5749',
      '45875',
      '40519',
      '119568',
      '13339',
      '9171',
      '5755'
    ) then 'Business Data'
    WHEN inventory_item_id IN ('125616') then 'Business Email Data'
    WHEN inventory_item_id IN (
      '43970',
      '43980',
      '151430',
      '116574',
      '133447',
      '137426',
      '137424',
      '137428',
      '43968',
      '43976',
      '115568'
    ) then 'Campaign Execution'
    WHEN inventory_item_id IN (
      '84568',
      '46008',
      '80569',
      '41185',
      '30393',
      '127268',
      '80570',
      '44754'
    ) then 'CAN Business'
    WHEN inventory_item_id IN ('127268', '80570', '44754') then 'CAN Consumer'
    WHEN inventory_item_id IN ('84569') then 'CAN New Business'
    WHEN inventory_item_id IN ('132421') then 'CDN Fax Blast'
    WHEN inventory_item_id IN (
      '33597',
      '33607',
      '42972',
      '45316',
      '45280',
      '45321',
      '46018',
      '46149',
      '46019'
    ) then 'CDs'
    WHEN inventory_item_id IN (
      '43288',
      '45874',
      '6927',
      '45137',
      '45134',
      '37487',
      '34705',
      '27789',
      '34713',
      '68570',
      '23696',
      '23697',
      '23622',
      '27369',
      '34707',
      '23594',
      '23595',
      '42621',
      '23624',
      '27909',
      '23667',
      '38389',
      '38391',
      '38393',
      '27919',
      '27937',
      '27939',
      '27941',
      '27921',
      '27923',
      '27925',
      '27927',
      '27929',
      '27931',
      '27933',
      '27935',
      '23659',
      '27907',
      '38369',
      '38371',
      '38373',
      '27911',
      '27913',
      '27915',
      '27917',
      '28609',
      '28611',
      '28613',
      '23652',
      '45296',
      '23702',
      '23700',
      '23705',
      '23701',
      '23703',
      '127408',
      '127409',
      '23699',
      '23630',
      '23629',
      '34715',
      '68571',
      '23706',
      '34461',
      '42623',
      '33759',
      '37275',
      '33761',
      '43457',
      '43657',
      '43539',
      '34473',
      '43494',
      '43499',
      '43662',
      '90568',
      '43616',
      '43368',
      '43688',
      '43479',
      '43371',
      '43397',
      '43732',
      '43418',
      '42627',
      '33763',
      '42629',
      '33765',
      '43540',
      '43658',
      '43458',
      '34477',
      '43459',
      '43513',
      '43500',
      '43514',
      '43726',
      '43515',
      '42633',
      '43522',
      '43727',
      '43592',
      '43593',
      '43496',
      '43585',
      '43619',
      '43372',
      '43480',
      '43472',
      '43419',
      '43398',
      '43399',
      '43700',
      '34475',
      '43621',
      '43620',
      '43420',
      '43709',
      '43541',
      '43728',
      '42553',
      '46151',
      '43461',
      '43473',
      '43689',
      '43737',
      '43542',
      '43715',
      '43701',
      '42663',
      '33791',
      '43422',
      '43608',
      '42639',
      '33773',
      '43690',
      '43462',
      '43586',
      '42641',
      '37309',
      '33775',
      '43659',
      '43400',
      '43423',
      '43474',
      '42643',
      '33777',
      '43424',
      '43374',
      '43416',
      '33793',
      '43545',
      '42741',
      '42711',
      '42725',
      '43663',
      '43481',
      '43622',
      '43401',
      '43594',
      '43595',
      '43660',
      '43482',
      '43369',
      '43546',
      '43380',
      '43691',
      '33781',
      '43510',
      '43425',
      '43426',
      '43428',
      '43429',
      '43463',
      '43547',
      '33783',
      '43381',
      '42661',
      '37349',
      '43439',
      '43498',
      '43733',
      '43549',
      '43550',
      '43692',
      '43693',
      '43664',
      '43402',
      '42657',
      '33785',
      '43665',
      '43551',
      '43694',
      '43430',
      '43495',
      '43596',
      '43597',
      '43392',
      '43738',
      '43376',
      '43486',
      '42659',
      '33787',
      '43487',
      '42665',
      '33795',
      '42667',
      '37361',
      '33797',
      '43471',
      '43470',
      '43533',
      '43431',
      '43552',
      '43625',
      '43702',
      '43527',
      '37365',
      '42669',
      '33799',
      '43587',
      '42671',
      '33801',
      '43432',
      '43703',
      '43626',
      '43433',
      '43704',
      '43534',
      '43588',
      '43483',
      '43435',
      '43393',
      '43666',
      '43610',
      '43613',
      '43614',
      '43667',
      '43517',
      '43491',
      '42631',
      '42673',
      '33803',
      '43717',
      '43464',
      '43734',
      '42675',
      '33805',
      '43403',
      '43589',
      '43627',
      '34469',
      '33517',
      '42677',
      '33807',
      '42679',
      '33809',
      '43628',
      '43404',
      '43436',
      '33811',
      '42637',
      '42649',
      '43598',
      '43405',
      '43523',
      '43406',
      '37469',
      '42685',
      '33813',
      '43536',
      '42687',
      '33815',
      '42689',
      '33817',
      '43377',
      '43475',
      '43599',
      '42691',
      '33819',
      '43394',
      '43378',
      '43600',
      '43695',
      '43655',
      '33769',
      '33837',
      '33839',
      '33859',
      '43437',
      '43590',
      '43705',
      '43634',
      '42693',
      '33821',
      '33823',
      '43555',
      '43407',
      '33825',
      '42697',
      '43408',
      '33827',
      '43409',
      '33829',
      '42703',
      '33833',
      '43676',
      '43635',
      '43718',
      '42755',
      '42713',
      '42647',
      '43497',
      '42737',
      '37521',
      '42653',
      '43518',
      '42699',
      '42705',
      '37499',
      '42715',
      '43411',
      '43410',
      '42707',
      '43706',
      '43438',
      '43601',
      '43711',
      '33841',
      '42719',
      '33843',
      '43639',
      '34465',
      '43640',
      '43696',
      '33845',
      '43735',
      '43492',
      '43493',
      '43442',
      '43739',
      '43602',
      '33847',
      '43443',
      '43476',
      '43719',
      '43641',
      '43444',
      '43524',
      '43519',
      '43591',
      '43642',
      '43445',
      '43412',
      '34467',
      '43643',
      '43556',
      '43669',
      '43395',
      '43615',
      '33849',
      '42727',
      '43721',
      '43484',
      '43558',
      '43722',
      '43697',
      '43477',
      '43570',
      '43644',
      '43465',
      '43611',
      '43520',
      '43729',
      '43654',
      '33771',
      '33851',
      '33853',
      '43525',
      '43661',
      '43488',
      '42635',
      '43446',
      '43447',
      '43648',
      '34471',
      '43466',
      '43649',
      '43670',
      '42681',
      '43573',
      '42729',
      '42731',
      '37515',
      '42739',
      '37523',
      '33861',
      '42651',
      '42655',
      '42701',
      '42717',
      '37501',
      '43574',
      '43714',
      '43698',
      '43528',
      '43529',
      '43427',
      '43450',
      '43449',
      '43413',
      '43650',
      '43451',
      '43651',
      '43699',
      '43603',
      '43452',
      '43453',
      '43454',
      '42733',
      '33855',
      '43485',
      '43489',
      '43414',
      '43604',
      '43652',
      '43379',
      '43605',
      '43606',
      '33835',
      '42743',
      '33863',
      '43653',
      '33865',
      '43455',
      '43538',
      '42747',
      '43720',
      '33867',
      '33871',
      '43511',
      '42645',
      '42749',
      '33869',
      '43575',
      '43415',
      '43521',
      '43469',
      '42683',
      '43456',
      '42735',
      '37519',
      '42751',
      '42709',
      '42723',
      '37507',
      '43740',
      '43490',
      '43672',
      '43673',
      '43417',
      '43576',
      '43584',
      '37535',
      '42753',
      '33873',
      '42757',
      '33875',
      '43731',
      '43674',
      '43391',
      '43310',
      '43317',
      '43318',
      '43563',
      '43321',
      '43313',
      '43345',
      '43325',
      '43323',
      '43328',
      '43330',
      '43333',
      '43336',
      '43630',
      '43800',
      '43344',
      '43341',
      '43342',
      '43338',
      '43315',
      '43319',
      '43348',
      '43349',
      '43350',
      '43560',
      '43314',
      '43320',
      '43562',
      '43346',
      '43566',
      '43564',
      '43569'
    ) then 'City Directories'
    WHEN inventory_item_id IN ('116570') then 'Consulting Services'
    WHEN inventory_item_id IN ('24871', '42431', '5751', '45876') then 'Consumer Data'
    WHEN inventory_item_id IN ('142431') then 'Consumer Email Data'
    WHEN inventory_item_id IN (
      '116575',
      '125614',
      '125615',
      '131420',
      '72570',
      '125613',
      '116571'
    ) then 'Creative Design'
    WHEN inventory_item_id IN ('148429') then 'Credit'
    WHEN inventory_item_id IN ('119574') then 'Custom data Compilation'
    WHEN inventory_item_id IN ('13229', '7797') then 'Data Processing'
    WHEN inventory_item_id IN ('116573', '8919') then 'Data Science Services'
	WHEN inventory_item_id IN  ('127248') then 'Data Visualization'
    WHEN inventory_item_id IN ('142430', '116572') then 'Deliverability Services'
    WHEN inventory_item_id IN ('127319', '127318') then 'Dialer'
    WHEN inventory_item_id IN (
      '45748',
      '33623',
      '33617',
      '33541',
      '103568',
      '97569',
      '45749',
      '41223',
      '41743',
      '41759',
      '46026',
      '41751',
      '46027'
    ) then 'DVDs'
    WHEN inventory_item_id IN ('141429', '141430', '108568') then 'Email'
    WHEN inventory_item_id IN (
      '127348',
      '125608',
      '125610',
      '72574',
      '72573',
      '125612',
      '137429',
      '114568'
    ) then 'Email Deployment'
    WHEN inventory_item_id IN ('147429') then 'Enrich'
    WHEN inventory_item_id IN ('142432') then 'Experian Intelliscore'
    WHEN inventory_item_id IN (
      '38133',
      '9087',
      '46015',
      '46010',
      '42557',
      '45854',
      '41771',
      '43048',
      '45852',
      '45853',
      '46013',
      '43072'
    ) then 'Genie'
    WHEN inventory_item_id IN ('29571', '36023', '74568') then 'Gold'
    WHEN inventory_item_id IN ('150429') then 'Growth Package'
    WHEN inventory_item_id IN ('39917') then 'Historical Business Data'
    WHEN inventory_item_id IN ('127298') then 'Historical Data'
    WHEN inventory_item_id IN ('127278') then 'Job Search'
    WHEN inventory_item_id IN ('45855', '45851') then 'Lead Credits'
    WHEN inventory_item_id IN ('45879') then 'Legacy API'
    WHEN inventory_item_id IN (
      '7899',
      '8769',
      '7889',
      '127424',
      '8699',
      '46011',
      '7773',
      '127419',
      '127420',
      '72568',
      '125628',
      '7883',
      '13181',
      '13183',
      '7725'
    ) then 'Manipulation'
    WHEN inventory_item_id IN ('116568') then 'Market Intelligence'
    WHEN inventory_item_id IN ('136420') then 'Marketing 360'
    WHEN inventory_item_id IN ('150430') then 'Maximum Package'
    WHEN inventory_item_id IN ('8075') then 'Medical Data'
    WHEN inventory_item_id IN ('8337', '7865', '7847', '7921', '40681') then 'Merge'
    WHEN inventory_item_id IN ('42209', '30397', '42463') then 'New Business Data'
    WHEN inventory_item_id IN ('9043', '42459') then 'New Homeowner Data'
    WHEN inventory_item_id IN ('41891', '42461') then 'New Mover Data'
    WHEN inventory_item_id IN ('127328', '8667') then 'Occupant Data'
    WHEN inventory_item_id IN ('8071') then 'Occupation Data'
    WHEN inventory_item_id IN ('80568') then 'OneSource'
    WHEN inventory_item_id IN ('40609') then 'Output'
    WHEN inventory_item_id IN (
      '36015',
      '35995',
      '36017',
      '35999',
      '36001',
      '36007',
      '36005'
    ) then 'Platinum'
    WHEN inventory_item_id IN ('8923', '127425') then 'Professional Services'
    WHEN inventory_item_id IN ('147430') then 'Prospect'
    WHEN inventory_item_id IN ('127329') then 'Public Record Data'
    WHEN inventory_item_id IN ('85568') then 'Reference'
    WHEN inventory_item_id IN ('80577') then 'SecureUSA'
    WHEN inventory_item_id IN ('128420', '31985') then 'Team Edition'
    WHEN inventory_item_id IN ('142429') then 'Template Builder'
    WHEN inventory_item_id IN ('88572') then 'UCC Data'
    WHEN inventory_item_id IN ('14179') then 'Universal Telephone Number Data'
    WHEN inventory_item_id IN (
      '46000',
      '46002',
      '46001',
      '45848',
      '46006',
      '79568',
      '46288',
      '127258',
      '80573',
      '127279',
      '38309',
      '24869',
      '134420'
    ) then 'US Business'
    WHEN inventory_item_id IN (
      '46009',
      '46007',
      '79569',
      '83569',
      '127280',
      '83568',
      '127378'
    ) then 'US Consumer'
    WHEN inventory_item_id IN ('129429') then 'US Consumer + Auto'
    WHEN inventory_item_id IN ('80575') then 'US Healthcare'
    WHEN inventory_item_id IN ('46003', '46004', '79570', '80571', '41889') then 'US New Business'
    WHEN inventory_item_id IN ('73570', '79571', '80572') then 'US New Mover'
    WHEN inventory_item_id IN ('129432', '129431') then 'Vehicle Data'
    WHEN inventory_item_id IN ('140429') then 'Verified Seal'
    else 'Not Classified'
  end sub_product
FROM
  interna.ebsprod_gaap_detail;


/*Database lookup table as 2021/02/01*/
drop TABLE if exists reports.database_lookup;
CREATE TABLE reports.database_lookup 
    AS
SELECT
  DISTINCT inventory_item_id,
  CASE
    WHEN inventory_item_id in ('142432', '20485', '103568', '144429') then '3rd Party Data'
    WHEN inventory_item_id in ('13223', '146429') then 'B2C Link'
    WHEN inventory_item_id in (
      '42251',
      '41879',
      '45884',
      '41205',
      '45879',
      '140429',
      '43988',
      '45881',
      '42249',
      '46000',
      '46002',
      '46001',
      '84568',
      '84569',
      '43288',
      '45874',
      '45848',
      '46003',
      '46004',
      '46006',
      '79570',
      '79568',
      '46288',
      '127258',
      '80569',
      '127298',
      '80573',
      '127279',
      '80575',
      '80571',
      '45748',
      '33597',
      '33607',
      '33623',
      '33617',
      '33541',
      '42972',
      '5711',
      '5688',
      '10623',
      '14077',
      '41185',
      '42429',
      '5749',
      '41181',
      '45875',
      '35387',
      '41183',
      '35293',
      '30393',
      '45316',
      '45280',
      '45321',
      '40519',
      '119571',
      '119574',
      '119568',
      '97569',
      '39917',
      '42209',
      '15615',
      '147429',
      '147430',
      '148429',
      '13339',
      '30397',
      '42463',
      '127328',
      '8667',
      '9171',
      '5755',
      '45749',
      '41223',
      '41743',
      '41759',
      '46026',
      '46018',
      '45137',
      '45134',
      '38309',
      '41751',
      '46149',
      '46019',
      '46027',
      '14179',
      '88572',
      '24869',
      '41889',
      '134420',
      '45296',
      '34461',
      '33759',
      '33761',
      '34473',
      '90568',
      '33763',
      '33765',
      '34477',
      '34475',
      '42553',
      '46151',
      '33791',
      '33773',
      '33775',
      '33777',
      '33793',
      '33781',
      '33783',
      '33785',
      '33787',
      '33795',
      '33797',
      '33799',
      '33801',
      '33803',
      '33805',
      '34469',
      '33517',
      '33807',
      '33809',
      '33811',
      '33813',
      '33815',
      '33817',
      '33819',
      '33769',
      '33837',
      '33839',
      '33859',
      '33821',
      '33823',
      '33825',
      '33827',
      '33829',
      '33833',
      '33841',
      '33843',
      '34465',
      '33845',
      '33847',
      '34467',
      '33849',
      '33771',
      '33851',
      '33853',
      '34471',
      '33861',
      '33855',
      '33835',
      '33863',
      '33865',
      '33867',
      '33871',
      '33869',
      '33873',
      '33875',
      '43310',
      '43317',
      '43318',
      '43563',
      '43321',
      '43313',
      '43345',
      '43325',
      '43323',
      '43328',
      '43330',
      '43333',
      '43336',
      '43630',
      '43800',
      '43344',
      '43341',
      '43342',
      '43338',
      '43315',
      '43319',
      '43348',
      '43349',
      '43350',
      '43560',
      '43314',
      '43320',
      '43562',
      '43346',
      '43566',
      '43564',
      '43569',
      '8075',
      '8071',
      '127329',
      '125618',
      '125624',
      '132420',
      '135420',
      '65570',
      '64569',
      '127238',
      '46011',
      '13057',
      '127421',
      '127312',
      '127314',
      '127308',
      '127419',
      '8919'
    ) then 'Business Database'
    WHEN inventory_item_id in (
      '108568',
      '125616',
      '125608',
      '72574',
      '125630',
      '20091',
      '127310',
      '72568'
    ) then 'Business Email Database'
    WHEN inventory_item_id in ('127268', '80570', '6927', '44754') then 'Canadian Database'
    WHEN inventory_item_id in ('15479') then 'Census Data'
    WHEN inventory_item_id in (
      '46009',
      '46008',
      '46007',
      '73570',
      '79569',
      '79571',
      '83569',
      '127280',
      '80572',
      '83568',
      '14079',
      '37487',
      '34705',
      '27789',
      '34713',
      '68570',
      '23696',
      '23697',
      '23622',
      '27369',
      '34707',
      '23594',
      '23595',
      '42621',
      '23624',
      '27909',
      '23667',
      '38389',
      '38391',
      '38393',
      '27919',
      '27937',
      '27939',
      '27941',
      '27921',
      '27923',
      '27925',
      '27927',
      '27929',
      '27931',
      '27933',
      '27935',
      '23659',
      '27907',
      '38369',
      '38371',
      '38373',
      '27911',
      '27913',
      '27915',
      '27917',
      '28609',
      '28611',
      '28613',
      '23652',
      '23702',
      '23700',
      '23705',
      '23701',
      '23703',
      '127408',
      '127409',
      '23699',
      '23630',
      '23629',
      '34715',
      '68571',
      '23706',
      '42623',
      '37275',
      '43457',
      '43657',
      '43539',
      '43494',
      '43499',
      '43662',
      '43616',
      '43368',
      '43688',
      '43479',
      '43371',
      '43397',
      '43732',
      '43418',
      '42627',
      '42629',
      '43540',
      '43658',
      '43458',
      '43459',
      '43513',
      '43500',
      '43514',
      '43726',
      '43515',
      '42633',
      '43522',
      '43727',
      '43592',
      '43593',
      '43496',
      '43585',
      '43619',
      '43372',
      '43480',
      '43472',
      '43419',
      '43398',
      '43399',
      '43700',
      '43621',
      '43620',
      '43420',
      '43709',
      '43541',
      '43728',
      '43461',
      '43473',
      '43689',
      '43737',
      '43542',
      '43715',
      '43701',
      '42663',
      '43422',
      '43608',
      '42639',
      '43690',
      '43462',
      '43586',
      '42641',
      '37309',
      '43659',
      '43400',
      '43423',
      '43474',
      '42643',
      '43424',
      '43374',
      '43416',
      '43545',
      '42741',
      '42711',
      '42725',
      '43663',
      '43481',
      '43622',
      '43401',
      '43594',
      '43595',
      '43660',
      '43482',
      '43369',
      '43546',
      '43380',
      '43691',
      '43510',
      '43425',
      '43426',
      '43428',
      '43429',
      '43463',
      '43547',
      '43381',
      '42661',
      '37349',
      '43439',
      '43498',
      '43733',
      '43549',
      '43550',
      '43692',
      '43693',
      '43664',
      '43402',
      '42657',
      '43665',
      '43551',
      '43694',
      '43430',
      '43495',
      '43596',
      '43597',
      '43392',
      '43738',
      '43376',
      '43486',
      '42659',
      '43487',
      '42665',
      '42667',
      '37361',
      '43471',
      '43470',
      '43533',
      '43431',
      '43552',
      '43625',
      '43702',
      '43527',
      '37365',
      '42669',
      '43587',
      '42671',
      '43432',
      '43703',
      '43626',
      '43433',
      '43704',
      '43534',
      '43588',
      '43483',
      '43435',
      '43393',
      '43666',
      '43610',
      '43613',
      '43614',
      '43667',
      '43517',
      '43491',
      '42631',
      '42673',
      '43717',
      '43464',
      '43734',
      '42675',
      '43403',
      '43589',
      '43627',
      '42677',
      '42679',
      '43628',
      '43404',
      '43436',
      '42637',
      '42649',
      '43598',
      '43405',
      '43523',
      '43406',
      '37469',
      '42685',
      '43536',
      '42687',
      '42689',
      '43377',
      '43475',
      '43599',
      '42691',
      '43394',
      '43378',
      '43600',
      '43695',
      '43655',
      '43437',
      '43590',
      '43705',
      '43634',
      '42693',
      '43555',
      '43407',
      '42697',
      '43408',
      '43409',
      '42703',
      '43676',
      '43635',
      '43718',
      '42755',
      '42713',
      '42647',
      '43497',
      '42737',
      '37521',
      '42653',
      '43518',
      '42699',
      '42705',
      '37499',
      '42715',
      '43411',
      '43410',
      '42707',
      '43706',
      '43438',
      '43601',
      '43711',
      '42719',
      '43639',
      '43640',
      '43696',
      '43735',
      '43492',
      '43493',
      '43442',
      '43739',
      '43602',
      '43443',
      '43476',
      '43719',
      '43641',
      '43444',
      '43524',
      '43519',
      '43591',
      '43642',
      '43445',
      '43412',
      '43643',
      '43556',
      '43669',
      '43395',
      '43615',
      '42727',
      '43721',
      '43484',
      '43558',
      '43722',
      '43697',
      '43477',
      '43570',
      '43644',
      '43465',
      '43611',
      '43520',
      '43729',
      '43654',
      '43525',
      '43661',
      '43488',
      '42635',
      '43446',
      '43447',
      '43648',
      '43466',
      '43649',
      '43670',
      '42681',
      '43573',
      '42729',
      '42731',
      '37515',
      '42739',
      '37523',
      '42651',
      '42655',
      '42701',
      '42717',
      '37501',
      '43574',
      '43714',
      '43698',
      '43528',
      '43529',
      '43427',
      '43450',
      '43449',
      '43413',
      '43650',
      '43451',
      '43651',
      '43699',
      '43603',
      '43452',
      '43453',
      '43454',
      '42733',
      '43485',
      '43489',
      '43414',
      '43604',
      '43652',
      '43379',
      '43605',
      '43606',
      '42743',
      '43653',
      '43455',
      '43538',
      '42747',
      '43720',
      '43511',
      '42645',
      '42749',
      '43575',
      '43415',
      '43521',
      '43469',
      '42683',
      '43456',
      '42735',
      '37519',
      '42751',
      '42709',
      '42723',
      '37507',
      '43740',
      '43490',
      '43672',
      '43673',
      '43417',
      '43576',
      '43584',
      '37535',
      '42753',
      '42757',
      '43731',
      '43674',
      '43391',
      '129432',
      '129430',
      '24871',
      '42431',
      '5751',
      '45876',
      '127378',
      '9043',
      '41891',
      '129429',
      '129431',
      '42459',
      '42461',
      '125619',
      '125625',
      '139429',
      '127239',
      '40799',
      '38089',
      '15617',
      '13093',
      '127422',
      '127313',
      '127315',
      '127309',
      '127420',
      '13181',
      '13183'
    ) then 'Consumer Database'
    WHEN inventory_item_id in (
      '142431',
      '125610',
      '72573',
      '20093',
      '127311',
      '125628'
    ) then 'Consumer Email Database'
    WHEN inventory_item_id in (
      '129423',
      '129425',
      '129421',
      '129424',
      '129426',
      '29571',
      '36023',
      '74568',
      '36015',
      '35995',
      '36017',
      '35999',
      '36001',
      '36007',
      '36005',
      '129428'
    ) then 'Custom Database'
    WHEN inventory_item_id in (
      '38133',
      '9087',
      '136420',
      '141429',
      '46015',
      '46010',
      '42557',
      '45854',
      '41771',
      '45855',
      '127319',
      '150429',
      '150430',
      '43048',
      '45852',
      '45853',
      '46013',
      '141430',
      '45851',
      '128420',
      '43072',
      '142430',
      '116572',
      '116568',
      '142429',
      '127248',
      '127278',
      '80568',
      '80577',
      '85568',
      '31985',
      '43970',
      '151430',
      '116574',
      '116575',
      '43976',
      '116570',
      '116571',
      '127318'
    ) then 'None'
    WHEN inventory_item_id in (
      '127348',
      '8599',
      '43980',
      '133447',
      '137426',
      '137424',
      '137428',
      '43968',
      '115568',
      '127388',
      '13023',
      '7899',
      '8769',
      '143429',
      '127428',
      '6101',
      '8337',
      '7797',
      '8923',
      '8241',
      '127424',
      '8699',
      '132421',
      '127425',
      '7773',
      '40681',
      '116573'
    ) then 'Varied'
    WHEN inventory_item_id in ('115569', '117568') then 'Vendor Data'
    else 'Not Classified'
  end database_name
FROM
  interna.ebsprod_gaap_detail;
