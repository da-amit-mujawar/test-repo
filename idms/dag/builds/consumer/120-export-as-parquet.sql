DROP TABLE IF EXISTS nosuchtable;
DROP VIEW IF EXISTS ig_consumer_export_view;
CREATE VIEW ig_consumer_export_view
AS 
SELECT  listid,
    permissiontype,
    zipradius,
    georadius,
    firstname,
    middleinitial,
    lastname,
    last_name_suffix,
    title_code,
    gender,
    house_number,
    street_pre_directional,
    street_name,
    street_suffix,
    street_post_directional,
    unit_type,
    unit_number,
    city,
    state,
    census_state_code_2010,
    county_code,
    zip,
    zip_four,
    carrier_route_code,
    delivery_point_bar_code,
    area_code,
    nielsen_county_rank,
    time_zone,
    age_code,
    birth_date,
    income,
    last_contribution_date,
    length_of_residence,
    residence_type,
    delivery_unit_size_raw,
    own_rent_indicator,
    location_type,
    pool_type,
    home_value_code,
    home_sale_date,
    home_sale_price_code,
    home_sale_price,
    home_equity_estimate,
    finance_type,
    mortgage_loan_type,
    boat_propulsion_code,
    mortgage_amount,
    congressional_district,
    credit_card_code,
    number_trade_lines,
    marital_status,
    spousal_indicator_raw,
    cat_owner,
    dog_owner,
    grandparent_in_house,
    veteran_flag,
    stocks_or_bonds,
    dm_high_tech_household,
    female_occupation,
    male_occupation,
    census_average_years_attended_school_code,
    census_phhblack_code,
    census_of_population_graduated_college,
    census_phhspnsh_code,
    census_percent_of_population_married,
    census_precent_of_population_single_parent,
    expendable_income_rank,
    loan_to_value_ratio_ltv,
    donor_code,
    mail_responsive_current,
    mail_responsive_recent,
    mail_responsive_ever,
    census_tract_2010,
    census_block_group_2010,
    address_type,
    hoh_head_of_household,
    first_name_hoh,
    middle_initial_hoh,
    last_name_hoh,
    last_name_suffix_hoh,
    title_code_hoh,
    gender_hoh,
    birth_date_hoh,
    individual_id_hoh,
    hoh_age_code,
    number_trade_lines_hoh,
    credit_card_code_hoh,
    marital_status_hoh,
    company_id,
    individual_id,
    location_id,
    usps_delivery_service_type_code,
    nielsen_county_region,
    lot_size,
    home_size,
    home_age,
    actual_age_flag,
    political_contribution_amount,
    pilot_license_code,
    mortgage_interest_rates_old,
    last_party_contributed_to,
    aircraft_type_code,
    boat_owner_indicator,
    registered_voter,
    political_party_affiliation,
    number_of_adults_in_household,
    household_member_count,
    medag18p,
    census_percent_of_population_with_3_households,
    census_phhasian_code,
    medhhd1,
    wealth_finder,
    numberofchildren,
    alternatehhind,
    countryoforign,
    donotmailflag,
    emailpresenceflag,
    routetype,
    householdarrivaldate_year,
    householdarrivaldate,
    homeagesource,
    homebuiltyear,
    mortgagemonth,
    homevaluesource,
    actualincome,
    infopersona_cluster,
    infopersona_supercluster,
    lifestyle,
    listtype,
    marriedscore,
    medhhd2,
    mortgageloantype,
    mortgageinterestsource,
    occupancycount,
    agedatasource,
    presenceofchildren,
    recencydate,
    refreshdate,
    scf,
    vendorethnicity,
    vendorethnicgroup,
    vendorlanguage,
    vendorreligion,
    censuscountycode2010,
    fulfillmentflag,
    childrenbygender0,
    childrenbygender1,
    childrenbygender2,
    childrenbygender3,
    childrenbygender4,
    childrenbygender5,
    childrenbygender6,
    childrenbygender7,
    childrenbygender8,
    childrenbygender9,
    childrenbygender10,
    childrenbygender11,
    childrenbygender12,
    childrenbygender13,
    childrenbygender14,
    childrenbygender15,
    childrenbygender16,
    childrenbygender17,
    markettargetage0_5,
    markettargetage6_11,
    markettargetage12_17,
    markettargetage12_17female,
    markettargetage12_17male,
    children0_5,
    children6_11,
    children0_11,
    childrenbybirthmonth0,
    childrenbybirthmonth1,
    childrenbybirthmonth2,
    childrenbybirthmonth3,
    childrenbybirthmonth4,
    childrenbybirthmonth5,
    childrenbybirthmonth6,
    childrenbybirthmonth7,
    childrenbybirthmonth8,
    childrenbybirthmonth9,
    childrenbybirthmonth10,
    childrenbybirthmonth11,
    childrenbybirthmonth12,
    childrenbybirthmonth13,
    childrenbybirthmonth14,
    childrenbybirthmonth15,
    childrenbybirthmonth16,
    childrenbybirthmonth17,
    purchasing_power_income,
    potential_investor_consumer,
    sub_family_indicator,
    number_of_contributions,
    aircraft_mfg_year,
    cbsa_code,
    heavy_internet_user,
    early_technology_adopter,
    csa_code,
    csa_code_description,
    cbsa_level,
    mail_confidence,
    boat_hull_type,
    boat_length,
    flatitude,
    flongitude,
    vendor_matchcode,
    do_not_call_flag,
    has_primary_telephone,
    addressline1,
    digitalmatch,
    age,
    mortgagedate,
    loanamount,
    lhi_african_american_ethnic_products,
    lhi_american_history,
    lhi_general_apparel,
    lhi_automotive,
    lhi_baseball,
    lhi_basketball,
    lhi_bible,
    lhi_birds,
    lhi_publish_books,
    lhi_business_items,
    lhi_cats,
    lhi_collectibles,
    lhi_college,
    lhi_computers,
    lhi_cooking,
    lhi_general_crafts,
    lhi_current_events,
    lhi_do_it_yourselfer,
    lhi_charitable_donor,
    lhi_personalized_products,
    lhi_horses,
    lhi_culture_arts,
    lhi_dogs,
    lhi_children_family,
    lhi_fishing,
    lhi_fitness_exercise,
    lhi_football,
    lhi_gardening,
    lhi_gambling,
    lhi_gift_giver,
    lhi_golf,
    lhi_general_health,
    lhi_hispanic_ethnic_products,
    lhi_hobbies,
    lhi_hockey,
    lhi_home_decorating,
    lhi_humor,
    lhi_hunting,
    lhi_inspirational,
    lhi_apparel_kids,
    lhi_apparel_mens,
    lhi_money_making,
    lhi_motorcycles,
    lhi_music,
    lhi_ocean,
    lhi_outdoors,
    lhi_pets,
    lhi_personal_finance,
    lhi_rural_farming,
    lhi_general_sports,
    lhi_stationery,
    lhi_general_travel,
    lhi_movies,
    lhi_wildlife,
    lhi_apparel_womens,
    lhi_unused_01,
    lhi_photography,
    lhi_seniors,
    lhi_aviation,
    lhi_electionics,
    lhi_internet,
    lhi_credit_card_user,
    lhi_beauty_cosmetic,
    lhi_asian_ethnic_products,
    lhi_dieting,
    lhi_science,
    lhi_sweepstakes,
    lhi_tobacco,
    lhi_bargain_seekers,
    lhi_publications,
    lhi_catalogs,
    lhi_hightech,
    lhi_apparel_accessories,
    lhi_apparel_mens_fashions,
    lhi_apparel_womens_fashions,
    lhi_auto_racing,
    lhi_trucks,
    lhi_home_office_products,
    lhi_politically_conservative,
    lhi_crocheting,
    lhi_knitting,
    lhi_needlepoint,
    lhi_quilting,
    lhi_sewing,
    lhi_fiction,
    lhi_games,
    lhi_unused_03,
    lhi_gourmet,
    lhi_history,
    lhi_internet_access,
    lhi_internet_buying,
    lhi_liberal,
    lhi_books_nonfiction,
    lhi_boating_sailing,
    lhi_camping_hiking,
    lhi_hunting_fishing,
    lhi_photo_processing,
    lhi_magazine_subscriber,
    lhi_books_science_fiction,
    lhi_skiing,
    lhi_soccer,
    lhi_tennis,
    lhi_travel_cruises,
    lhi_travel_rv,
    lhi_travel_us,
    tw_greenmodel,
    tw_highvaluesecurityinvestor,
    tw_highereducation,
    tw_highvaluestockinvestor,
    tw_heavyinvestmenttraders,
    tw_physicalfitnessclubs,
    tw_highriskinvestor,
    tw_lowriskinvestor,
    tw_frequentbusinesstraveler,
    tw_frequentflyer,
    tw_annuities,
    tw_lifeinsurance,
    tw_luxurycarbuyer,
    tw_cruise,
    tw_timeshareowner,
    tw_impulsebuyer,
    tw_luxuryhotel,
    tw_pbsdonor,
    tw_safetysecurityconscious,
    tw_shopaholics,
    tw_avidthemeparkvisitor,
    tw_foreigntravelvacation,
    tw_conservative,
    tw_leaningconservative,
    tw_leaningliberal,
    tw_religiousdonor,
    tw_gardenmaintenance,
    tw_heavyfamilyrestaurantvisitor,
    tw_heavypayperviewsports,
    tw_nascar,
    tw_liberal,
    tw_dogproducts,
    tw_heavypayperviewmovies,
    tw_dietproducts,
    tw_organicfoods,
    tw_heavyvitaminanddietarysupplement,
    tw_babyproducts,
    tw_heavycouponuser,
    tw_opinionleaders,
    tw_catproducts,
    tw_creditcardrewards,
    tw_highendsportingequipment,
    tw_homeimprovement,
    tw_highendelectronicsbuyer,
    tw_avidgamer,
    tw_rentalcar,
    tw_avidcellphoneuser,
    tw_countryclubmember,
    tw_professionaltaxpreparation,
    tw_onsitetaxpreparationservice,
    tw_classicalmusicconcerts,
    tw_rockmusicconcerts,
    tw_countrymusicconcerts,
    tw_livetheater,
    tw_heavybookbuyer,
    tw_freshwaterfishing,
    tw_saltwaterfishing,
    tw_hunting,
    tw_allterrainvehicle,
    tw_powerboating,
    tw_outdooractivities,
    tw_adventureseekers,
    tw_lowendsportingequipment,
    tw_professionalbaseballsportsfans,
    tw_professionalbasketballsportsfans,
    tw_professionalfootballsportsfans,
    tw_soccersportsfans,
    tw_collegebasketballsportsfans,
    tw_collegefootballsportsfans,
    tw_golfsportsfans,
    tw_tennissportsfans,
    tw_professionalwrestlingsportsfans,
    tw_internationallongdistance,
    tw_heavyfrozendinner,
    tw_cookfromscratch,
    tw_cookforfun,
    tw_winelover,
    tw_onlinepurchasepersonal,
    tw_onlinepurchasebusiness,
    tw_onlinetravelplan,
    tw_blogwriting,
    tw_voiceoverinternet,
    tw_wifioutsideofhome,
    tw_wifiinhome,
    tw_wholesaleclub,
    tw_autoclub,
    tw_diyautomaintenance,
    tw_onlinegamingactivity,
    tw_onlineinvestmenttrading,
    tw_onlinebillpayment,
    tw_onlinetvdownload,
    tw_mobileinternetaccess,
    tw_socialmedianetwork,
    tw_specialtyorganicfoodstore,
    tw_homeoffice,
    tw_businessbanking,
    tw_moderate_economyhotel,
    tw_e_reader,
    tw_cellphoneonlymodel,
    tw_alternativemedicine,
    tw_non_religiousdonor,
    tw_majorhomeremodeling,
    tw_avidsmartphoneusers,
    tw_healthinsurance,
    tw_satellitetv,
    tw_onlinemusicdownload,
    tw_adulteducation,
    tw_pilates_yoga,
    tw_fastfood,
    tw_hybridcars,
    tw_heavy_online_buyer,
    tw_high_end_appparel,
    tw_heavy_catalog_buyer,
    tw_gift_buyers,
    tw_camping,
    tw_sports_fanatics,
    tw_financial_planner,
    tw_work_health_insurance,
    tw_comprehensive_auto_insurance,
    tw_small_business_insurance,
    tw_heavy_snack_eaters,
    tw_heavy_domestic_travelers,
    tw_new_vehicle_buyer,
    tw_suv_buyer,
    tw_minivan_buyer,
    tw_auto_loan,
    tw_education_loan,
    tw_real_estate_investment,
    tw_fantasy_sports,
    tw_hockey_buyer,
    tw_auto_lease,
    tw_digital_payment,
    tw_high_mileage_usage,
    tw_motorcycle_owner,
    tw_union_member,
    tw_national_park_visitor,
    tw_online_streaming_and_devices,
    tw_road_trip,
    tw_social_networking_ad_click,
    tw_satellite_radio,
    heatingtype_code,
    income_producing_assets,
    marketarea,
    phonenumbertype,
    revolver_to_transactor,
    second_property_ind,
    consumerstabilityrawscore,
    consumerstabilitypercentile,
    ailments,
    mailscore,
    populationdensity,
    number_of_surnames,
    homeowner,
    education_model,
    education_model_ext,
    income_producing_assets_ext,
    titlecode_ext,
    boatpropulsioncode_ext,
    vendorethnicity_ext,
    vendorreligion_ext,
    vendorlanguage_ext,
    vendorethnicgroup_ext,
    countryoforign_ext,
    contributionamount,
    lemsmatchcode,
    mortgagepresent,
    discretionary_income_score,
    membercount,
    sesi,
    zipfourmatchlevel,
    no_stats_indicator,
    vacant_indicator,
    timezone,
    areaprefix,
    correctivelensespresence,
    actualvacation_expense,
    vacation_expense,
    vacation_expense_dic,
    nid,
    nid_description,
    gui_probable,
    gui_probable_mightbe,
    gui_accurate,
    telemarketingflag,
    phoneincludeallflag,
    segmentcode_a,
    segmentcode_e,
    segmentcode_f,
    segmentcode_g,
    segmentcode_h,
    segmentcode_i,
    segmentcode_j,
    opt_out_flag,
    emailaddress,
    vendor_code,
    categories,
    domain,
    top_level_domain,
    opt_out_date,
    car_make,
    car_model,
    car_year,
    date_entered_yyyymm,
    email_domain,
    open_flag,
    open_date_yyyymm,
    click_flag,
    click_date_yyyymm,
    md5_email_lower,
    md5_email_upper,
    ipaddress,
    url,
    sha256_email,
    sha512_email,
    bv_flag,
    marigold,
    bvt_refresh_date,
    ipst_status_code,
    ipst_refresh_date,
    bestdate,
    reactivation_flag,
    mgen_match_flag,
    bridge_code,
    best_date_range,
    haspostal,
    infogroupcontact,
    matchcode_lrfs,
    cinclude,
    matchlevel,
    individual_id_bak,
    company_id_bak,
    email_deliverable,
    email_marketable,
    email_reputation_risk,
    email_deployable,
    markettargetage18_44female,
    pprofsnl,
    pwhitcol,
    pbluecol,
    pcolgrad,
    routenumber,
    boxtype,
    boxnumber,
    nameaddresssource,
    mailorderbuyerflag,
    creditcard_bank,
    markettargetage0_11,
    markettargetage0_17,
    markettargetage18_24female,
    markettargetage18_24male,
    markettargetage18_34female,
    markettargetage18_34male,
    markettargetage25_34female,
    markettargetage25_34male,
    markettargetage35_44female,
    markettargetage35_44male,
    markettargetage35_54female,
    markettargetage35_54male,
    markettargetage45_54female,
    markettargetage45_54male,
    markettargetage50plus,
    markettargetage55_64female,
    markettargetage55_64male,
    markettargetage65plus,
    householdsize1_2,
    householdsize3plus,
    phonesourcecat,
    secondaryareacode,
    secondaryphone,
    numberoffireplaces,
    pool,
    bedroomcount,
    bathroomcount,
    garagetype,
    homeownersource,
    salepricesource,
    saledatesource,
    roomcount,
    multipleunit,
    purchasing_power_indicator,
    phone_number,
    fips_code,
    lifestyle01,
    lifestyle02,
    lifestyle03,
    lifestyle04,
    lifestyle05,
    lifestyle06,
    lifestyle07,
    lifestyle08,
    lifestyle09,
    lifestyle10,
    lifestyle11,
    lifestyle12,
    lifestyle13,
    lifestyle14,
    lifestyle15,
    lifestyle16,
    lifestyle17,
    lifestyle18,
    lifestyle19,
    lifestyle20,
    lifestyle21,
    lifestyle22,
    lifestyle23,
    lifestyle24,
    lifestyle25,
    lifestyle26,
    lifestyle27,
    lifestyle28,
    lifestyle29,
    lifestyle30,
    lifestyle31,
    lifestyle32,
    lifestyle33,
    lifestyle34,
    lifestyle35,
    ailments_1,
    ailments_2,
    ailments_3,
    ailments_4,
    ailments_5,
    ailments_6,
    ailments_7,
    ailments_8,
    ailments_9,
    ailments_10,
    ailments_11,
    ailments_12,
    ailments_13,
    ailments_14,
    ailments_15,
    census_combined_code,
    census_state_country_tract,
    contact_name,
    donor_code1,
    donor_code2,
    donor_code3,
    donor_code4,
    donor_code5,
    zip9,
    mortgage_interest_rates,
    hardkey,
    countycodebystatecode,
    carrierroutecodebyzipcode,
    birthmonth,
    birthdayofmonth,
    birthyearmonth,
    statecity,
    fullname,
    title,
    gui_commonsuppression,
    statecountyname,
    statecityzip,
    zipend,
    statecityscf,
    statecountycode,
    unit_number_flag,
    addresszip,
    stateneighborhood,
    statecityneighborhood,
    mailorderbuyer_01,
    mailorderbuyer_02,
    mailorderbuyer_03,
    mailorderbuyer_04,
    mailorderbuyer_05,
    mailorderbuyer_06,
    mailorderbuyer_07,
    mailorderbuyer_08,
    mailorderbuyer_09,
    mailorderbuyer_10,
    mailorderbuyer_11,
    mailorderbuyer_12,
    mailorderbuyer_13,
    mailorderbuyer_14,
    mailorderbuyer_15,
    mailorderbuyer_16,
    mailorderbuyer_18,
    individual_mc,
    company_mc,
    address_mc,
    preferredcity,
    cellphone,
    cellphone_areacode,
    cellphone_number,
    cellphone_cordcutter,
    cellphone_prepaid_indicator,
    cellphone_donotcallflag,
    cellphone_verified_code,
    cellphone_activitystatus,
    cellphone_filterflag,
    cellphone_filterreason,
    cellphone_isdqi,
    cellphone_matchlevel,
    cellphone_matchscore,
    cellphone_modifiedscore,
    cellphone_individualmatch,
    nielsen_county_rank_description,
    income_description,
    age_code_description,
    home_equity_estimate_description,
    home_sale_price_code_description,
    home_value_code_description,
    own_rent_indicator_description,
    expendable_income_rank_description,
    mortgage_amount_description,
    mortgage_loan_type_description,
    loan_to_value_ratio_ltv_description,
    censusstatecode2020,
    censuscountycode2020,
    censustract2020,
    censusblockgroup2020,
    secondmortgageamount,
    secondmortgagetypecode,
    lot_size_sqfeet,
    universal_sqfeet,
    universal_sqfeet_ind,
    living_sqfeet,
    groundfloor_sqfeet,
    gross_sqfeet,
    adjustedgross_sqfeet,
    basement_sqfeet,
    garage_sqfeet,
    fullbath,
    halfbath,
    fireplace_ind,
    fireplacetype,
    pooltype,
    roofcover,
    roofshape,
    conditiontype,
    exteriorwalltype,
    foundationtype,
    constructionquality,
    stories,
    styletype,
    airconditioningtype,
    electricwiringtype,
    fueltype,
    sewertype,
    watertype,
    construction_type_detail,
    heating_type_detail
FROM IG_CONSUMER_NEW_TEMP;
 
UNLOAD ('SELECT * FROM ig_consumer_export_view')
    TO 's3://idms-7933-prod/temp/consumer/'
IAM_ROLE '{iam}'
FORMAT PARQUET
CLEANPATH;
