DROP TABLE IF EXISTS {iusa-stage-table};

CREATE TABLE {iusa-stage-table}
DISTSTYLE ALL
AS
SELECT
INFO_FULLNAME,
INFO_COMPANY,
INFO_ADDRESSLINE1,
INFO_CITY,
INFO_STATE,
INFO_ZIP,
INFO_ZIP4,
PRIMARY_ZIP10,
PRIMARY_CARRIER_ROUTE_CODE,
PRIMARY_STATE_CODE,
COUNTY_CODE,
COUNTY_NAME,
MSA_CODE,
MSA_DESC,
CBSA_CODE,
CBSA_DESCR,
METRO_MICRO_INDICATOR,
CSA_CODE,
CSA_DESCR,
CENSUS_TRACT,
CENSUS_BLOCK_GROUP,
LATITUDE,
LONGITUDE,
MATCH_LEVEL_CODE,
SECONDARY_ADDRESS,
SECONDARY_CITY,
SECONDARY_STATE,
SECONDARY_STATE_CODE,
SECONDARY_ZIP_CODE,
SECONDARY_ZIP4,
SECONDARY_ZIP10,
SECONDARY_CARRIER_ROUTE_CODE,
INFO_PHONE,
FAX_NUMBER,
TOLL_FREE_NUMBER,
WEB_SITE,
SELECTED_SIC_CODE,
SELECTED_SIC_DESC,
FRANCHISE_SPECIALTY_DESC_1,
FRANCHISE_SPECIALTY_DESC_2,
FRANCHISE_SPECIALTY_DESC_3,
FRANCHISE_SPECIALTY_DESC_4,
FRANCHISE_SPECIALTY_DESC_5,
FRANCHISE_SPECIALTY_DESC_6,
TRUE_FRANCHISE,
INDUSTRY_SPECIFIC_CODE,
INDUSTRY_SPECIFIC_DESCRIPTION,
INFO_PRISIC_6,
PRIMARY_SIC_DESC,
INFO_SECSIC_6,
SECONDARY_SIC_DESC_1,
INFO_TERSIC_6,
SECONDARY_SIC_DESC_2,
SECONDARY_SIC_CODE_3,
SECONDARY_SIC_DESC_3,
SECONDARY_SIC_CODE_4,
SECONDARY_SIC_DESCRIPTION_4,
NAICS_CODE,
NAICS_DESC,
INFO_EMPSIZECODE,
LOCATION_EMPLOYMENT_SIZE_DESC,
INFO_EMPLOYEES,
CORPORATE_EMPLOYMENT_SIZE_CODE,
CORPORATE_EMPLOYMENT_SIZE_DESC,
ACTUAL_CORPORATE_EMPLOYMENT_SIZE,
INFO_MODEMPSIZE,
INFO_SALESVOLCODE,
LOCATION_SALES_VOLUME_DESC,
ACTUAL_LOCATION_SALES_VOLUME,
CORPORATE_SALES_VOLUME_CODE,
CORPORATE_SALES_VOLUME_DESC,
ACTUAL_CORPORATE_SALES_VOLUME,
ASSET_SIZE,
LAST_NAME,
FIRST_NAME,
SALUTATION,
GENDER,
PROFESSIONAL_TITLE,
TITLE_CODE,
TITLE_DESC,
INFO_ETHNICITY,
ETHNICITY_DESC,
KEY_CODE,
TITLE_ADDRESS,
INFO_ABINUMBER,
INFOUSA_SUBSIDIARY_ID,
INFOUSA_PARENT_ID,
SITE_NUMBER,
INFO_BUSSTATUS,
HQ_BRANCH_DESC,
PUBLIC_COMPANY_INDICATOR_CODE,
STOCK_EXCHANGE_CODE,
STOCK_EXCHANGE_DESC,
STOCK_TICKER_SYMBOL,
PUBLIC_FILING_INDICATOR,
FORTUNE_RANKING,
INDIVIDUAL_FIRM_CODE,
INDIVIDUAL_FIRM_DESC,
YEAR_SIC_ADDED,
YEAR_FIRST_APPEARED_IN_YELLOW_PAGES,
INFO_YEARSTARTED,
YELLOW_PAGE_CODE,
INFO_TRANSDATE,
INFO_TRANSTYPE,
INFO_TELRESDATE,
INFO_CALLSTATUS,
CALL_STATUS_DESC,
INFO_CREDITSCORE,
CREDIT_SCORE_DESC,
ACTUAL_CREDIT_SCORE,
INFO_ADSIZE,
AD_SIZE_DESC,
INFO_OFFICESIZE,
OFFICE_SIZE_DESC,
POPULATION_CODE,
POPULATION_DESC,
WORK_AT_HOME_BUSINESS,
OWN_LEASE_CODE,
SQUARE_FOOTAGE_CODE,
SQUARE_FOOTAGE_DESC,
RADIAL_DISTANCE_FROM_TARGET_ELEMENT,
ACTNUMBUS_MULTITENANT_LOCATION,
MULTITENANT_CODE,
MULTITENANT_DESC,
BUILDING_NUM_MULTI_TENANT,
INFO_NUMOFPCS,
NUMBER_OF_PCS_DESC,
AFFLUENT_NEIGHBORHOOD_LOCATION,
BIG_BUSINESS,
INFO_FEMALEOWNED,
INFO_BUSSIZECHANGE,
HIGHINCOMEEXEC,
HIGHTECHBUSINESS,
MEDIUM_SIZE_BUSINESS_ENTREPRENEUR,
SMALL_BUSINESS_ENTREPRENEUR,
DELIVERY_POINT_BAR_CODE,
PRESORT_ENDORSEMENT_LINE,
PRESORT_BAG_NUMBER,
PRESORT_BUNDLE_NUMBER,
PRESORT_LINE_OF_TRAVEL,
TERTIARY_ADDRESS,
TERTIARY_CITY,
TERTIARY_STATE,
TERTIARY_ZIP_CODE,
TERTIARY_ZIP4,
TERTIARY_ZIP10,
TERTIARY_CARRIER_ROUTE_CODE,
WHITE_COLLAR_PERCENTAGE,
WHITE_COLLAR_INDICATOR,
PRODUCTION_DATE,
SEQUENCE_NUMBER,
OBSOLESCENCE_DATE,
PRODUCTION_DATE1,
SOURCE,
BOOKNO,
GOVSEGCD,
FORGNPAR,
IMPEXPCD,
FRANCHISE_SPECIALTY_CODE_1,
FRANCHISE_SPECIALTY_CODE_2,
FRANCHISE_SPECIALTY_CODE_3,
FRANCHISE_SPECIALTY_CODE_4,
FRANCHISE_SPECIALTY_CODE_5,
FRANCHISE_SPECIALTY_CODE_6,
UTILEXP,
EMAILF,
EOR,  
LEFT(INFO_PRISIC_6,2) AS INFO_PRISIC_2,
LEFT(INFO_PRISIC_6,4) AS INFO_PRISIC_4,
LEFT(INFO_SECSIC_6,2) AS INFO_SECSIC_2,
LEFT(INFO_SECSIC_6,4) AS INFO_SECSIC_4,
LEFT(INFO_TERSIC_6,2) AS INFO_TERSIC_2,
LEFT(INFO_TERSIC_6,4) AS INFO_TERSIC_4,
ACTUAL_LOCATION_SALES_VOLUME AS INFO_SALESVOL,
CASE
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '0100' AND '0999' THEN 'A'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '1000' AND '1499' THEN 'B'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '1500' AND '1799' THEN 'C'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '2000' AND '3999' THEN 'D'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '4000' AND '4599' THEN 'E'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '4600' AND '4699' THEN 'G'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '4700' AND '4799' THEN 'E'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '4800' AND '4899' THEN 'F'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '4900' AND '4999' THEN 'G'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '5000' AND '5199' THEN 'H'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '5200' AND '5999' THEN 'I'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '6000' AND '6299' THEN 'J'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '6300' AND '6499' THEN 'K'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '6500' AND '6799' THEN 'L'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '7000' AND '7999' THEN 'M'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '8000' AND '8099' THEN 'Q'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '8100' AND '8199' THEN 'S'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '8200' AND '8299' THEN 'O'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '8300' AND '8399' THEN 'R'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '8400' AND '8499' THEN 'N'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '8600' AND '8651' THEN 'N'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '8661' AND '8661' THEN 'T'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '8699' AND '8699' THEN 'N'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '8711' AND '8713' THEN 'P'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '8721' AND '8721' THEN 'S'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '8731' AND '8799' THEN 'M'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '8900' AND '8999' THEN 'M'
 WHEN LEFT(INFO_PRISIC_6,4) BETWEEN '9100' AND '9799' THEN 'W'
 ELSE 'Z' end as INFO_INDUSTRY_RECODED
 FROM {iusa-raw-table};

