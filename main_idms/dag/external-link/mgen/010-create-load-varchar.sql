DROP TABLE IF Exists {tablename2};
CREATE TABLE {tablename2} 
(
	dummy VARCHAR(11)  ENCODE ZSTD,
	lems VARCHAR(18) ENCODE ZSTD,
	last_transaction_overall_days VARCHAR(5) ENCODE ZSTD,
	tot_parts VARCHAR(3) ENCODE ZSTD,
	tot_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	tot_trns_12m VARCHAR(3) ENCODE ZSTD,
	tot_dlrs_12m_avg VARCHAR(5) ENCODE ZSTD,
	last_transaction_catalog_days VARCHAR(5) ENCODE ZSTD,
	cat_parts VARCHAR(3) ENCODE ZSTD,
	cat_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	cat_trns_12m VARCHAR(3) ENCODE ZSTD,
	cat_dlrs_12m_avg VARCHAR(5) ENCODE ZSTD,
	last_transaction_web_days VARCHAR(5) ENCODE ZSTD,
	web_parts VARCHAR(3) ENCODE ZSTD,
	web_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	web_trns_12m VARCHAR(3) ENCODE ZSTD,
	last_transaction_retail_days VARCHAR(5) ENCODE ZSTD,
	rtl_parts VARCHAR(3) ENCODE ZSTD,
	rtl_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	rtl_trns_12m VARCHAR(3) ENCODE ZSTD,
	recency_sc01_days VARCHAR(5) ENCODE ZSTD,
	sc01_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc01_dlrs_12m_avg VARCHAR(5) ENCODE ZSTD,
	sc01_trns_12m VARCHAR(3) ENCODE ZSTD,
	sc01_trns_13p VARCHAR(3) ENCODE ZSTD,
	recency_sc02_days VARCHAR(5) ENCODE ZSTD,
	sc02_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc02_dlrs_12m_avg VARCHAR(5) ENCODE ZSTD,
	sc02_trns_12m VARCHAR(3) ENCODE ZSTD,
	recency_sc03_days VARCHAR(5) ENCODE ZSTD,
	sc03_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc03_dlrs_12m_avg VARCHAR(5) ENCODE ZSTD,
	sc03_trns_12m VARCHAR(3) ENCODE ZSTD,
	sc03_trns_13p VARCHAR(3) ENCODE ZSTD,
	recency_sc04_days VARCHAR(5) ENCODE ZSTD,
	sc04_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc04_dlrs_12m_avg VARCHAR(5) ENCODE ZSTD,
	sc04_trns_12m VARCHAR(3) ENCODE ZSTD,
	recency_sc05_days VARCHAR(5) ENCODE ZSTD,
	sc05_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc05_dlrs_12m_avg VARCHAR(5) ENCODE ZSTD,
	sc05_trns_12m VARCHAR(3) ENCODE ZSTD,
	recency_sc06_days VARCHAR(5) ENCODE ZSTD,
	sc06_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc06_dlrs_12m_avg VARCHAR(5) ENCODE ZSTD,
	sc06_trns_12m VARCHAR(3) ENCODE ZSTD,
	recency_sc07_days VARCHAR(5) ENCODE ZSTD,
	sc07_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc07_dlrs_12m_avg VARCHAR(5) ENCODE ZSTD,
	sc07_trns_12m VARCHAR(3) ENCODE ZSTD,
	recency_sc08_days VARCHAR(5) ENCODE ZSTD,
	sc08_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc08_dlrs_12m_avg VARCHAR(5) ENCODE ZSTD,
	sc08_trns_12m VARCHAR(3) ENCODE ZSTD,
	recency_sc09_days VARCHAR(5) ENCODE ZSTD,
	sc09_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc09_dlrs_12m_avg VARCHAR(5) ENCODE ZSTD,
	sc09_trns_12m VARCHAR(3) ENCODE ZSTD,
	recency_sc10_days VARCHAR(5) ENCODE ZSTD,
	sc10_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc10_dlrs_12m_avg VARCHAR(5) ENCODE ZSTD,
	sc10_trns_12m VARCHAR(3) ENCODE ZSTD,
	recency_sc11_days VARCHAR(5) ENCODE ZSTD,
	sc11_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc11_dlrs_12m_avg VARCHAR(5) ENCODE ZSTD,
	sc11_trns_12m VARCHAR(3) ENCODE ZSTD,
	recency_sc12_days VARCHAR(5) ENCODE ZSTD,
	sc12_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc12_dlrs_12m_avg VARCHAR(5) ENCODE ZSTD,
	sc12_trns_12m VARCHAR(3) ENCODE ZSTD,
	recency_sc13_days VARCHAR(5) ENCODE ZSTD,
	sc13_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc13_dlrs_12m_avg VARCHAR(5) ENCODE ZSTD,
	sc13_trns_12m VARCHAR(3) ENCODE ZSTD,
	recency_sc14_days VARCHAR(5) ENCODE ZSTD,
	sc14_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc14_trns_12m VARCHAR(3) ENCODE ZSTD,
	recency_sc15_days VARCHAR(5) ENCODE ZSTD,
	sc15_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc15_trns_12m VARCHAR(3) ENCODE ZSTD,
	recency_sc16_days VARCHAR(5) ENCODE ZSTD,
	sc16_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc16_dlrs_12m_avg VARCHAR(5) ENCODE ZSTD,
	sc16_trns_12m VARCHAR(3) ENCODE ZSTD,
	recency_sc17_days VARCHAR(5) ENCODE ZSTD,
	sc17_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc17_dlrs_12m_avg VARCHAR(5) ENCODE ZSTD,
	sc17_trns_12m VARCHAR(3) ENCODE ZSTD,
	recency_sc18_days VARCHAR(5) ENCODE ZSTD,
	sc18_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc18_trns_12m VARCHAR(3) ENCODE ZSTD,
	recency_sc19_days VARCHAR(5) ENCODE ZSTD,
	sc19_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc19_trns_12m VARCHAR(3) ENCODE ZSTD,
	recency_sc20_days VARCHAR(5) ENCODE ZSTD,
	sc20_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc20_trns_12m VARCHAR(3) ENCODE ZSTD,
	sc20_trns_13p VARCHAR(3) ENCODE ZSTD,
	recency_sc21_days VARCHAR(5) ENCODE ZSTD,
	sc21_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc21_trns_12m VARCHAR(3) ENCODE ZSTD,
	recency_sc22_days VARCHAR(5) ENCODE ZSTD,
	sc22_dlrs_12m VARCHAR(5) ENCODE ZSTD,
	sc22_trns_12m VARCHAR(3) ENCODE ZSTD,
	recency_002_days VARCHAR(5) ENCODE ZSTD,
	recency_003_days VARCHAR(5) ENCODE ZSTD,
	recency_007_days VARCHAR(5) ENCODE ZSTD,
	recency_008_days VARCHAR(5) ENCODE ZSTD,
	recency_013_days VARCHAR(5) ENCODE ZSTD,
	recency_016_days VARCHAR(5) ENCODE ZSTD,
	recency_018_days VARCHAR(5) ENCODE ZSTD,
	recency_019_days VARCHAR(5) ENCODE ZSTD,
	recency_020_days VARCHAR(5) ENCODE ZSTD,
	recency_021_days VARCHAR(5) ENCODE ZSTD,
	recency_026_days VARCHAR(5) ENCODE ZSTD,
	recency_027_days VARCHAR(5) ENCODE ZSTD,
	recency_042_days VARCHAR(5) ENCODE ZSTD,
	recency_043_days VARCHAR(5) ENCODE ZSTD,
	recency_045_days VARCHAR(5) ENCODE ZSTD,
	recency_046_days VARCHAR(5) ENCODE ZSTD,
	recency_047_days VARCHAR(5) ENCODE ZSTD,
	recency_066_days VARCHAR(5) ENCODE ZSTD,
	recency_079_days VARCHAR(5) ENCODE ZSTD,
	recency_091_days VARCHAR(5) ENCODE ZSTD,
	recency_092_days VARCHAR(5) ENCODE ZSTD,
	recency_100_days VARCHAR(5) ENCODE ZSTD,
	recency_109_days VARCHAR(5) ENCODE ZSTD,
	recency_110_days VARCHAR(5) ENCODE ZSTD,
	recency_111_days VARCHAR(5) ENCODE ZSTD,
	recency_119_days VARCHAR(5) ENCODE ZSTD,
	recency_122_days VARCHAR(5) ENCODE ZSTD,
	recency_128_days VARCHAR(5) ENCODE ZSTD,
	recency_129_days VARCHAR(5) ENCODE ZSTD,
	dummy1 VARCHAR(1) ENCODE ZSTD,
	PRIMARY KEY(lems)
)
DISTSTYLE KEY
DISTKEY(lems)
SORTKEY(lems);

copy {tablename2}
from 's3://{s3-internal}{s3-key1}'
iam_role '{iam}'
fixedwidth 
'DUMMY:11,
lems:18,
Last_Transaction_Overall_Days:5,
TOT_PARTS:3,
TOT_DLRS_12M:5,
TOT_TRNS_12M:3,
tot_dlrs_12m_avg:5,
Last_Transaction_Catalog_Days:5,
CAT_PARTS:3,
CAT_DLRS_12M:5,
CAT_TRNS_12M:3,
cat_dlrs_12m_avg:5,
Last_Transaction_Web_Days:5,
WEB_PARTS:3,
WEB_DLRS_12M:5,
WEB_TRNS_12M:3,
Last_Transaction_Retail_Days:5,
RTL_PARTS:3,
RTL_DLRS_12M:5,
RTL_TRNS_12M:3,
Recency_SC01_Days:5,
SC01_DLRS_12M:5,
sc01_dlrs_12m_avg:5,
SC01_TRNS_12M:3,
SC01_TRNS_13P:3,
Recency_SC02_Days:5,
SC02_DLRS_12M:5,
sc02_dlrs_12m_avg:5,
SC02_TRNS_12M:3,
Recency_SC03_Days:5,
SC03_DLRS_12M:5,
sc03_dlrs_12m_avg:5,
SC03_TRNS_12M:3,
SC03_TRNS_13P:3,
Recency_SC04_Days:5,
SC04_DLRS_12M:5,
sc04_dlrs_12m_avg:5,
SC04_TRNS_12M:3,
Recency_SC05_Days:5,
SC05_DLRS_12M:5,
sc05_dlrs_12m_avg:5,
SC05_TRNS_12M:3,
Recency_SC06_Days:5,
SC06_DLRS_12M:5,
sc06_dlrs_12m_avg:5,
SC06_TRNS_12M:3,
Recency_SC07_Days:5,
SC07_DLRS_12M:5,
sc07_dlrs_12m_avg:5,
SC07_TRNS_12M:3,
Recency_SC08_Days:5,
SC08_DLRS_12M:5,
sc08_dlrs_12m_avg:5,
SC08_TRNS_12M:3,
Recency_SC09_Days:5,
SC09_DLRS_12M:5,
sc09_dlrs_12m_avg:5,
SC09_TRNS_12M:3,
Recency_SC10_Days:5,
SC10_DLRS_12M:5,
sc10_dlrs_12m_avg:5,
SC10_TRNS_12M:3,
Recency_SC11_Days:5,
SC11_DLRS_12M:5,
sc11_dlrs_12m_avg:5,
SC11_TRNS_12M:3,
Recency_SC12_Days:5,
SC12_DLRS_12M:5,
sc12_dlrs_12m_avg:5,
SC12_TRNS_12M:3,
Recency_SC13_Days:5,
SC13_DLRS_12M:5,
sc13_dlrs_12m_avg:5,
SC13_TRNS_12M:3,
Recency_SC14_Days:5,
SC14_DLRS_12M:5,
SC14_TRNS_12M:3,
Recency_SC15_Days:5,
SC15_DLRS_12M:5,
SC15_TRNS_12M:3,
Recency_SC16_Days:5,
SC16_DLRS_12M:5,
sc16_dlrs_12m_avg:5,
SC16_TRNS_12M:3,
Recency_SC17_Days:5,
SC17_DLRS_12M:5,
sc17_dlrs_12m_avg:5,
SC17_TRNS_12M:3,
Recency_SC18_Days:5,
SC18_DLRS_12M:5,
SC18_TRNS_12M:3,
Recency_SC19_Days:5,
SC19_DLRS_12M:5,
SC19_TRNS_12M:3,
Recency_SC20_Days:5,
SC20_DLRS_12M:5,
SC20_TRNS_12M:3,
SC20_TRNS_13P:3,
Recency_SC21_Days:5,
SC21_DLRS_12M:5,
SC21_TRNS_12M:3,
Recency_SC22_Days:5,
SC22_DLRS_12M:5,
SC22_TRNS_12M:3,
Recency_002_Days:5,
Recency_003_Days:5,
Recency_007_Days:5,
Recency_008_Days:5,
Recency_013_Days:5,
Recency_016_Days:5,
Recency_018_Days:5,
Recency_019_Days:5,
Recency_020_Days:5,
Recency_021_Days:5,
Recency_026_Days:5,
Recency_027_Days:5,
Recency_042_Days:5,
Recency_043_Days:5,
Recency_045_Days:5,
Recency_046_Days:5,
Recency_047_Days:5,
Recency_066_Days:5,
Recency_079_Days:5,
Recency_091_Days:5,
Recency_092_Days:5,
Recency_100_Days:5,
Recency_109_Days:5,
Recency_110_Days:5,
Recency_111_Days:5,
Recency_119_Days:5,
Recency_122_Days:5,
Recency_128_Days:5,
Recency_129_Days:5,
DUMMY1:1';


alter table {tablename2} drop column DUMMY;
alter table {tablename2} drop column DUMMY1;
