--Assigning ID for occupations File

drop table if exists digital.business_occupations_id;

create table digital.business_occupations_id as
select  row_number() over (partition by 1)+47000004335854 id , *
 from digital.business_occupations e
  order by occupation_id;
---(20,797,200 row(s) affected)     ---QA (149189 row(s) affected)

--Getting Individual IDS associated with occupations file

drop table if exists digital.business_occupations_individual_universe;

create table digital.business_occupations_individual_universe as
select individual_id e_individualid
from digital.business_occupations_id
where (individual_id != '000000000000' and individual_id != '')
group by individual_id;
---(7551028 row(s) affected)      ---QA (31413 row(s) affected)

--Retrieving consumer emails associated with IndividualIDs in Occupations file

drop table if exists digital.business_occupations_email_matches;

create table digital.business_occupations_email_matches as
select em.vendorid2 em_vendorid,   em.id em_id, em.individualid em_indiv_id, em.emailaddress em_emailaddress, em.firstname em_firstname, em.lastname em_lastname
from   digital.business_occupations_individual_universe u
join digital.consumer_email_full_compressed em
on ( em.individualid = u.e_individualid);
---(10213501 row(s) affected)        ---QA (121346 row(s) affected)

--Joining occupations with Consumer Email Records and assigning unique id

drop table if exists digital.business_occupations_email_enhancements;

create table digital.business_occupations_email_enhancements as
select  row_number() over (partition by 1)+57000004335854 row_id ,
        em_vendorid,  em_id, em_indiv_id, em_emailaddress, em_firstname,em_lastname, e.*
from digital.business_occupations_id  e join digital.business_occupations_email_matches em
on ( em.em_indiv_id = e.individual_id)
order by em_vendorid;
---(13545801 row(s) affected)      ---QA (180734 row(s) affected)

--Getting Family IDS associated with occupations file

drop table if exists digital.business_occupations_family_universe;

create table digital.business_occupations_family_universe as
select family_id e_familyid
from digital.business_occupations_id
where (family_id != '000000000000' and family_id != '')
and ( individual_id != '' and  individual_id != '000000000000')
group by family_id;
---(7166677 row(s) affected)      ---QA (30147 row(s) affected)

--Retrieving consumer emails associated with FamilyIDs in Occupations file

drop table if exists digital.business_occupations_family_email_matches;

create table digital.business_occupations_family_email_matches as
select em.vendorid2 em_vendorid,   em.id em_id, em.individualid em_indiv_id, em.emailaddress em_emailaddress, em.firstname em_firstname, em.lastname em_lastname,
em.familyid em_familyid
from   digital.business_occupations_family_universe u
join digital.consumer_email_full_compressed em
on ( em.familyid = u.e_familyid);
---(27094849 row(s) affected)            ---QA (234826 row(s) affected)

--Joining occupations with Matched Consumer Email Records and assigning unique id


drop table if exists digital.business_occupations_family_email_enhancements;

create table digital.business_occupations_family_email_enhancements as
select  row_number() over (partition by 1)+67000004335854 row_id ,
         em_vendorid,    em.em_indiv_id, em_emailaddress,  em_firstname,  em_lastname, e.*
from digital.business_occupations_id  e join digital.business_occupations_family_email_matches em
on ( em.em_familyid = e.family_id)
order by em_vendorid;
---(38500869 row(s) affected)       ---QA (369867 row(s) affected)

-- Capturing Occupations Records that matched with Consumer email either by IndividualID
-- or by FamilyID

drop table if exists digital.business_occupations_id_matched_emails;

create table digital.business_occupations_id_matched_emails as
select id
from digital.business_occupations_email_enhancements
group by id;
---(5712890 row(s) affected)       ---QA (28006 row(s) affected)

insert into digital.business_occupations_id_matched_emails (
id
)
select id
 from digital.business_occupations_family_email_enhancements
 group by id;
---(7071835 row(s) affected)     ---QA (33676 row(s) affected)

--Getting unique list of occupation ids that matched to consumer email

drop table if exists digital.business_matched_ids;

create table digital.business_matched_ids as
select id
from digital.business_occupations_id_matched_emails
group by id;
---(7102324 row(s) affected)      ---QA (33810 row(s) affected)

--Deriving occupation records that did not match to consumer email records

drop table if exists digital.business_occupations_nonmatches;

create table digital.business_occupations_nonmatches as
select e.*
from digital.business_occupations_id e left outer join digital.business_matched_ids i on ( e.id = i.id )
where i.id is null;
---(13694876 row(s) affected)     ---QA (115379 row(s) affected)

-- Building segments for nonmatches

drop table if exists digital.business_occupations_nonmatches_segments;

create table digital.business_occupations_nonmatches_segments as
select
  Right('000000000000000000'+e.id,18) id,
  id orig_id,
 '00' e_executivesourcecode,
 Right('00'+'2',2) e_vendorid2,
 '000000000' abinumber,
  e.individual_id inidividualid,
 e.family_id familyid,
e.first_name e_firstname , e.last_name e_lastname , AREA_CODE+ PHONE_NUMBER phonenumber,
'' email,
'' orig_email,
'' m_address_mailing, '' m_city_mailing,
'' m_state_mailing, '' m_zipcode_mailing, '' m_zipfour_mailing,
address,
city,state,ZIP_CODE zipcode,zip_four zipfour,
'' m_address_landmark,
'' m_city_landmark,
'' m_state_landmark,
'' m_zipcode_landmark,
'' m_zipfour_landmark,
'' e_homeaddress,
'' e_homecity,
'' e_homestate,
'' e_homezipcode,
'' e_homezip4,
'' fulfillmentflag,
'OCCUPATIONS_NONMATCHES' dataset,
cast(NULL as int) b0001,
CASE WHEN SIC_CODE IN ('075102', '208401', '794803') THEN 1 END as b0002,
cast(NULL as int) b0003,
cast(NULL as int) b0004,
cast(NULL as int) b0005,
cast(NULL as int) b0006,
cast(NULL as int) b0007,
cast(NULL as int) b0008,
cast(NULL as int) b0009,
cast(NULL as int) b0010,
cast(NULL as int) b0011,
cast(NULL as int) b0012,
case when ( sic_code IN ('591205', '599504', '599900', '801101', '801121', '804101', '804201', '804301', '804900', '804902', '804904', '804911', '804912', '804913', '804914', '804918', '804919', '804922', '804924', '804925', '804926', '804951', '804964', '805101', '805999', '806301', '807118', '808201', '809900', '832281', '839911', '899905')   OR
( sic_code='832201' AND SPECIALTY_TITLE IN ('MENTAL HEALTH COUNSELOR', 'ADDICTION COUNSELOR', 'CLINICAL', 'BEHAVIORAL', 'DEVELOPMENTAL DISABILITY/RETARDATION', 'NEUROPSYCHOLOGIST', 'REHABILITATION', 'AGING/ADULT') )  OR
( sic_code='832204' AND SPECIALTY_TITLE IN ('ADDICTION COUNSELOR', 'CLINICAL') ) ) then 1 END as b0013,
 case when (  sic_code='628203' ) then 1 END as b0014,
 cast(NULL as int) b0015,
cast(NULL as int) b0016,
case when (sic_code IN ('614101', '673303', '872105', '874209') ) THEN 1 END as b0017,
cast(NULL as int) b0018,
cast(NULL as int) b0019,
cast(NULL as int) b0020,
cast(NULL as int) b0021,
cast(NULL as int) b0022,
case when (sic_code='804908') THEN 1 END as b0023,
case when sic_code IN ('871120', '871122', '871103', '871107', '871108', '871109', '871110', '871111', '871112', '871114', '871118', '871119', '871123', '871124', '871125', '871126', '871130', '871132', '871133', '871137', '871138', '871143', '871152', '871158', '871161', '871162', '871211', '873112', '873130', '874853', '874855', '899904')  OR
 (sic_code IN ('871106', '871115', '871159')  AND OCCUPATION_TITLE IN ('ENGINEER PROFESSIONAL', 'ENGINEER INTERN', 'ENGINEER TEMPORARY LICENSE') ) THEN 1 END as b0024,
cast(NULL as int) b0025,
cast(NULL as int) b0026,
cast(NULL as int) b0027,
cast(NULL as int) b0028,
cast(NULL as int) b0029,
case when sic_code IN ('736109', '738920', '781908', '822100', '823106') then 1 end as b0030,
cast(NULL as int) b0031,
cast(NULL as int) b0032,
cast(NULL as int) b0033,
cast(NULL as int) b0034,
case when (SIC_CODE >=  801111  AND SIC_CODE <=  801114 ) OR  ( SIC_CODE >=   801118  AND SIC_CODE <=  801131 )  OR  ( SIC_CODE >=  804301 AND SIC_CODE <= 804304 )  OR  SIC_CODE IN ('801101','801105','801108','801137','801138','804901','802108') then 1 end as b0035,
cast(NULL as int) b0036,
case when sic_code IN ('874301', '874824', '912113')  then 1 end as b0037,
cast(NULL as int) b0038,
cast(NULL as int) b0039,
case when sic_code IN ('591205', '599504', '599900', '801101', '801121', '804101', '804201', '804301', '804900', '804902', '804904', '804911', '804912', '804913', '804914', '804918', '804919', '804922', '804924', '804925', '804926', '804951', '804964', '805101', '805999', '806301', '807118', '808201', '809900', '832281', '839911', '899905')   OR
( sic_code='832201' AND specialty_title IN ('MENTAL HEALTH COUNSELOR', 'ADDICTION COUNSELOR', 'CLINICAL', 'BEHAVIORAL', 'DEVELOPMENTAL DISABILITY/RETARDATION', 'NEUROPSYCHOLOGIST', 'REHABILITATION', 'AGING/ADULT') )  OR
( sic_code='832204' AND specialty_title IN ('ADDICTION COUNSELOR', 'CLINICAL') ) then 1 end as b0040,
cast(NULL as int) b0041,
cast(NULL as int) b0042,
cast(NULL as int) b0043,
cast(NULL as int) b0044,
cast(NULL as int) b0045,
cast(NULL as int) b0046,
cast(NULL as int) b0047,
cast(NULL as int) b0048,
cast(NULL as int) b0049,
cast(NULL as int) b0050,
cast(NULL as int) b0051,
cast(NULL as int) b0052,
cast(NULL as int) b0053,
cast(NULL as int) b0054,
cast(NULL as int) b0055,
cast(NULL as int) b0056,
cast(NULL as int) b0057,
cast(NULL as int) b0058,
cast(NULL as int) b0059,
cast(NULL as int) b0060,
cast(NULL as int) b0061,
cast(NULL as int) b0062,
cast(NULL as int) b0063,
cast(NULL as int) b0064,
cast(NULL as int) b0065,
cast(NULL as int) b0066,
cast(NULL as int) b0067,
cast(NULL as int) b0068,
cast(NULL as int) b0069,
cast(NULL as int) b0070,
cast(NULL as int) b0071,
cast(NULL as int) b0072,
cast(NULL as int) b0073,
cast(NULL as int) b0074,
cast(NULL as int) b0075,
cast(NULL as int) b0076,
cast(NULL as int) b0077,
cast(NULL as int) b0078,
cast(NULL as int) b0079,
cast(NULL as int) b0080,
cast(NULL as int) b0081,
cast(NULL as int) b0082,
cast(NULL as int) b0083,
cast(NULL as int) b0084,
cast(NULL as int) b0085,
cast(NULL as int) b0086,
cast(NULL as int) b0087,
cast(NULL as int) b0088,
cast(NULL as int) b0089,
cast(NULL as int) b0090,
cast(NULL as int) b0091,
cast(NULL as int) b0092,
cast(NULL as int) b0093,
cast(NULL as int) b0094,
cast(NULL as int) b0095,
cast(NULL as int) b0096,
cast(NULL as int) b0097,
cast(NULL as int) b0098,
cast(NULL as int) b0099,
cast(NULL as int) b0100,
cast(NULL as int) b0101,
cast(NULL as int) b0102,
cast(NULL as int) b0103,
cast(NULL as int) b0104,
cast(NULL as int) b0105,
cast(NULL as int) b0106,
cast(NULL as int) b0107,
cast(NULL as int) b0108,
---cast(NULL as int) b0109,
cast(NULL as int) b0110,
cast(NULL as int) b0111,
cast(NULL as int) b0112,
cast(NULL as int) b0113,
cast(NULL as int) b0114,
cast(NULL as int) b0115,
cast(NULL as int) b0116,
cast(NULL as int) b0117,
cast(NULL as int) b0118,
cast(NULL as int) b0119,
cast(NULL as int) b0120,
cast(NULL as int) b0121,
cast(NULL as int) b0122,
cast(NULL as int) b0123,
cast(NULL as int) b0124,
cast(NULL as int) b0125,
cast(NULL as int) b0126,
cast(NULL as int) b0127,
cast(NULL as int) b0128,
cast(NULL as int) b0129,
cast(NULL as int) b0130,
cast(NULL as int) b0131,
cast(NULL as int) b0132,
cast(NULL as int) b0133,
cast(NULL as int) b0134,
cast(NULL as int) b0135,
cast(NULL as int) b0136,
cast(NULL as int) b0137,
cast(NULL as int) b0138,
cast(NULL as int) b0139,
cast(NULL as int) b0140,
cast(NULL as int) b0141,
cast(NULL as int) b0142,
cast(NULL as int) b0143,
cast(NULL as int) b0144,
cast(NULL as int) b0145,
cast(NULL as int) b0146,
cast(NULL as int) b0147,
cast(NULL as int) b0148,
cast(NULL as int) b0149,
cast(NULL as int) b0150,
cast(NULL as int) b0151,
cast(NULL as int) b0152,
cast(NULL as int) b0153,
--changes
/*
cast(NULL as int) b0154,
cast(NULL as int) b0155,
cast(NULL as int) b0156,
cast(NULL as int) b0157,
cast(NULL as int) b0158,
cast(NULL as int) b0159,
cast(NULL as int) b0160,
cast(NULL as int) b0161,
cast(NULL as int) b0162,
cast(NULL as int) b0163,
cast(NULL as int) b0164,
cast(NULL as int) b0165,
cast(NULL as int) b0166,
cast(NULL as int) b0167,
cast(NULL as int) b0168,
cast(NULL as int) b0169,
cast(NULL as int) b0170,
cast(NULL as int) b0171,
cast(NULL as int) b0172,
cast(NULL as int) b0173,
cast(NULL as int) b0174,
cast(NULL as int) b0175,
cast(NULL as int) b0176,
cast(NULL as int) b0177,
cast(NULL as int) b0178,
cast(NULL as int) b0179,
cast(NULL as int) b0180,
cast(NULL as int) b0181,
cast(NULL as int) b0182,
cast(NULL as int) b0183,
cast(NULL as int) b0184,
cast(NULL as int) b0185,
cast(NULL as int) b0186,
cast(NULL as int) b0187,
cast(NULL as int) b0188,
cast(NULL as int) b0189,
cast(NULL as int) b0190,
cast(NULL as int) b0191,
cast(NULL as int) b0192,
cast(NULL as int) b0193,
cast(NULL as int) b0194,
cast(NULL as int) b0195,
cast(NULL as int) b0196,
cast(NULL as int) b0197,
cast(NULL as int) b0198,
cast(NULL as int) b0199,
cast(NULL as int) b0200,
cast(NULL as int) b0201,
cast(NULL as int) b0202,
cast(NULL as int) b0203,
cast(NULL as int) b0204,
cast(NULL as int) b0205,
cast(NULL as int) b0206,
cast(NULL as int) b0207,
cast(NULL as int) b0208,
cast(NULL as int) b0209,
cast(NULL as int) b0210,
cast(NULL as int) b0211,
cast(NULL as int) b0212,
cast(NULL as int) b0213,
cast(NULL as int) b0214,
cast(NULL as int) b0215,
cast(NULL as int) b0216,
cast(NULL as int) b0217,
cast(NULL as int) b0218,
cast(NULL as int) b0219,
cast(NULL as int) b0220,
cast(NULL as int) b0221,
cast(NULL as int) b0222,
cast(NULL as int) b0223,
cast(NULL as int) b0224,
cast(NULL as int) b0225,
cast(NULL as int) b0226,
cast(NULL as int) b0227,
cast(NULL as int) b0228,
cast(NULL as int) b0229,
cast(NULL as int) b0230,
cast(NULL as int) b0231,
cast(NULL as int) b0232,
cast(NULL as int) b0233,
cast(NULL as int) b0234,
cast(NULL as int) b0235,
  */
  /*
cast(NULL as int) b0236,
cast(NULL as int) b0237,
cast(NULL as int) b0238,
cast(NULL as int) b0239,
cast(NULL as int) b0240,
cast(NULL as int) b0241,
cast(NULL as int) b0242,
cast(NULL as int) b0243,
cast(NULL as int) b0244,
cast(NULL as int) b0245,
cast(NULL as int) b0246,
cast(NULL as int) b0247,
cast(NULL as int) b0248,
cast(NULL as int) b0249,
cast(NULL as int) b0250,
cast(NULL as int) b0251,
cast(NULL as int) b0252,
cast(NULL as int) b0253,
cast(NULL as int) b0254,
cast(NULL as int) b0255,
cast(NULL as int) b0256,
cast(NULL as int) b0257,
cast(NULL as int) b0258,
cast(NULL as int) b0259,
cast(NULL as int) b0260,
cast(NULL as int) b0261,
cast(NULL as int) b0262,
cast(NULL as int) b0263,
cast(NULL as int) b0264,
cast(NULL as int) b0265,
cast(NULL as int) b0266,
cast(NULL as int) b0267,
cast(NULL as int) b0268,
cast(NULL as int) b0269,
cast(NULL as int) b0270,
cast(NULL as int) b0271,
cast(NULL as int) b0272,
cast(NULL as int) b0273,
cast(NULL as int) b0274,
cast(NULL as int) b0275,
cast(NULL as int) b0276,
cast(NULL as int) b0277,
cast(NULL as int) b0278,
cast(NULL as int) b0279,
cast(NULL as int) b0280,
cast(NULL as int) b0281,
cast(NULL as int) b0282,
cast(NULL as int) b0283,
cast(NULL as int) b0284,
cast(NULL as int) b0285,
cast(NULL as int) b0286,
   */
/*
cast(NULL as int) b0287,
cast(NULL as int) b0288,
cast(NULL as int) b0289,
cast(NULL as int) b0290,
cast(NULL as int) b0291,
cast(NULL as int) b0292,
cast(NULL as int) b0293,
cast(NULL as int) b0294,
cast(NULL as int) b0295,
cast(NULL as int) b0296,
cast(NULL as int) b0297,
cast(NULL as int) b0298,
  */
cast(NULL as int) b0299,
cast(NULL as int) b0300,
cast(NULL as int) b0301,
cast(NULL as int) b0302,
cast(NULL as int) b0303,
--changes
---cast(NULL as int) b0304,
---cast(NULL as int) b0305,
cast(NULL as int) b0306,
cast(NULL as int) b0307,
/*
cast(NULL as int) b0308,
cast(NULL as int) b0309,
cast(NULL as int) b0310,
cast(NULL as int) b0311,
cast(NULL as int) b0312,
cast(NULL as int) b0313,
cast(NULL as int) b0314,
cast(NULL as int) b0315,
cast(NULL as int) b0316,
cast(NULL as int) b0317,
cast(NULL as int) b0318,
cast(NULL as int) b0319,
cast(NULL as int) b0320,
cast(NULL as int) b0321,
cast(NULL as int) b0322,
  */
cast(NULL as int) b0323,
cast(NULL as int) b0324,
cast(NULL as int) b0325,
cast(NULL as int) b0326,
cast(NULL as int) b0327,
cast(NULL as int) b0328,
cast(NULL as int) b0329,
cast(NULL as int) b0330,
cast(NULL as int) b0331,
cast(NULL as int) b0332,
cast(NULL as int) b0333,
cast(NULL as int) b0334,
cast(NULL as int) b0335,
cast(NULL as int) b0336,
cast(NULL as int) b0337,
cast(NULL as int) b0338,
cast(NULL as int) b0339,
cast(NULL as int) b0340,
/*
cast(NULL as int) b0341,
cast(NULL as int) b0342,
cast(NULL as int) b0343,
cast(NULL as int) b0344,
cast(NULL as int) b0345,
cast(NULL as int) b0346,
cast(NULL as int) b0347,
cast(NULL as int) b0348,
case when OCCUPATION_TITLE IN ('AGENT','INSURANCE AGENT','REAL ESTATE SALES','SPORTS AGENTS','TALENT AGENT') then 1 end as b0349,
  */
case when OCCUPATION_TITLE = 'MIDWIFE (NOT RN)' OR SPECIALTY_TITLE='MIDWIFE' then 1 end as b0350,
case when OCCUPATION_TITLE = 'NURSE REGISTERED (RN)' AND specialty_title='NURSE PRACTITIONER' then 1 end as b0351,
case when OCCUPATION_TITLE = 'ACCOUNTANT' then 1 end as b0352,
case when OCCUPATION_TITLE = 'CHIROPRACTOR' then 1 end as b0353,
case when OCCUPATION_TITLE = 'DENTIST' then 1 end as b0354,
cast(NULL as int) b0355,
case when OCCUPATION_TITLE = 'DENTIST' then 1 end as b0356,
case when OCCUPATION_TITLE = 'PODIATRIST' then 1 end as  b0357,
cast(NULL as int) b0358,
case when OCCUPATION_TITLE = 'VETERINARIAN' then 1 end as  b0359,
case when OCCUPATION_TITLE = 'NURSE PRACTICAL (LPN)' then 1 end as  b0360,
case when OCCUPATION_TITLE = 'DOCTORS/PHYSICIANS' then 1 end as  b0361,
case when SPECIALTY_TITLE='NURSE PRACTITIONER' then 1 end as  b0362,
case when SPECIALTY_TITLE='OPTOMETRIST (OD)' then 1 end as  b0363,
case when OCCUPATION_TITLE = 'THERAPIST' AND SPECIALTY_TITLE ='OCCUPATIONAL' then 1 end as b0364,
case when SPECIALTY_TITLE = 'PHYSICIAN''S ASSISTANT' then 1 end as b0365,
case when OCCUPATION_TITLE = 'ENGINEER PROFESSIONAL' then 1 end as b0366,
cast(NULL as int) b0367,
case when OCCUPATION_TITLE = 'THERAPIST' AND SPECIALTY_TITLE='PHYSICAL (LICENSED)' then 1 end as b0368,
case when OCCUPATION_TITLE = 'NURSE REGISTERED (RN)' then 1 end as b0369,
case when OCCUPATION_TITLE = 'NATUROPATHIC/HOMEOPATHIC PHYSICIAN OR COUNSELOR' then 1 end as b0370,
/*
cast(NULL as int) b0371,
cast(NULL as int) b0372,
cast(NULL as int) b0373,
cast(NULL as int) b0374,
  */
cast(NULL as int) b0375,
---cast(NULL as int) b0376,
---cast(NULL as int) b0377,
cast(NULL as int) b0378,
cast(NULL as int) b0379,
cast(NULL as int) b0380,
cast(NULL as int) b0381,
cast(NULL as int) b0382,
cast(NULL as int) b0383,
cast(NULL as int) b0384,
cast(NULL as int) b0385,
cast(NULL as int) b0386,
cast(NULL as int) b0387,
cast(NULL as int) b0388,
cast(NULL as int) b0389,
cast(NULL as int) b0390,
cast(NULL as int) b0391,
cast(NULL as int) b0392,
cast(NULL as int) b0393,
cast(NULL as int) b0394,
cast(NULL as int) b0395,
cast(NULL as int) b0396,
cast(NULL as int) b0397,
cast(NULL as int) b0398,
cast(NULL as int) b0399,
cast(NULL as int) b0400,
cast(NULL as int) b0401,
cast(NULL as int) b0402,
cast(NULL as int) b0403,
cast(NULL as int) b0404,
cast(NULL as int) b0405,
cast(NULL as int) b0406,
cast(NULL as int) b0407,
cast(NULL as int) b0408,
cast(NULL as int) b0409,
cast(NULL as int) b0410,
cast(NULL as int) b0411,
cast(NULL as int) b0412,
cast(NULL as int) b0413,
cast(NULL as int) b0414,
cast(NULL as int) b0415,
cast(NULL as int) b0416,
cast(NULL as int) b0417,
cast(NULL as int) b0418,
cast(NULL as int) b0419,
cast(NULL as int) b0420,
cast(NULL as int) b0421,
cast(NULL as int) b0422,
cast(NULL as int) b0423,
cast(NULL as int) b0424,
cast(NULL as int) b0425,
cast(NULL as int) b0426,
cast(NULL as int) b0427,
cast(NULL as int) b0428,
cast(NULL as int) b0429,
cast(NULL as int) b0430,
cast(NULL as int) b0431,
cast(NULL as int) b0432,
cast(NULL as int) b0433,
cast(NULL as int) b0434,
cast(NULL as int) b0435,
cast(NULL as int) b0436,
cast(NULL as int) b0437,
cast(NULL as int) b0438,
cast(NULL as int) b0439,
cast(NULL as int) b0440,
cast(NULL as int) b0441,
cast(NULL as int) b0442,
cast(NULL as int) b0443,
cast(NULL as int) b0444,
cast(NULL as int) b0445,
cast(NULL as int) b0446,
cast(NULL as int) b0447,
cast(NULL as int) b0448,
cast(NULL as int) b0449,
cast(NULL as int) b0450,
cast(NULL as int) b0451,
cast(NULL as int) b0452,
cast(NULL as int) b0453,
cast(NULL as int) b0454,
cast(NULL as int) b0455,
cast(NULL as int) b0456,
---
cast(NULL as int) b0457,
cast(NULL as int) b0458,
cast(NULL as int) b0459,
cast(NULL as int) b0460,
case when (sic_code IN('801101','801105','801108','801111','801112','801113','801114','801137','801138','804301','804302','804303','804304','804901','802108') OR
                   sic_code between 801118 and 801131) then 1 end B0461,
case when SPECIALTY_TITLE ='Pediatrics' then 1 end B0462,
case when substring(sic_code,1,2) = '35' then 1 end B0463,
case when substring(sic_code,1,2) = '15' then 1 end B0464,
case when sic_code IN('621101','621104','621105','621109','621110','621111','874209') OR
                sic_code between 628200 and 628299 OR substring(sic_code,1,3) IN('602','603','604','606') then 1 end B0465,
case when sic_code in('124101','138101','138210','138902','138930','153101','154220','154236','161114','162202','162304','162321','162904','162912','162917','162925','811110','832290')
                       OR substring(sic_code,1,2) = '17' then 1 end B0466,
case when SIC_CODE in('801104','801113','803198','804398','804999','809399') OR
                 ((sic_code between 801101 and 801138 or sic_code between 804301 and 804398) and sic_code not in('801105')) then 1 end B0467,
cast(NULL as int) b0468,
case when sic_code in('431101') then 1 end B0469,
case when substring(SIC_CODE,1,2) in('01','02') then 1 end B0470,
cast(NULL as int) b0471,
cast(NULL as int) b0472,
case when sic_code in('653117') then 1 end B0473,
cast(NULL as int) b0474,
cast(NULL as int) b0475,
cast(NULL as int) b0476,
cast(NULL as int) b0477,
cast(NULL as int) b0478,
cast(NULL as int) b0479,
cast(NULL as int) b0480,
cast(NULL as int) b0481,
cast(NULL as int) b0482,
cast(NULL as int) b0483,
cast(NULL as int) b0484,
cast(NULL as int) b0485,
cast(NULL as int) b0486,
cast(NULL as int) b0487,
cast(NULL as int) b0488,
cast(NULL as int) b0489,
cast(NULL as int) b0490,
cast(NULL as int) b0491,
cast(NULL as int) b0492,
cast(NULL as int) b0493,
cast(NULL as int) b0494,
---

cast(NULL as int) b0495,
cast(NULL as int) b0496,
cast(NULL as int) b0497,
cast(NULL as int) b0498,
cast(NULL as int) b0499,
cast(NULL as int) b0500,
cast(NULL as int) b0501,
cast(NULL as int) b0502,
cast(NULL as int) b0503,
cast(NULL as int) b0504,
cast(NULL as int) b0505,
cast(NULL as int) b0506,
cast(NULL as int) b0507,
cast(NULL as int) b0508,
cast(NULL as int) b0509,
cast(NULL as int) b0510,
cast(NULL as int) b0511,
cast(NULL as int) b0512,
cast(NULL as int) b0513,
cast(NULL as int) b0514,
cast(NULL as int) b0515,
cast(NULL as int) b0516,
cast(NULL as int) b0517,
cast(NULL as int) b0518,
cast(NULL as int) b0519,
cast(NULL as int) b0520,
cast(NULL as int) b0521,
cast(NULL as int) b0522,
cast(NULL as int) b0523,
cast(NULL as int) b0524,
cast(NULL as int) b0525,
cast(NULL as int) b0526,
cast(NULL as int) b0527,
cast(NULL as int) b0528,
cast(NULL as int) b0529,
cast(NULL as int) b0530,
cast(NULL as int) b0531,
cast(NULL as int) b0532,
cast(NULL as int) b0533,
cast(NULL as int) b0534,
cast(NULL as int) b0535,
cast(NULL as int) b0536,
cast(NULL as int) b0537,
cast(NULL as int) b0538,
cast(NULL as int) b0539,
cast(NULL as int) b0540,
cast(NULL as int) b0541,
cast(NULL as int) b0542,
cast(NULL as int) b0543,
cast(NULL as int) b0544,
cast(NULL as int) b0545,
cast(NULL as int) b0546,
cast(NULL as int) b0547,
cast(NULL as int) b0548,
cast(NULL as int) b0549,
cast(NULL as int) b0550,
cast(NULL as int) b0551,
cast(NULL as int) b0552,
cast(NULL as int) b0553,
cast(NULL as int) b0554,
cast(NULL as int) b0555,
cast(NULL as int) b0556,
cast(NULL as int) b0557,
cast(NULL as int) b0558,
cast(NULL as int) b0559,
cast(NULL as int) b0560,
cast(NULL as int) b0561,
cast(NULL as int) b0562,
cast(NULL as int) b0563,
cast(NULL as int) b0564,
cast(NULL as int) b0565,
cast(NULL as int) b0566,
cast(NULL as int) b0567,
cast(NULL as int) b0568,
cast(NULL as int) b0569,
cast(NULL as int) b0570,
cast(NULL as int) b0571,
cast(NULL as int) b0572,
cast(NULL as int) b0573,
cast(NULL as int) b0574,
cast(NULL as int) b0575,
cast(NULL as int) b0576,
cast(NULL as int) b0577,
cast(NULL as int) b0578,
CASE WHEN	sic_code between 830000 and 839999	then 1 end	B0579,
cast(NULL as int) b0580,
cast(NULL as int) b0581,
cast(NULL as int) b0582,
cast(NULL as int) b0583,
cast(NULL as int) b0584,
cast(NULL as int) b0585,
cast(NULL as int) b0586,
cast(NULL as int) b0587,
cast(NULL as int) b0588,
cast(NULL as int) b0589,
cast(NULL as int) b0590,
cast(NULL as int) b0591

 from  digital.business_occupations_nonmatches e;
---(13694876 row(s) affected)    ---QA (115379 row(s) affected)

--Inserting NonMatches into segments_bb_vv
-- ID should have 'P' Instead of 'B' for occupation records
-- ABI Number is set '000000000'
-- Vendorid2 is set to '00'
-- These records will only have address. They dont have associated email
---create a backup
---select * into segments_bb_vv_B4_Inserting_NonMatches from segments_bb_vv
---(344038307 row(s) affected)

insert into digital.business_segments_bb_vv_aws  (
business_Exec_ID,
id,
e_executivesourcecode,
abinumber,
e_vendorid2,
e_firstname,
e_lastname,
phonenumber,
email,
orig_email,
m_address_mailing,
m_city_mailing,
m_state_mailing,
m_zipcode_mailing,
m_zipfour_mailing,
address,
city,
state,
zipcode,
zipfour,
m_address_landmark,
m_city_landmark,
m_state_landmark,
m_zipcode_landmark,
m_zipfour_landmark,
e_homeaddress,
e_homecity,
e_homestate,
e_homezipcode,
e_homezip4,
fulfillmentflag,
dataset,
B0001, B0002, B0003, B0004, B0005, B0006, B0007, B0008, B0009, B0010, B0011, B0012, B0013, B0014, B0015, B0016, B0017, B0018, B0019, B0020, B0021, B0022, B0023, B0024, B0025, B0026, B0027, B0028, B0029, B0030, B0031, B0032, B0033, B0034, B0035, B0036, B0037, B0038, B0039, B0040, B0041, B0042, B0043, B0044, B0045, B0046, B0047, B0048, B0049, B0050, B0051, B0052, B0053, B0054, B0055, B0056, B0057, B0058, B0059, B0060, B0061, B0062, B0063, B0064, B0065, B0066, B0067, B0068, B0069, B0070, B0071, B0072, B0073, B0074, B0075, B0076, B0077, B0078, B0079, B0080, B0081, B0082, B0083, B0084, B0085, B0086, B0087, B0088, B0089, B0090, B0091, B0092, B0093, B0094, B0095, B0096, B0097, B0098, B0099, B0100, B0101, B0102, B0103, B0104, B0105, B0106, B0107, B0108, B0110, B0111, B0112, B0113, B0114, B0115, B0116, B0117, B0118, B0119, B0120, B0121, B0122, B0123, B0124, B0125, B0126, B0127, B0128, B0129, B0130, B0131, B0132, B0133, B0134, B0135, B0136, B0137, B0138, B0139, B0140, B0141, B0142, B0143, B0144, B0145, B0146, B0147, B0148, B0149, B0150, B0151, B0152, B0153, B0299, B0300, B0301, B0302, B0303, B0306, B0307, B0323, B0324, B0325, B0326, B0327, B0328, B0329, B0330, B0331, B0332, B0333, B0334, B0335, B0336, B0337, B0338, B0339, B0340, B0350, B0351, B0352, B0353, B0354, B0355, B0356, B0357, B0358, B0359, B0360, B0361, B0362, B0363, B0364, B0365, B0366, B0367, B0368, B0369, B0370, B0375, B0378, B0379, B0380, B0381, B0382, B0383, B0384, B0385, B0386, B0387, B0388, B0389, B0390, B0391, B0392, B0393, B0394, B0395, B0396, B0397, B0398, B0399, B0400, B0401, B0402, B0403, B0404, B0405, B0406, B0407, B0408, B0409, B0410, B0411, B0412, B0413, B0414, B0415, B0416, B0417, B0418, B0419, B0420, B0421, B0422, B0423, B0424, B0425, B0426, B0427, B0428, B0429, B0430, B0431, B0432, B0433, B0434, B0435, B0436, B0437, B0438, B0439, B0440, B0441, B0442, B0443, B0444, B0445, B0446, B0447, B0448, B0449, B0450, B0451, B0452, B0453, B0454, B0455, B0456,
---
B0457   ,
B0458   ,
B0459   ,
B0460   ,
B0461   ,
B0462   ,
B0463   ,
B0464   ,
B0465   ,
B0466   ,
B0467   ,
B0468   ,
B0469   ,
B0470   ,
B0471   ,
B0472   ,
B0473   ,
B0474   ,
B0475   ,
B0476   ,
B0477   ,
B0478   ,
B0479   ,
B0480   ,
B0481   ,
B0482   ,
B0483   ,
B0484   ,
B0485   ,
B0486   ,
B0487   ,
B0488   ,
B0489   ,
B0490   ,
B0491   ,
B0492   ,
B0493   ,
B0494   ,
---

B0495, B0496, B0497, B0498, B0499, B0500, B0501, B0502, B0503, B0504, B0505, B0506, B0507, B0508, B0509, B0510, B0511, B0512, B0513, B0514, B0515, B0516, B0517, B0518,
B0519, B0520, B0521, B0522,	B0523, B0524, B0525, B0526, B0527, B0528, B0529, B0530, B0531, B0532, B0533, B0534, B0535, B0536, B0537, B0538, B0539, B0540, B0541, B0542,
B0543, B0544, B0545, B0546, B0547, B0548, B0549, B0550, B0551, B0552, B0553, B0554, B0555, B0556, B0557, B0558, B0559, B0560, B0561, B0562, B0563, B0564, B0565, B0566,
B0567, B0568, B0569, B0570, B0571, B0572, B0573, B0574, B0575, B0576, B0577, B0578, B0579, B0580, B0581, B0582, B0583, B0584, B0585, B0586, B0587, B0588, B0589, B0590,
B0591

)
select
--'000000000' New_ID,
'P'+
case when ltrim(rtrim(inidividualid)) != '' then Right('000000000000'+inidividualid,12)  else '000000000000' end
+'-'+ 'P'  + Right('00000000000000'+id ,14)  +  '-'+ '00'  business_Exec_ID ,
 id  ,
 '00',
 '000000000',
 '00',
e_firstname     ,
e_lastname      ,
phonenumber     ,
''   ,
'',
'' m_address_mailing       ,
'' m_city_mailing  ,
'' m_state_mailing ,
'' m_zipcode_mailing       ,
'' m_zipfour_mailing       ,
 address ,
 city    ,
 state   ,
 zipcode ,
 zipfour ,
'' m_address_landmark      ,
'' m_city_landmark ,
'' m_state_landmark        ,
'' m_zipcode_landmark      ,
'' m_zipfour_landmark      ,
'' e_homeaddress,
'' e_homecity,
'' e_homestate,
'' e_homezipcode,
'' e_homezip4,
'' fulfillmentflag,
dataset,
B0001	,
B0002	,
B0003	,
B0004	,
B0005	,
B0006	,
B0007	,
B0008	,
B0009	,
B0010	,
B0011	,
B0012	,
B0013	,
B0014	,
B0015	,
B0016	,
B0017	,
B0018	,
B0019	,
B0020	,
B0021	,
B0022	,
B0023	,
B0024	,
B0025	,
B0026	,
B0027	,
B0028	,
B0029	,
B0030	,
B0031	,
B0032	,
B0033	,
B0034	,
B0035	,
B0036	,
B0037	,
B0038	,
B0039	,
B0040	,
B0041	,
B0042	,
B0043	,
B0044	,
B0045	,
B0046	,
B0047	,
B0048	,
B0049	,
B0050	,
B0051	,
B0052	,
B0053	,
B0054	,
B0055	,
B0056	,
B0057	,
B0058	,
B0059	,
B0060	,
B0061	,
B0062	,
B0063	,
B0064	,
B0065	,
B0066	,
B0067	,
B0068	,
B0069	,
B0070	,
B0071	,
B0072	,
B0073	,
B0074	,
B0075	,
B0076	,
B0077	,
B0078	,
B0079	,
B0080	,
B0081	,
B0082	,
B0083	,
B0084	,
B0085	,
B0086	,
B0087	,
B0088	,
B0089	,
B0090	,
B0091	,
B0092	,
B0093	,
B0094	,
B0095	,
B0096	,
B0097	,
B0098	,
B0099	,
B0100	,
B0101	,
B0102	,
B0103	,
B0104	,
B0105	,
B0106	,
B0107	,
B0108	,
B0110	,
B0111	,
B0112	,
B0113	,
B0114	,
B0115	,
B0116	,
B0117	,
B0118	,
B0119	,
B0120	,
B0121	,
B0122	,
B0123	,
B0124	,
B0125	,
B0126	,
B0127	,
B0128	,
B0129	,
B0130	,
B0131	,
B0132	,
B0133	,
B0134	,
B0135	,
B0136	,
B0137	,
B0138	,
B0139	,
B0140	,
B0141	,
B0142	,
B0143	,
B0144	,
B0145	,
B0146	,
B0147	,
B0148	,
B0149	,
B0150	,
B0151	,
B0152	,
B0153	,
B0299	,
B0300	,
B0301	,
B0302	,
B0303	,
B0306	,
B0307	,
B0323	,
B0324	,
B0325	,
B0326	,
B0327	,
B0328	,
B0329	,
B0330	,
B0331	,
B0332	,
B0333	,
B0334	,
B0335	,
B0336	,
B0337	,
B0338	,
B0339	,
B0340	,
B0350	,
B0351	,
B0352	,
B0353	,
B0354	,
B0355	,
B0356	,
B0357	,
B0358	,
B0359	,
B0360	,
B0361	,
B0362	,
B0363	,
B0364	,
B0365	,
B0366	,
B0367	,
B0368	,
B0369	,
B0370	,
B0375	,
B0378	,
B0379	,
B0380	,
B0381	,
B0382	,
B0383	,
B0384	,
B0385	,
B0386	,
B0387	,
B0388	,
B0389	,
B0390	,
B0391	,
B0392	,
B0393	,
B0394	,
B0395	,
B0396	,
B0397	,
B0398	,
B0399	,
B0400	,
B0401	,
B0402	,
B0403	,
B0404	,
B0405	,
B0406	,
B0407	,
B0408	,
B0409	,
B0410	,
B0411	,
B0412	,
B0413	,
B0414	,
B0415	,
B0416	,
B0417	,
B0418	,
B0419	,
B0420	,
B0421	,
B0422	,
B0423	,
B0424	,
B0425	,
B0426	,
B0427	,
B0428	,
B0429	,
B0430	,
B0431	,
B0432	,
B0433	,
B0434	,
B0435	,
B0436	,
B0437	,
B0438	,
B0439	,
B0440	,
B0441	,
B0442	,
B0443	,
B0444	,
B0445	,
B0446	,
B0447	,
B0448	,
B0449	,
B0450	,
B0451	,
B0452	,
B0453	,
B0454	,
B0455	,
B0456   ,
---
B0457   ,
B0458   ,
B0459   ,
B0460   ,
B0461   ,
B0462   ,
B0463   ,
B0464   ,
B0465   ,
B0466   ,
B0467   ,
B0468   ,
B0469   ,
B0470   ,
B0471   ,
B0472   ,
B0473   ,
B0474   ,
B0475   ,
B0476   ,
B0477   ,
B0478   ,
B0479   ,
B0480   ,
B0481   ,
B0482   ,
B0483   ,
B0484   ,
B0485   ,
B0486   ,
B0487   ,
B0488   ,
B0489   ,
B0490   ,
B0491   ,
B0492   ,
B0493   ,
B0494   ,

B0495, B0496, B0497, B0498, B0499, B0500, B0501, B0502, B0503, B0504, B0505, B0506, B0507, B0508, B0509, B0510, B0511, B0512, B0513, B0514, B0515, B0516, B0517, B0518,
B0519, B0520, B0521, B0522,	B0523, B0524, B0525, B0526, B0527, B0528, B0529, B0530, B0531, B0532, B0533, B0534, B0535, B0536, B0537, B0538, B0539, B0540, B0541, B0542,
B0543, B0544, B0545, B0546, B0547, B0548, B0549, B0550, B0551, B0552, B0553, B0554, B0555, B0556, B0557, B0558, B0559, B0560, B0561, B0562, B0563, B0564, B0565, B0566,
B0567, B0568, B0569, B0570, B0571, B0572, B0573, B0574, B0575, B0576, B0577, B0578, B0579, B0580, B0581, B0582, B0583, B0584, B0585, B0586, B0587, B0588, B0589, B0590,
B0591

from digital.business_occupations_nonmatches_segments;
---(13694876 row(s) affected)     ---QA (115379 row(s) affected)

--Creating IndividualID Match Segments

---select top 0
drop table if exists digital.business_occupations_matches_segments;

create table digital.business_occupations_matches_segments as
select
  Right('000000000000000000'+e.row_id,18) id,
  row_id orig_id,
 '00' e_executivesourcecode,
 Right('00'+em_vendorid,2) e_vendorid2,
 '000000000000' abinumber,
  em_indiv_id inidividualid,
 e.family_id familyid,
e.first_name e_firstname ,
e.last_name e_lastname ,
AREA_CODE+PHONE_NUMBER phonenumber,
---case when ltrim(rtrim(em_emailaddress)) = '' then em_emailaddress else lower(substring(convert(varchar(max),HashBytes('MD5',lower(LTRIM(RTRIM(em_emailaddress)))),1),3,32)) end email,
case when ltrim(rtrim(em_emailaddress)) = '' then em_emailaddress else md5(lower(trim(em_emailaddress))) end email,
em_emailaddress orig_email,
'' m_address_mailing, '' m_city_mailing,
'' m_state_mailing, '' m_zipcode_mailing, '' m_zipfour_mailing,
address,
city,state,ZIP_CODE zipcode,zip_four zipfour,
'' m_address_landmark,
'' m_city_landmark,
'' m_state_landmark,
'' m_zipcode_landmark,
'' m_zipfour_landmark,
'' e_homeaddress,
'' e_homecity,
'' e_homestate,
'' e_homezipcode,
'' e_homezip4,
'' fulfillmentflag,
'OCCUPATIONS_MATCHES_INDIV' dataset,
cast(NULL as int) b0001,
CASE WHEN SIC_CODE IN ('075102', '208401', '794803') THEN 1 END as b0002,
cast(NULL as int) b0003,
cast(NULL as int) b0004,
cast(NULL as int) b0005,
cast(NULL as int) b0006,
cast(NULL as int) b0007,
cast(NULL as int) b0008,
cast(NULL as int) b0009,
cast(NULL as int) b0010,
cast(NULL as int) b0011,
cast(NULL as int) b0012,
case when ( sic_code IN ('591205', '599504', '599900', '801101', '801121', '804101', '804201', '804301', '804900', '804902', '804904', '804911', '804912', '804913', '804914', '804918', '804919', '804922', '804924', '804925', '804926', '804951', '804964', '805101', '805999', '806301', '807118', '808201', '809900', '832281', '839911', '899905')   OR
( sic_code='832201' AND SPECIALTY_TITLE IN ('MENTAL HEALTH COUNSELOR', 'ADDICTION COUNSELOR', 'CLINICAL', 'BEHAVIORAL', 'DEVELOPMENTAL DISABILITY/RETARDATION', 'NEUROPSYCHOLOGIST', 'REHABILITATION', 'AGING/ADULT') )  OR
( sic_code='832204' AND SPECIALTY_TITLE IN ('ADDICTION COUNSELOR', 'CLINICAL') ) ) then 1 END as b0013,
 case when (  sic_code='628203' ) then 1 END as b0014,
 cast(NULL as int) b0015,
cast(NULL as int) b0016,
case when (sic_code IN ('614101', '673303', '872105', '874209') ) THEN 1 END as b0017,
cast(NULL as int) b0018,
cast(NULL as int) b0019,
cast(NULL as int) b0020,
cast(NULL as int) b0021,
cast(NULL as int) b0022,
case when (sic_code='804908') THEN 1 END as b0023,
case when sic_code IN ('871120', '871122', '871103', '871107', '871108', '871109', '871110', '871111', '871112', '871114', '871118', '871119', '871123', '871124', '871125', '871126', '871130', '871132', '871133', '871137', '871138', '871143', '871152', '871158', '871161', '871162', '871211', '873112', '873130', '874853', '874855', '899904')  OR
 (sic_code IN ('871106', '871115', '871159')  AND OCCUPATION_TITLE IN ('ENGINEER PROFESSIONAL', 'ENGINEER INTERN', 'ENGINEER TEMPORARY LICENSE') ) THEN 1 END as b0024,
cast(NULL as int) b0025,
cast(NULL as int) b0026,
cast(NULL as int) b0027,
cast(NULL as int) b0028,
cast(NULL as int) b0029,
case when sic_code IN ('736109', '738920', '781908', '822100', '823106') then 1 end as b0030,
cast(NULL as int) b0031,
cast(NULL as int) b0032,
cast(NULL as int) b0033,
cast(NULL as int) b0034,
case when (SIC_CODE >=  801111  AND SIC_CODE <=  801114 ) OR  ( SIC_CODE >=   801118  AND SIC_CODE <=  801131 )  OR  ( SIC_CODE >=  804301 AND SIC_CODE <= 804304 )  OR  SIC_CODE IN ('801101','801105','801108','801137','801138','804901','802108') then 1 end as b0035,
cast(NULL as int) b0036,
case when sic_code IN ('874301', '874824', '912113')  then 1 end as b0037,
cast(NULL as int) b0038,
cast(NULL as int) b0039,
case when sic_code IN ('591205', '599504', '599900', '801101', '801121', '804101', '804201', '804301', '804900', '804902', '804904', '804911', '804912', '804913', '804914', '804918', '804919', '804922', '804924', '804925', '804926', '804951', '804964', '805101', '805999', '806301', '807118', '808201', '809900', '832281', '839911', '899905')   OR
( sic_code='832201' AND specialty_title IN ('MENTAL HEALTH COUNSELOR', 'ADDICTION COUNSELOR', 'CLINICAL', 'BEHAVIORAL', 'DEVELOPMENTAL DISABILITY/RETARDATION', 'NEUROPSYCHOLOGIST', 'REHABILITATION', 'AGING/ADULT') )  OR
( sic_code='832204' AND specialty_title IN ('ADDICTION COUNSELOR', 'CLINICAL') ) then 1 end as b0040,
cast(NULL as int) b0041,
cast(NULL as int) b0042,
cast(NULL as int) b0043,
cast(NULL as int) b0044,
cast(NULL as int) b0045,
cast(NULL as int) b0046,
cast(NULL as int) b0047,
cast(NULL as int) b0048,
cast(NULL as int) b0049,
cast(NULL as int) b0050,
cast(NULL as int) b0051,
cast(NULL as int) b0052,
cast(NULL as int) b0053,
cast(NULL as int) b0054,
cast(NULL as int) b0055,
cast(NULL as int) b0056,
cast(NULL as int) b0057,
cast(NULL as int) b0058,
cast(NULL as int) b0059,
cast(NULL as int) b0060,
cast(NULL as int) b0061,
cast(NULL as int) b0062,
cast(NULL as int) b0063,
cast(NULL as int) b0064,
cast(NULL as int) b0065,
cast(NULL as int) b0066,
cast(NULL as int) b0067,
cast(NULL as int) b0068,
cast(NULL as int) b0069,
cast(NULL as int) b0070,
cast(NULL as int) b0071,
cast(NULL as int) b0072,
cast(NULL as int) b0073,
cast(NULL as int) b0074,
cast(NULL as int) b0075,
cast(NULL as int) b0076,
cast(NULL as int) b0077,
cast(NULL as int) b0078,
cast(NULL as int) b0079,
cast(NULL as int) b0080,
cast(NULL as int) b0081,
cast(NULL as int) b0082,
cast(NULL as int) b0083,
cast(NULL as int) b0084,
cast(NULL as int) b0085,
cast(NULL as int) b0086,
cast(NULL as int) b0087,
cast(NULL as int) b0088,
cast(NULL as int) b0089,
cast(NULL as int) b0090,
cast(NULL as int) b0091,
cast(NULL as int) b0092,
cast(NULL as int) b0093,
cast(NULL as int) b0094,
cast(NULL as int) b0095,
cast(NULL as int) b0096,
cast(NULL as int) b0097,
cast(NULL as int) b0098,
cast(NULL as int) b0099,
cast(NULL as int) b0100,
cast(NULL as int) b0101,
cast(NULL as int) b0102,
cast(NULL as int) b0103,
cast(NULL as int) b0104,
cast(NULL as int) b0105,
cast(NULL as int) b0106,
cast(NULL as int) b0107,
cast(NULL as int) b0108,
---cast(NULL as int) b0109,
cast(NULL as int) b0110,
cast(NULL as int) b0111,
cast(NULL as int) b0112,
cast(NULL as int) b0113,
cast(NULL as int) b0114,
cast(NULL as int) b0115,
cast(NULL as int) b0116,
cast(NULL as int) b0117,
cast(NULL as int) b0118,
cast(NULL as int) b0119,
cast(NULL as int) b0120,
cast(NULL as int) b0121,
cast(NULL as int) b0122,
cast(NULL as int) b0123,
cast(NULL as int) b0124,
cast(NULL as int) b0125,
cast(NULL as int) b0126,
cast(NULL as int) b0127,
cast(NULL as int) b0128,
cast(NULL as int) b0129,
cast(NULL as int) b0130,
cast(NULL as int) b0131,
cast(NULL as int) b0132,
cast(NULL as int) b0133,
cast(NULL as int) b0134,
cast(NULL as int) b0135,
cast(NULL as int) b0136,
cast(NULL as int) b0137,
cast(NULL as int) b0138,
cast(NULL as int) b0139,
cast(NULL as int) b0140,
cast(NULL as int) b0141,
cast(NULL as int) b0142,
cast(NULL as int) b0143,
cast(NULL as int) b0144,
cast(NULL as int) b0145,
cast(NULL as int) b0146,
cast(NULL as int) b0147,
cast(NULL as int) b0148,
cast(NULL as int) b0149,
cast(NULL as int) b0150,
cast(NULL as int) b0151,
cast(NULL as int) b0152,
cast(NULL as int) b0153,
/*
cast(NULL as int) b0154,
cast(NULL as int) b0155,
cast(NULL as int) b0156,
cast(NULL as int) b0157,
cast(NULL as int) b0158,
cast(NULL as int) b0159,
cast(NULL as int) b0160,
cast(NULL as int) b0161,
cast(NULL as int) b0162,
cast(NULL as int) b0163,
cast(NULL as int) b0164,
cast(NULL as int) b0165,
cast(NULL as int) b0166,
cast(NULL as int) b0167,
cast(NULL as int) b0168,
cast(NULL as int) b0169,
cast(NULL as int) b0170,
cast(NULL as int) b0171,
cast(NULL as int) b0172,
cast(NULL as int) b0173,
cast(NULL as int) b0174,
cast(NULL as int) b0175,
cast(NULL as int) b0176,
cast(NULL as int) b0177,
cast(NULL as int) b0178,
cast(NULL as int) b0179,
cast(NULL as int) b0180,
cast(NULL as int) b0181,
cast(NULL as int) b0182,
cast(NULL as int) b0183,
cast(NULL as int) b0184,
cast(NULL as int) b0185,
cast(NULL as int) b0186,
cast(NULL as int) b0187,
cast(NULL as int) b0188,
cast(NULL as int) b0189,
cast(NULL as int) b0190,
cast(NULL as int) b0191,
cast(NULL as int) b0192,
cast(NULL as int) b0193,
cast(NULL as int) b0194,
cast(NULL as int) b0195,
cast(NULL as int) b0196,
cast(NULL as int) b0197,
cast(NULL as int) b0198,
cast(NULL as int) b0199,
cast(NULL as int) b0200,
cast(NULL as int) b0201,
cast(NULL as int) b0202,
cast(NULL as int) b0203,
cast(NULL as int) b0204,
cast(NULL as int) b0205,
cast(NULL as int) b0206,
cast(NULL as int) b0207,
cast(NULL as int) b0208,
cast(NULL as int) b0209,
cast(NULL as int) b0210,
cast(NULL as int) b0211,
cast(NULL as int) b0212,
cast(NULL as int) b0213,
cast(NULL as int) b0214,
cast(NULL as int) b0215,
cast(NULL as int) b0216,
cast(NULL as int) b0217,
cast(NULL as int) b0218,
cast(NULL as int) b0219,
cast(NULL as int) b0220,
cast(NULL as int) b0221,
cast(NULL as int) b0222,
cast(NULL as int) b0223,
cast(NULL as int) b0224,
cast(NULL as int) b0225,
cast(NULL as int) b0226,
cast(NULL as int) b0227,
cast(NULL as int) b0228,
cast(NULL as int) b0229,
cast(NULL as int) b0230,
cast(NULL as int) b0231,
cast(NULL as int) b0232,
cast(NULL as int) b0233,
cast(NULL as int) b0234,
cast(NULL as int) b0235,
    */
  /*
cast(NULL as int) b0236,
cast(NULL as int) b0237,
cast(NULL as int) b0238,
cast(NULL as int) b0239,
cast(NULL as int) b0240,
cast(NULL as int) b0241,
cast(NULL as int) b0242,
cast(NULL as int) b0243,
cast(NULL as int) b0244,
cast(NULL as int) b0245,
cast(NULL as int) b0246,
cast(NULL as int) b0247,
cast(NULL as int) b0248,
cast(NULL as int) b0249,
cast(NULL as int) b0250,
cast(NULL as int) b0251,
cast(NULL as int) b0252,
cast(NULL as int) b0253,
cast(NULL as int) b0254,
cast(NULL as int) b0255,
cast(NULL as int) b0256,
cast(NULL as int) b0257,
cast(NULL as int) b0258,
cast(NULL as int) b0259,
cast(NULL as int) b0260,
cast(NULL as int) b0261,
cast(NULL as int) b0262,
cast(NULL as int) b0263,
cast(NULL as int) b0264,
cast(NULL as int) b0265,
cast(NULL as int) b0266,
cast(NULL as int) b0267,
cast(NULL as int) b0268,
cast(NULL as int) b0269,
cast(NULL as int) b0270,
cast(NULL as int) b0271,
cast(NULL as int) b0272,
cast(NULL as int) b0273,
cast(NULL as int) b0274,
cast(NULL as int) b0275,
cast(NULL as int) b0276,
cast(NULL as int) b0277,
cast(NULL as int) b0278,
cast(NULL as int) b0279,
cast(NULL as int) b0280,
cast(NULL as int) b0281,
cast(NULL as int) b0282,
cast(NULL as int) b0283,
cast(NULL as int) b0284,
cast(NULL as int) b0285,
cast(NULL as int) b0286,
  */
/*
cast(NULL as int) b0287,
cast(NULL as int) b0288,
cast(NULL as int) b0289,
cast(NULL as int) b0290,
cast(NULL as int) b0291,
cast(NULL as int) b0292,
cast(NULL as int) b0293,
cast(NULL as int) b0294,
cast(NULL as int) b0295,
cast(NULL as int) b0296,
cast(NULL as int) b0297,
cast(NULL as int) b0298,
  */
cast(NULL as int) b0299,
cast(NULL as int) b0300,
cast(NULL as int) b0301,
cast(NULL as int) b0302,
cast(NULL as int) b0303,
--changes
---cast(NULL as int) b0304,
---cast(NULL as int) b0305,
cast(NULL as int) b0306,
cast(NULL as int) b0307,
/*
cast(NULL as int) b0308,
cast(NULL as int) b0309,
cast(NULL as int) b0310,
cast(NULL as int) b0311,
cast(NULL as int) b0312,
cast(NULL as int) b0313,
cast(NULL as int) b0314,
cast(NULL as int) b0315,
cast(NULL as int) b0316,
cast(NULL as int) b0317,
cast(NULL as int) b0318,
cast(NULL as int) b0319,
cast(NULL as int) b0320,
cast(NULL as int) b0321,
cast(NULL as int) b0322,
  */
cast(NULL as int) b0323,
cast(NULL as int) b0324,
cast(NULL as int) b0325,
cast(NULL as int) b0326,
cast(NULL as int) b0327,
cast(NULL as int) b0328,
cast(NULL as int) b0329,
cast(NULL as int) b0330,
cast(NULL as int) b0331,
cast(NULL as int) b0332,
cast(NULL as int) b0333,
cast(NULL as int) b0334,
cast(NULL as int) b0335,
cast(NULL as int) b0336,
cast(NULL as int) b0337,
cast(NULL as int) b0338,
cast(NULL as int) b0339,
cast(NULL as int) b0340,
/*
cast(NULL as int) b0341,
cast(NULL as int) b0342,
cast(NULL as int) b0343,
cast(NULL as int) b0344,
cast(NULL as int) b0345,
cast(NULL as int) b0346,
cast(NULL as int) b0347,
cast(NULL as int) b0348,
case when OCCUPATION_TITLE IN ('AGENT','INSURANCE AGENT','REAL ESTATE SALES','SPORTS AGENTS','TALENT AGENT') then 1 end as b0349,
  */
case when OCCUPATION_TITLE = 'MIDWIFE (NOT RN)' OR SPECIALTY_TITLE='MIDWIFE' then 1 end as b0350,
case when OCCUPATION_TITLE = 'NURSE REGISTERED (RN)' AND specialty_title='NURSE PRACTITIONER' then 1 end as b0351,
case when OCCUPATION_TITLE = 'ACCOUNTANT' then 1 end as b0352,
case when OCCUPATION_TITLE = 'CHIROPRACTOR' then 1 end as b0353,
case when OCCUPATION_TITLE = 'DENTIST' then 1 end as b0354,
cast(NULL as int) b0355,
case when OCCUPATION_TITLE = 'DENTIST' then 1 end as b0356,
case when OCCUPATION_TITLE = 'PODIATRIST' then 1 end as  b0357,
cast(NULL as int) b0358,
case when OCCUPATION_TITLE = 'VETERINARIAN' then 1 end as  b0359,
case when OCCUPATION_TITLE = 'NURSE PRACTICAL (LPN)' then 1 end as  b0360,
case when OCCUPATION_TITLE = 'DOCTORS/PHYSICIANS' then 1 end as  b0361,
case when SPECIALTY_TITLE='NURSE PRACTITIONER' then 1 end as  b0362,
case when SPECIALTY_TITLE='OPTOMETRIST (OD)' then 1 end as  b0363,
case when OCCUPATION_TITLE = 'THERAPIST' AND SPECIALTY_TITLE ='OCCUPATIONAL' then 1 end as b0364,
case when SPECIALTY_TITLE = 'PHYSICIAN''S ASSISTANT' then 1 end as b0365,
case when OCCUPATION_TITLE = 'ENGINEER PROFESSIONAL' then 1 end as b0366,
cast(NULL as int) b0367,
case when OCCUPATION_TITLE = 'THERAPIST' AND SPECIALTY_TITLE='PHYSICAL (LICENSED)' then 1 end as b0368,
case when OCCUPATION_TITLE = 'NURSE REGISTERED (RN)' then 1 end as b0369,
case when OCCUPATION_TITLE = 'NATUROPATHIC/HOMEOPATHIC PHYSICIAN OR COUNSELOR' then 1 end as b0370,
/*
cast(NULL as int) b0371,
cast(NULL as int) b0372,
cast(NULL as int) b0373,
cast(NULL as int) b0374,
  */
cast(NULL as int) b0375,
---cast(NULL as int) b0376,
---cast(NULL as int) b0377,
cast(NULL as int) b0378,
cast(NULL as int) b0379,
cast(NULL as int) b0380,
cast(NULL as int) b0381,
cast(NULL as int) b0382,
cast(NULL as int) b0383,
cast(NULL as int) b0384,
cast(NULL as int) b0385,
cast(NULL as int) b0386,
cast(NULL as int) b0387,
cast(NULL as int) b0388,
cast(NULL as int) b0389,
cast(NULL as int) b0390,
cast(NULL as int) b0391,
cast(NULL as int) b0392,
cast(NULL as int) b0393,
cast(NULL as int) b0394,
cast(NULL as int) b0395,
cast(NULL as int) b0396,
cast(NULL as int) b0397,
cast(NULL as int) b0398,
cast(NULL as int) b0399,
cast(NULL as int) b0400,
cast(NULL as int) b0401,
cast(NULL as int) b0402,
cast(NULL as int) b0403,
cast(NULL as int) b0404,
cast(NULL as int) b0405,
cast(NULL as int) b0406,
cast(NULL as int) b0407,
cast(NULL as int) b0408,
cast(NULL as int) b0409,
cast(NULL as int) b0410,
cast(NULL as int) b0411,
cast(NULL as int) b0412,
cast(NULL as int) b0413,
cast(NULL as int) b0414,
cast(NULL as int) b0415,
cast(NULL as int) b0416,
cast(NULL as int) b0417,
cast(NULL as int) b0418,
cast(NULL as int) b0419,
cast(NULL as int) b0420,
cast(NULL as int) b0421,
cast(NULL as int) b0422,
cast(NULL as int) b0423,
cast(NULL as int) b0424,
cast(NULL as int) b0425,
cast(NULL as int) b0426,
cast(NULL as int) b0427,
cast(NULL as int) b0428,
cast(NULL as int) b0429,
cast(NULL as int) b0430,
cast(NULL as int) b0431,
cast(NULL as int) b0432,
cast(NULL as int) b0433,
cast(NULL as int) b0434,
cast(NULL as int) b0435,
cast(NULL as int) b0436,
cast(NULL as int) b0437,
cast(NULL as int) b0438,
cast(NULL as int) b0439,
cast(NULL as int) b0440,
cast(NULL as int) b0441,
cast(NULL as int) b0442,
cast(NULL as int) b0443,
cast(NULL as int) b0444,
cast(NULL as int) b0445,
cast(NULL as int) b0446,
cast(NULL as int) b0447,
cast(NULL as int) b0448,
cast(NULL as int) b0449,
cast(NULL as int) b0450,
cast(NULL as int) b0451,
cast(NULL as int) b0452,
cast(NULL as int) b0453,
cast(NULL as int) b0454,
cast(NULL as int) b0455,
cast(NULL as int) b0456,
---
cast(NULL as int) b0457,
cast(NULL as int) b0458,
cast(NULL as int) b0459,
cast(NULL as int) b0460,
case when (sic_code IN('801101','801105','801108','801111','801112','801113','801114','801137','801138','804301','804302','804303','804304','804901','802108') OR
                   sic_code between 801118 and 801131) then 1 end B0461,
case when SPECIALTY_TITLE ='Pediatrics' then 1 end B0462,
case when substring(sic_code,1,2) = '35' then 1 end B0463,
case when substring(sic_code,1,2) = '15' then 1 end B0464,
case when sic_code IN('621101','621104','621105','621109','621110','621111','874209') OR
                sic_code between 628200 and 628299 OR substring(sic_code,1,3) IN('602','603','604','606') then 1 end B0465,
case when sic_code in('124101','138101','138210','138902','138930','153101','154220','154236','161114','162202','162304','162321','162904','162912','162917','162925','811110','832290')
                       OR substring(sic_code,1,2) = '17' then 1 end B0466,
case when SIC_CODE in('801104','801113','803198','804398','804999','809399') OR
                 ((sic_code between 801101 and 801138 or sic_code between 804301 and 804398) and sic_code not in('801105')) then 1 end B0467,
cast(NULL as int) b0468,
case when sic_code in('431101') then 1 end B0469,
case when substring(SIC_CODE,1,2) in('01','02') then 1 end B0470,
cast(NULL as int) b0471,
cast(NULL as int) b0472,
case when sic_code in('653117') then 1 end B0473,
cast(NULL as int) b0474,
cast(NULL as int) b0475,
cast(NULL as int) b0476,
cast(NULL as int) b0477,
cast(NULL as int) b0478,
cast(NULL as int) b0479,
cast(NULL as int) b0480,
cast(NULL as int) b0481,
cast(NULL as int) b0482,
cast(NULL as int) b0483,
cast(NULL as int) b0484,
cast(NULL as int) b0485,
cast(NULL as int) b0486,
cast(NULL as int) b0487,
cast(NULL as int) b0488,
cast(NULL as int) b0489,
cast(NULL as int) b0490,
cast(NULL as int) b0491,
cast(NULL as int) b0492,
cast(NULL as int) b0493,
cast(NULL as int) b0494,
---

cast(NULL as int) b0495,
cast(NULL as int) b0496,
cast(NULL as int) b0497,
cast(NULL as int) b0498,
cast(NULL as int) b0499,
cast(NULL as int) b0500,
cast(NULL as int) b0501,
cast(NULL as int) b0502,
cast(NULL as int) b0503,
cast(NULL as int) b0504,
cast(NULL as int) b0505,
cast(NULL as int) b0506,
cast(NULL as int) b0507,
cast(NULL as int) b0508,
cast(NULL as int) b0509,
cast(NULL as int) b0510,
cast(NULL as int) b0511,
cast(NULL as int) b0512,
cast(NULL as int) b0513,
cast(NULL as int) b0514,
cast(NULL as int) b0515,
cast(NULL as int) b0516,
cast(NULL as int) b0517,
cast(NULL as int) b0518,
cast(NULL as int) b0519,
cast(NULL as int) b0520,
cast(NULL as int) b0521,
cast(NULL as int) b0522,
cast(NULL as int) b0523,
cast(NULL as int) b0524,
cast(NULL as int) b0525,
cast(NULL as int) b0526,
cast(NULL as int) b0527,
cast(NULL as int) b0528,
cast(NULL as int) b0529,
cast(NULL as int) b0530,
cast(NULL as int) b0531,
cast(NULL as int) b0532,
cast(NULL as int) b0533,
cast(NULL as int) b0534,
cast(NULL as int) b0535,
cast(NULL as int) b0536,
cast(NULL as int) b0537,
cast(NULL as int) b0538,
cast(NULL as int) b0539,
cast(NULL as int) b0540,
cast(NULL as int) b0541,
cast(NULL as int) b0542,
cast(NULL as int) b0543,
cast(NULL as int) b0544,
cast(NULL as int) b0545,
cast(NULL as int) b0546,
cast(NULL as int) b0547,
cast(NULL as int) b0548,
cast(NULL as int) b0549,
cast(NULL as int) b0550,
cast(NULL as int) b0551,
cast(NULL as int) b0552,
cast(NULL as int) b0553,
cast(NULL as int) b0554,
cast(NULL as int) b0555,
cast(NULL as int) b0556,
cast(NULL as int) b0557,
cast(NULL as int) b0558,
cast(NULL as int) b0559,
cast(NULL as int) b0560,
cast(NULL as int) b0561,
cast(NULL as int) b0562,
cast(NULL as int) b0563,
cast(NULL as int) b0564,
cast(NULL as int) b0565,
cast(NULL as int) b0566,
cast(NULL as int) b0567,
cast(NULL as int) b0568,
cast(NULL as int) b0569,
cast(NULL as int) b0570,
cast(NULL as int) b0571,
cast(NULL as int) b0572,
cast(NULL as int) b0573,
cast(NULL as int) b0574,
cast(NULL as int) b0575,
cast(NULL as int) b0576,
cast(NULL as int) b0577,
cast(NULL as int) b0578,
CASE WHEN	sic_code between 830000 and 839999	then 1 end	B0579,
cast(NULL as int) b0580,
cast(NULL as int) b0581,
cast(NULL as int) b0582,
cast(NULL as int) b0583,
cast(NULL as int) b0584,
cast(NULL as int) b0585,
cast(NULL as int) b0586,
cast(NULL as int) b0587,
cast(NULL as int) b0588,
cast(NULL as int) b0589,
cast(NULL as int) b0590,
cast(NULL as int) b0591

 from  digital.business_occupations_email_enhancements e;
---(13545801 row(s) affected)       ---QA (180734 row(s) affected)

insert into digital.business_segments_bb_vv_aws (
business_Exec_ID,
id,
e_executivesourcecode,
abinumber,
e_vendorid2,
e_firstname,
e_lastname,
phonenumber,
email,
orig_email,
m_address_mailing,
m_city_mailing,
m_state_mailing,
m_zipcode_mailing,
m_zipfour_mailing,
address,
city,
state,
zipcode,
zipfour,
m_address_landmark,
m_city_landmark,
m_state_landmark,
m_zipcode_landmark,
m_zipfour_landmark,
e_homeaddress,
e_homecity,
e_homestate,
e_homezipcode,
e_homezip4,
fulfillmentflag,
dataset,
b0001, b0002, b0003, b0004, b0005, b0006, b0007, b0008, b0009, b0010, b0011, b0012, b0013, b0014, b0015, b0016, b0017, b0018, b0019, b0020, b0021, b0022, b0023, b0024, b0025, b0026, b0027, b0028, b0029, b0030, b0031, b0032, b0033, b0034, b0035, b0036, b0037, b0038, b0039, b0040, b0041, b0042, b0043, b0044, b0045, b0046, b0047, b0048, b0049, b0050, b0051, b0052, b0053, b0054, b0055, b0056, b0057, b0058, b0059, b0060, b0061, b0062, b0063, b0064, b0065, b0066, b0067, b0068, b0069, b0070, b0071, b0072, b0073, b0074, b0075, b0076, b0077, b0078, b0079, b0080, b0081, b0082, b0083, b0084, b0085, b0086, b0087, b0088, b0089, b0090, b0091, b0092, b0093, b0094, b0095, b0096, b0097, b0098, b0099, b0100, b0101, b0102, b0103, b0104, b0105, b0106, b0107, b0108, b0110, b0111, b0112, b0113, b0114, b0115, b0116, b0117, b0118, b0119, b0120, b0121, b0122, b0123, b0124, b0125, b0126, b0127, b0128, b0129, b0130, b0131, b0132, b0133, b0134, b0135, b0136, b0137, b0138, b0139, b0140, b0141, b0142, b0143, b0144, b0145, b0146, b0147, b0148, b0149, b0150, b0151, b0152, b0153, b0299, b0300, b0301, b0302, b0303, b0306, b0307, b0323, b0324, b0325, b0326, b0327, b0328, b0329, b0330, b0331, b0332, b0333, b0334, b0335, b0336, b0337, b0338, b0339, b0340, b0350, b0351, b0352, b0353, b0354, b0355, b0356, b0357, b0358, b0359, b0360, b0361, b0362, b0363, b0364, b0365, b0366, b0367, b0368, b0369, b0370, b0375, b0378, b0379, B0380, B0381, B0382, B0383, B0384, B0385, B0386, B0387, B0388, B0389, B0390, B0391, B0392, B0393, B0394, B0395, B0396, B0397, B0398, B0399, B0400, B0401, B0402, B0403, B0404, B0405, B0406, B0407, B0408, B0409, B0410, B0411, B0412, B0413, B0414, B0415, B0416, B0417, B0418, B0419, B0420, B0421, B0422, B0423, B0424, B0425, B0426, B0427, B0428, B0429, B0430, B0431, B0432, B0433, B0434, B0435, B0436, B0437, B0438, B0439, B0440, B0441, B0442, B0443, B0444, B0445, B0446, B0447, B0448, B0449, B0450, B0451, B0452, B0453, B0454, B0455, B0456,
---
B0457   ,
B0458   ,
B0459   ,
B0460   ,
B0461   ,
B0462   ,
B0463   ,
B0464   ,
B0465   ,
B0466   ,
B0467   ,
B0468   ,
B0469   ,
B0470   ,
B0471   ,
B0472   ,
B0473   ,
B0474   ,
B0475   ,
B0476   ,
B0477   ,
B0478   ,
B0479   ,
B0480   ,
B0481   ,
B0482   ,
B0483   ,
B0484   ,
B0485   ,
B0486   ,
B0487   ,
B0488   ,
B0489   ,
B0490   ,
B0491   ,
B0492   ,
B0493   ,
B0494   ,
---

B0495, B0496, B0497, B0498, B0499, B0500, B0501, B0502, B0503, B0504, B0505, B0506, B0507, B0508, B0509, B0510, B0511, B0512, B0513, B0514, B0515, B0516, B0517, B0518,
B0519, B0520, B0521, B0522,	B0523, B0524, B0525, B0526, B0527, B0528, B0529, B0530, B0531, B0532, B0533, B0534, B0535, B0536, B0537, B0538, B0539, B0540, B0541, B0542,
B0543, B0544, B0545, B0546, B0547, B0548, B0549, B0550, B0551, B0552, B0553, B0554, B0555, B0556, B0557, B0558, B0559, B0560, B0561, B0562, B0563, B0564, B0565, B0566,
B0567, B0568, B0569, B0570, B0571, B0572, B0573, B0574, B0575, B0576, B0577, B0578, B0579, B0580, B0581, B0582, B0583, B0584, B0585, B0586, B0587, B0588, B0589, B0590,
B0591

)
select
--'000000000' New_ID,
 'P'+inidividualid+'-'+  case when (ltrim(rtrim(e_vendorid2)) = '00' OR e_vendorid2  = 36 ) then 'P' ELSE 'V' END   + Right('00000000000000'+id,14)  +  '-'+ e_vendorid2   business_Exec_ID ,
 id  ,
 '00',
 '000000000',
 e_vendorid2,
e_firstname     ,
e_lastname      ,
phonenumber     ,
email   ,
orig_email,
'' m_address_mailing       ,
'' m_city_mailing  ,
'' m_state_mailing ,
'' m_zipcode_mailing       ,
'' m_zipfour_mailing       ,
 address ,
 city    ,
 state   ,
 zipcode ,
 zipfour ,
'' m_address_landmark      ,
'' m_city_landmark ,
'' m_state_landmark        ,
'' m_zipcode_landmark      ,
'' m_zipfour_landmark      ,
'' e_homeaddress,
'' e_homecity,
'' e_homestate,
'' e_homezipcode,
'' e_homezip4,
'' fulfillmentflag,
dataset,
B0001	,
B0002	,
B0003	,
B0004	,
B0005	,
B0006	,
B0007	,
B0008	,
B0009	,
B0010	,
B0011	,
B0012	,
B0013	,
B0014	,
B0015	,
B0016	,
B0017	,
B0018	,
B0019	,
B0020	,
B0021	,
B0022	,
B0023	,
B0024	,
B0025	,
B0026	,
B0027	,
B0028	,
B0029	,
B0030	,
B0031	,
B0032	,
B0033	,
B0034	,
B0035	,
B0036	,
B0037	,
B0038	,
B0039	,
B0040	,
B0041	,
B0042	,
B0043	,
B0044	,
B0045	,
B0046	,
B0047	,
B0048	,
B0049	,
B0050	,
B0051	,
B0052	,
B0053	,
B0054	,
B0055	,
B0056	,
B0057	,
B0058	,
B0059	,
B0060	,
B0061	,
B0062	,
B0063	,
B0064	,
B0065	,
B0066	,
B0067	,
B0068	,
B0069	,
B0070	,
B0071	,
B0072	,
B0073	,
B0074	,
B0075	,
B0076	,
B0077	,
B0078	,
B0079	,
B0080	,
B0081	,
B0082	,
B0083	,
B0084	,
B0085	,
B0086	,
B0087	,
B0088	,
B0089	,
B0090	,
B0091	,
B0092	,
B0093	,
B0094	,
B0095	,
B0096	,
B0097	,
B0098	,
B0099	,
B0100	,
B0101	,
B0102	,
B0103	,
B0104	,
B0105	,
B0106	,
B0107	,
B0108	,
B0110	,
B0111	,
B0112	,
B0113	,
B0114	,
B0115	,
B0116	,
B0117	,
B0118	,
B0119	,
B0120	,
B0121	,
B0122	,
B0123	,
B0124	,
B0125	,
B0126	,
B0127	,
B0128	,
B0129	,
B0130	,
B0131	,
B0132	,
B0133	,
B0134	,
B0135	,
B0136	,
B0137	,
B0138	,
B0139	,
B0140	,
B0141	,
B0142	,
B0143	,
B0144	,
B0145	,
B0146	,
B0147	,
B0148	,
B0149	,
B0150	,
B0151	,
B0152	,
B0153	,
B0299	,
B0300	,
B0301	,
B0302	,
B0303	,
B0306	,
B0307	,
B0323	,
B0324	,
B0325	,
B0326	,
B0327	,
B0328	,
B0329	,
B0330	,
B0331	,
B0332	,
B0333	,
B0334	,
B0335	,
B0336	,
B0337	,
B0338	,
B0339	,
B0340	,
B0350	,
B0351	,
B0352	,
B0353	,
B0354	,
B0355	,
B0356	,
B0357	,
B0358	,
B0359	,
B0360	,
B0361	,
B0362	,
B0363	,
B0364	,
B0365	,
B0366	,
B0367	,
B0368	,
B0369	,
B0370	,
B0375	,
B0378	,
B0379	,
B0380	,
B0381	,
B0382	,
B0383	,
B0384	,
B0385	,
B0386	,
B0387	,
B0388	,
B0389	,
B0390	,
B0391	,
B0392	,
B0393	,
B0394	,
B0395	,
B0396	,
B0397	,
B0398	,
B0399	,
B0400	,
B0401	,
B0402	,
B0403	,
B0404	,
B0405	,
B0406	,
B0407	,
B0408	,
B0409	,
B0410	,
B0411	,
B0412	,
B0413	,
B0414	,
B0415	,
B0416	,
B0417	,
B0418	,
B0419	,
B0420	,
B0421	,
B0422	,
B0423	,
B0424	,
B0425	,
B0426	,
B0427	,
B0428	,
B0429	,
B0430	,
B0431	,
B0432	,
B0433	,
B0434	,
B0435	,
B0436	,
B0437	,
B0438	,
B0439	,
B0440	,
B0441	,
B0442	,
B0443	,
B0444	,
B0445	,
B0446	,
B0447	,
B0448	,
B0449	,
B0450	,
B0451	,
B0452	,
B0453	,
B0454	,
B0455	,
B0456   ,
---
B0457   ,
B0458   ,
B0459   ,
B0460   ,
B0461   ,
B0462   ,
B0463   ,
B0464   ,
B0465   ,
B0466   ,
B0467   ,
B0468   ,
B0469   ,
B0470   ,
B0471   ,
B0472   ,
B0473   ,
B0474   ,
B0475   ,
B0476   ,
B0477   ,
B0478   ,
B0479   ,
B0480   ,
B0481   ,
B0482   ,
B0483   ,
B0484   ,
B0485   ,
B0486   ,
B0487   ,
B0488   ,
B0489   ,
B0490   ,
B0491   ,
B0492   ,
B0493   ,
B0494   ,
---

B0495, B0496, B0497, B0498, B0499, B0500, B0501, B0502, B0503, B0504, B0505, B0506, B0507, B0508, B0509, B0510, B0511, B0512, B0513, B0514, B0515, B0516, B0517, B0518,
B0519, B0520, B0521, B0522,	B0523, B0524, B0525, B0526, B0527, B0528, B0529, B0530, B0531, B0532, B0533, B0534, B0535, B0536, B0537, B0538, B0539, B0540, B0541, B0542,
B0543, B0544, B0545, B0546, B0547, B0548, B0549, B0550, B0551, B0552, B0553, B0554, B0555, B0556, B0557, B0558, B0559, B0560, B0561, B0562, B0563, B0564, B0565, B0566,
B0567, B0568, B0569, B0570, B0571, B0572, B0573, B0574, B0575, B0576, B0577, B0578, B0579, B0580, B0581, B0582, B0583, B0584, B0585, B0586, B0587, B0588, B0589, B0590,
B0591

from digital.business_occupations_matches_segments;
---(13545801 row(s) affected)     ---QA (180734 row(s) affected)

 --Creating FamilyID Match Segments

 ---select top 0 gg
drop table if exists digital.business_occupations_matches_family_segments;

create table digital.business_occupations_matches_family_segments as
select
  Right('000000000000000000'+e.row_id,18) id,
  row_id orig_id,
 '00' e_executivesourcecode,
 Right('00'+em_vendorid,2) e_vendorid2,
 '000000000000' abinumber,
  em_indiv_id inidividualid,
 e.family_id familyid,
e.first_name e_firstname ,
e.last_name e_lastname ,
AREA_CODE+PHONE_NUMBER  phonenumber,
---case when ltrim(rtrim(em_emailaddress)) = '' then em_emailaddress else lower(substring(convert(varchar(max),HashBytes('MD5',lower(LTRIM(RTRIM(em_emailaddress)))),1),3,32)) end as email,
case when ltrim(rtrim(em_emailaddress)) = '' then em_emailaddress else md5(lower(trim(em_emailaddress))) end as email,
em_emailaddress orig_email,
'' m_address_mailing, '' m_city_mailing,
'' m_state_mailing, '' m_zipcode_mailing, '' m_zipfour_mailing,
address,
city,state,ZIP_CODE zipcode,zip_four zipfour,
'' m_address_landmark,
'' m_city_landmark,
'' m_state_landmark,
'' m_zipcode_landmark,
'' m_zipfour_landmark,
'' e_homeaddress,
'' e_homecity,
'' e_homestate,
'' e_homezipcode,
'' e_homezip4,
'' fulfillmentflag,
'OCCUPATIONS_MATCHES_FAMILY' dataset,
cast(NULL as int) b0001,
CASE WHEN SIC_CODE IN ('075102', '208401', '794803') THEN 1 END as b0002,
cast(NULL as int) b0003,
cast(NULL as int) b0004,
cast(NULL as int) b0005,
cast(NULL as int) b0006,
cast(NULL as int) b0007,
cast(NULL as int) b0008,
cast(NULL as int) b0009,
cast(NULL as int) b0010,
cast(NULL as int) b0011,
cast(NULL as int) b0012,
case when ( sic_code IN ('591205', '599504', '599900', '801101', '801121', '804101', '804201', '804301', '804900', '804902', '804904', '804911', '804912', '804913', '804914', '804918', '804919', '804922', '804924', '804925', '804926', '804951', '804964', '805101', '805999', '806301', '807118', '808201', '809900', '832281', '839911', '899905')   OR
( sic_code='832201' AND SPECIALTY_TITLE IN ('MENTAL HEALTH COUNSELOR', 'ADDICTION COUNSELOR', 'CLINICAL', 'BEHAVIORAL', 'DEVELOPMENTAL DISABILITY/RETARDATION', 'NEUROPSYCHOLOGIST', 'REHABILITATION', 'AGING/ADULT') )  OR
( sic_code='832204' AND SPECIALTY_TITLE IN ('ADDICTION COUNSELOR', 'CLINICAL') ) ) then 1 END as b0013,
 case when (  sic_code='628203' ) then 1 END as b0014,
 cast(NULL as int) b0015,
cast(NULL as int) b0016,
case when (sic_code IN ('614101', '673303', '872105', '874209') ) THEN 1 END as b0017,
cast(NULL as int) b0018,
cast(NULL as int) b0019,
cast(NULL as int) b0020,
cast(NULL as int) b0021,
cast(NULL as int) b0022,
case when (sic_code='804908') THEN 1 END as b0023,
case when sic_code IN ('871120', '871122', '871103', '871107', '871108', '871109', '871110', '871111', '871112', '871114', '871118', '871119', '871123', '871124', '871125', '871126', '871130', '871132', '871133', '871137', '871138', '871143', '871152', '871158', '871161', '871162', '871211', '873112', '873130', '874853', '874855', '899904')  OR
 (sic_code IN ('871106', '871115', '871159')  AND OCCUPATION_TITLE IN ('ENGINEER PROFESSIONAL', 'ENGINEER INTERN', 'ENGINEER TEMPORARY LICENSE') ) THEN 1 END as b0024,
cast(NULL as int) b0025,
cast(NULL as int) b0026,
cast(NULL as int) b0027,
cast(NULL as int) b0028,
cast(NULL as int) b0029,
case when sic_code IN ('736109', '738920', '781908', '822100', '823106') then 1 end as b0030,
cast(NULL as int) b0031,
cast(NULL as int) b0032,
cast(NULL as int) b0033,
cast(NULL as int) b0034,
case when (SIC_CODE >=  801111  AND SIC_CODE <=  801114 ) OR  ( SIC_CODE >=   801118  AND SIC_CODE <=  801131 )  OR  ( SIC_CODE >=  804301 AND SIC_CODE <= 804304 )  OR  SIC_CODE IN ('801101','801105','801108','801137','801138','804901','802108') then 1 end as b0035,
cast(NULL as int) b0036,
case when sic_code IN ('874301', '874824', '912113')  then 1 end as b0037,
cast(NULL as int) b0038,
cast(NULL as int) b0039,
case when sic_code IN ('591205', '599504', '599900', '801101', '801121', '804101', '804201', '804301', '804900', '804902', '804904', '804911', '804912', '804913', '804914', '804918', '804919', '804922', '804924', '804925', '804926', '804951', '804964', '805101', '805999', '806301', '807118', '808201', '809900', '832281', '839911', '899905')   OR
( sic_code='832201' AND specialty_title IN ('MENTAL HEALTH COUNSELOR', 'ADDICTION COUNSELOR', 'CLINICAL', 'BEHAVIORAL', 'DEVELOPMENTAL DISABILITY/RETARDATION', 'NEUROPSYCHOLOGIST', 'REHABILITATION', 'AGING/ADULT') )  OR
( sic_code='832204' AND specialty_title IN ('ADDICTION COUNSELOR', 'CLINICAL') ) then 1 end as b0040,
cast(NULL as int) b0041,
cast(NULL as int) b0042,
cast(NULL as int) b0043,
cast(NULL as int) b0044,
cast(NULL as int) b0045,
cast(NULL as int) b0046,
cast(NULL as int) b0047,
cast(NULL as int) b0048,
cast(NULL as int) b0049,
cast(NULL as int) b0050,
cast(NULL as int) b0051,
cast(NULL as int) b0052,
cast(NULL as int) b0053,
cast(NULL as int) b0054,
cast(NULL as int) b0055,
cast(NULL as int) b0056,
cast(NULL as int) b0057,
cast(NULL as int) b0058,
cast(NULL as int) b0059,
cast(NULL as int) b0060,
cast(NULL as int) b0061,
cast(NULL as int) b0062,
cast(NULL as int) b0063,
cast(NULL as int) b0064,
cast(NULL as int) b0065,
cast(NULL as int) b0066,
cast(NULL as int) b0067,
cast(NULL as int) b0068,
cast(NULL as int) b0069,
cast(NULL as int) b0070,
cast(NULL as int) b0071,
cast(NULL as int) b0072,
cast(NULL as int) b0073,
cast(NULL as int) b0074,
cast(NULL as int) b0075,
cast(NULL as int) b0076,
cast(NULL as int) b0077,
cast(NULL as int) b0078,
cast(NULL as int) b0079,
cast(NULL as int) b0080,
cast(NULL as int) b0081,
cast(NULL as int) b0082,
cast(NULL as int) b0083,
cast(NULL as int) b0084,
cast(NULL as int) b0085,
cast(NULL as int) b0086,
cast(NULL as int) b0087,
cast(NULL as int) b0088,
cast(NULL as int) b0089,
cast(NULL as int) b0090,
cast(NULL as int) b0091,
cast(NULL as int) b0092,
cast(NULL as int) b0093,
cast(NULL as int) b0094,
cast(NULL as int) b0095,
cast(NULL as int) b0096,
cast(NULL as int) b0097,
cast(NULL as int) b0098,
cast(NULL as int) b0099,
cast(NULL as int) b0100,
cast(NULL as int) b0101,
cast(NULL as int) b0102,
cast(NULL as int) b0103,
cast(NULL as int) b0104,
cast(NULL as int) b0105,
cast(NULL as int) b0106,
cast(NULL as int) b0107,
cast(NULL as int) b0108,
---cast(NULL as int) b0109,
cast(NULL as int) b0110,
cast(NULL as int) b0111,
cast(NULL as int) b0112,
cast(NULL as int) b0113,
cast(NULL as int) b0114,
cast(NULL as int) b0115,
cast(NULL as int) b0116,
cast(NULL as int) b0117,
cast(NULL as int) b0118,
cast(NULL as int) b0119,
cast(NULL as int) b0120,
cast(NULL as int) b0121,
cast(NULL as int) b0122,
cast(NULL as int) b0123,
cast(NULL as int) b0124,
cast(NULL as int) b0125,
cast(NULL as int) b0126,
cast(NULL as int) b0127,
cast(NULL as int) b0128,
cast(NULL as int) b0129,
cast(NULL as int) b0130,
cast(NULL as int) b0131,
cast(NULL as int) b0132,
cast(NULL as int) b0133,
cast(NULL as int) b0134,
cast(NULL as int) b0135,
cast(NULL as int) b0136,
cast(NULL as int) b0137,
cast(NULL as int) b0138,
cast(NULL as int) b0139,
cast(NULL as int) b0140,
cast(NULL as int) b0141,
cast(NULL as int) b0142,
cast(NULL as int) b0143,
cast(NULL as int) b0144,
cast(NULL as int) b0145,
cast(NULL as int) b0146,
cast(NULL as int) b0147,
cast(NULL as int) b0148,
cast(NULL as int) b0149,
cast(NULL as int) b0150,
cast(NULL as int) b0151,
cast(NULL as int) b0152,
cast(NULL as int) b0153,
/*
cast(NULL as int) b0154,
cast(NULL as int) b0155,
cast(NULL as int) b0156,
cast(NULL as int) b0157,
cast(NULL as int) b0158,
cast(NULL as int) b0159,
cast(NULL as int) b0160,
cast(NULL as int) b0161,
cast(NULL as int) b0162,
cast(NULL as int) b0163,
cast(NULL as int) b0164,
cast(NULL as int) b0165,
cast(NULL as int) b0166,
cast(NULL as int) b0167,
cast(NULL as int) b0168,
cast(NULL as int) b0169,
cast(NULL as int) b0170,
cast(NULL as int) b0171,
cast(NULL as int) b0172,
cast(NULL as int) b0173,
cast(NULL as int) b0174,
cast(NULL as int) b0175,
cast(NULL as int) b0176,
cast(NULL as int) b0177,
cast(NULL as int) b0178,
cast(NULL as int) b0179,
cast(NULL as int) b0180,
cast(NULL as int) b0181,
cast(NULL as int) b0182,
cast(NULL as int) b0183,
cast(NULL as int) b0184,
cast(NULL as int) b0185,
cast(NULL as int) b0186,
cast(NULL as int) b0187,
cast(NULL as int) b0188,
cast(NULL as int) b0189,
cast(NULL as int) b0190,
cast(NULL as int) b0191,
cast(NULL as int) b0192,
cast(NULL as int) b0193,
cast(NULL as int) b0194,
cast(NULL as int) b0195,
cast(NULL as int) b0196,
cast(NULL as int) b0197,
cast(NULL as int) b0198,
cast(NULL as int) b0199,
cast(NULL as int) b0200,
cast(NULL as int) b0201,
cast(NULL as int) b0202,
cast(NULL as int) b0203,
cast(NULL as int) b0204,
cast(NULL as int) b0205,
cast(NULL as int) b0206,
cast(NULL as int) b0207,
cast(NULL as int) b0208,
cast(NULL as int) b0209,
cast(NULL as int) b0210,
cast(NULL as int) b0211,
cast(NULL as int) b0212,
cast(NULL as int) b0213,
cast(NULL as int) b0214,
cast(NULL as int) b0215,
cast(NULL as int) b0216,
cast(NULL as int) b0217,
cast(NULL as int) b0218,
cast(NULL as int) b0219,
cast(NULL as int) b0220,
cast(NULL as int) b0221,
cast(NULL as int) b0222,
cast(NULL as int) b0223,
cast(NULL as int) b0224,
cast(NULL as int) b0225,
cast(NULL as int) b0226,
cast(NULL as int) b0227,
cast(NULL as int) b0228,
cast(NULL as int) b0229,
cast(NULL as int) b0230,
cast(NULL as int) b0231,
cast(NULL as int) b0232,
cast(NULL as int) b0233,
cast(NULL as int) b0234,
cast(NULL as int) b0235,
 */
   /*
cast(NULL as int) b0236,
cast(NULL as int) b0237,
cast(NULL as int) b0238,
cast(NULL as int) b0239,
cast(NULL as int) b0240,
cast(NULL as int) b0241,
cast(NULL as int) b0242,
cast(NULL as int) b0243,
cast(NULL as int) b0244,
cast(NULL as int) b0245,
cast(NULL as int) b0246,
cast(NULL as int) b0247,
cast(NULL as int) b0248,
cast(NULL as int) b0249,
cast(NULL as int) b0250,
cast(NULL as int) b0251,
cast(NULL as int) b0252,
cast(NULL as int) b0253,
cast(NULL as int) b0254,
cast(NULL as int) b0255,
cast(NULL as int) b0256,
cast(NULL as int) b0257,
cast(NULL as int) b0258,
cast(NULL as int) b0259,
cast(NULL as int) b0260,
cast(NULL as int) b0261,
cast(NULL as int) b0262,
cast(NULL as int) b0263,
cast(NULL as int) b0264,
cast(NULL as int) b0265,
cast(NULL as int) b0266,
cast(NULL as int) b0267,
cast(NULL as int) b0268,
cast(NULL as int) b0269,
cast(NULL as int) b0270,
cast(NULL as int) b0271,
cast(NULL as int) b0272,
cast(NULL as int) b0273,
cast(NULL as int) b0274,
cast(NULL as int) b0275,
cast(NULL as int) b0276,
cast(NULL as int) b0277,
cast(NULL as int) b0278,
cast(NULL as int) b0279,
cast(NULL as int) b0280,
cast(NULL as int) b0281,
cast(NULL as int) b0282,
cast(NULL as int) b0283,
cast(NULL as int) b0284,
cast(NULL as int) b0285,
cast(NULL as int) b0286,
   */
/*
cast(NULL as int) b0287,
cast(NULL as int) b0288,
cast(NULL as int) b0289,
cast(NULL as int) b0290,
cast(NULL as int) b0291,
cast(NULL as int) b0292,
cast(NULL as int) b0293,
cast(NULL as int) b0294,
cast(NULL as int) b0295,
cast(NULL as int) b0296,
cast(NULL as int) b0297,
cast(NULL as int) b0298,
  */
cast(NULL as int) b0299,
cast(NULL as int) b0300,
cast(NULL as int) b0301,
cast(NULL as int) b0302,
cast(NULL as int) b0303,
--changes
---cast(NULL as int) b0304,
---cast(NULL as int) b0305,
cast(NULL as int) b0306,
cast(NULL as int) b0307,
/*
cast(NULL as int) b0308,
cast(NULL as int) b0309,
cast(NULL as int) b0310,
cast(NULL as int) b0311,
cast(NULL as int) b0312,
cast(NULL as int) b0313,
cast(NULL as int) b0314,
cast(NULL as int) b0315,
cast(NULL as int) b0316,
cast(NULL as int) b0317,
cast(NULL as int) b0318,
cast(NULL as int) b0319,
cast(NULL as int) b0320,
cast(NULL as int) b0321,
cast(NULL as int) b0322,
  */
cast(NULL as int) b0323,
cast(NULL as int) b0324,
cast(NULL as int) b0325,
cast(NULL as int) b0326,
cast(NULL as int) b0327,
cast(NULL as int) b0328,
cast(NULL as int) b0329,
cast(NULL as int) b0330,
cast(NULL as int) b0331,
cast(NULL as int) b0332,
cast(NULL as int) b0333,
cast(NULL as int) b0334,
cast(NULL as int) b0335,
cast(NULL as int) b0336,
cast(NULL as int) b0337,
cast(NULL as int) b0338,
cast(NULL as int) b0339,
cast(NULL as int) b0340,
/*
cast(NULL as int) b0341,
cast(NULL as int) b0342,
cast(NULL as int) b0343,
cast(NULL as int) b0344,
cast(NULL as int) b0345,
cast(NULL as int) b0346,
cast(NULL as int) b0347,
cast(NULL as int) b0348,
case when OCCUPATION_TITLE IN ('AGENT','INSURANCE AGENT','REAL ESTATE SALES','SPORTS AGENTS','TALENT AGENT') then 1 end as b0349,
  */
case when OCCUPATION_TITLE = 'MIDWIFE (NOT RN)' OR SPECIALTY_TITLE='MIDWIFE' then 1 end as b0350,
case when OCCUPATION_TITLE = 'NURSE REGISTERED (RN)' AND specialty_title='NURSE PRACTITIONER' then 1 end as b0351,
case when OCCUPATION_TITLE = 'ACCOUNTANT' then 1 end as b0352,
case when OCCUPATION_TITLE = 'CHIROPRACTOR' then 1 end as b0353,
case when OCCUPATION_TITLE = 'DENTIST' then 1 end as b0354,
cast(NULL as int) b0355,
case when OCCUPATION_TITLE = 'DENTIST' then 1 end as b0356,
case when OCCUPATION_TITLE = 'PODIATRIST' then 1 end as  b0357,
cast(NULL as int) b0358,
case when OCCUPATION_TITLE = 'VETERINARIAN' then 1 end as  b0359,
case when OCCUPATION_TITLE = 'NURSE PRACTICAL (LPN)' then 1 end as  b0360,
case when OCCUPATION_TITLE = 'DOCTORS/PHYSICIANS' then 1 end as  b0361,
case when SPECIALTY_TITLE='NURSE PRACTITIONER' then 1 end as  b0362,
case when SPECIALTY_TITLE='OPTOMETRIST (OD)' then 1 end as  b0363,
case when OCCUPATION_TITLE = 'THERAPIST' AND SPECIALTY_TITLE ='OCCUPATIONAL' then 1 end as b0364,
case when SPECIALTY_TITLE = 'PHYSICIAN''S ASSISTANT' then 1 end as b0365,
case when OCCUPATION_TITLE = 'ENGINEER PROFESSIONAL' then 1 end as b0366,
cast(NULL as int) b0367,
case when OCCUPATION_TITLE = 'THERAPIST' AND SPECIALTY_TITLE='PHYSICAL (LICENSED)' then 1 end as b0368,
case when OCCUPATION_TITLE = 'NURSE REGISTERED (RN)' then 1 end as b0369,
case when OCCUPATION_TITLE = 'NATUROPATHIC/HOMEOPATHIC PHYSICIAN OR COUNSELOR' then 1 end as b0370,
/*
cast(NULL as int) b0371,
cast(NULL as int) b0372,
cast(NULL as int) b0373,
cast(NULL as int) b0374,
  */
cast(NULL as int) b0375,
---cast(NULL as int) b0376,
---cast(NULL as int) b0377,
cast(NULL as int) b0378,
cast(NULL as int) b0379,
cast(NULL as int) b0380,
cast(NULL as int) b0381,
cast(NULL as int) b0382,
cast(NULL as int) b0383,
cast(NULL as int) b0384,
cast(NULL as int) b0385,
cast(NULL as int) b0386,
cast(NULL as int) b0387,
cast(NULL as int) b0388,
cast(NULL as int) b0389,
cast(NULL as int) b0390,
cast(NULL as int) b0391,
cast(NULL as int) b0392,
cast(NULL as int) b0393,
cast(NULL as int) b0394,
cast(NULL as int) b0395,
cast(NULL as int) b0396,
cast(NULL as int) b0397,
cast(NULL as int) b0398,
cast(NULL as int) b0399,
cast(NULL as int) b0400,
cast(NULL as int) b0401,
cast(NULL as int) b0402,
cast(NULL as int) b0403,
cast(NULL as int) b0404,
cast(NULL as int) b0405,
cast(NULL as int) b0406,
cast(NULL as int) b0407,
cast(NULL as int) b0408,
cast(NULL as int) b0409,
cast(NULL as int) b0410,
cast(NULL as int) b0411,
cast(NULL as int) b0412,
cast(NULL as int) b0413,
cast(NULL as int) b0414,
cast(NULL as int) b0415,
cast(NULL as int) b0416,
cast(NULL as int) b0417,
cast(NULL as int) b0418,
cast(NULL as int) b0419,
cast(NULL as int) b0420,
cast(NULL as int) b0421,
cast(NULL as int) b0422,
cast(NULL as int) b0423,
cast(NULL as int) b0424,
cast(NULL as int) b0425,
cast(NULL as int) b0426,
cast(NULL as int) b0427,
cast(NULL as int) b0428,
cast(NULL as int) b0429,
cast(NULL as int) b0430,
cast(NULL as int) b0431,
cast(NULL as int) b0432,
cast(NULL as int) b0433,
cast(NULL as int) b0434,
cast(NULL as int) b0435,
cast(NULL as int) b0436,
cast(NULL as int) b0437,
cast(NULL as int) b0438,
cast(NULL as int) b0439,
cast(NULL as int) b0440,
cast(NULL as int) b0441,
cast(NULL as int) b0442,
cast(NULL as int) b0443,
cast(NULL as int) b0444,
cast(NULL as int) b0445,
cast(NULL as int) b0446,
cast(NULL as int) b0447,
cast(NULL as int) b0448,
cast(NULL as int) b0449,
cast(NULL as int) b0450,
cast(NULL as int) b0451,
cast(NULL as int) b0452,
cast(NULL as int) b0453,
cast(NULL as int) b0454,
cast(NULL as int) b0455,
cast(NULL as int) b0456,
---
cast(NULL as int) b0457,
cast(NULL as int) b0458,
cast(NULL as int) b0459,
cast(NULL as int) b0460,
case when (sic_code IN('801101','801105','801108','801111','801112','801113','801114','801137','801138','804301','804302','804303','804304','804901','802108') OR
                   sic_code between 801118 and 801131) then 1 end B0461,
case when SPECIALTY_TITLE ='Pediatrics' then 1 end B0462,
case when substring(sic_code,1,2) = '35' then 1 end B0463,
case when substring(sic_code,1,2) = '15' then 1 end B0464,
case when sic_code IN('621101','621104','621105','621109','621110','621111','874209') OR
                sic_code between 628200 and 628299 OR substring(sic_code,1,3) IN('602','603','604','606') then 1 end B0465,
case when sic_code in('124101','138101','138210','138902','138930','153101','154220','154236','161114','162202','162304','162321','162904','162912','162917','162925','811110','832290')
                       OR substring(sic_code,1,2) = '17' then 1 end B0466,
case when SIC_CODE in('801104','801113','803198','804398','804999','809399') OR
                 ((sic_code between 801101 and 801138 or sic_code between 804301 and 804398) and sic_code not in('801105')) then 1 end B0467,
cast(NULL as int) b0468,
case when sic_code in('431101') then 1 end B0469,
case when substring(SIC_CODE,1,2) in('01','02') then 1 end B0470,
cast(NULL as int) b0471,
cast(NULL as int) b0472,
case when sic_code in('653117') then 1 end B0473,
cast(NULL as int) b0474,
cast(NULL as int) b0475,
cast(NULL as int) b0476,
cast(NULL as int) b0477,
cast(NULL as int) b0478,
cast(NULL as int) b0479,
cast(NULL as int) b0480,
cast(NULL as int) b0481,
cast(NULL as int) b0482,
cast(NULL as int) b0483,
cast(NULL as int) b0484,
cast(NULL as int) b0485,
cast(NULL as int) b0486,
cast(NULL as int) b0487,
cast(NULL as int) b0488,
cast(NULL as int) b0489,
cast(NULL as int) b0490,
cast(NULL as int) b0491,
cast(NULL as int) b0492,
cast(NULL as int) b0493,
cast(NULL as int) b0494,
---

cast(NULL as int) b0495,
cast(NULL as int) b0496,
cast(NULL as int) b0497,
cast(NULL as int) b0498,
cast(NULL as int) b0499,
cast(NULL as int) b0500,
cast(NULL as int) b0501,
cast(NULL as int) b0502,
cast(NULL as int) b0503,
cast(NULL as int) b0504,
cast(NULL as int) b0505,
cast(NULL as int) b0506,
cast(NULL as int) b0507,
cast(NULL as int) b0508,
cast(NULL as int) b0509,
cast(NULL as int) b0510,
cast(NULL as int) b0511,
cast(NULL as int) b0512,
cast(NULL as int) b0513,
cast(NULL as int) b0514,
cast(NULL as int) b0515,
cast(NULL as int) b0516,
cast(NULL as int) b0517,
cast(NULL as int) b0518,
cast(NULL as int) b0519,
cast(NULL as int) b0520,
cast(NULL as int) b0521,
cast(NULL as int) b0522,
cast(NULL as int) b0523,
cast(NULL as int) b0524,
cast(NULL as int) b0525,
cast(NULL as int) b0526,
cast(NULL as int) b0527,
cast(NULL as int) b0528,
cast(NULL as int) b0529,
cast(NULL as int) b0530,
cast(NULL as int) b0531,
cast(NULL as int) b0532,
cast(NULL as int) b0533,
cast(NULL as int) b0534,
cast(NULL as int) b0535,
cast(NULL as int) b0536,
cast(NULL as int) b0537,
cast(NULL as int) b0538,
cast(NULL as int) b0539,
cast(NULL as int) b0540,
cast(NULL as int) b0541,
cast(NULL as int) b0542,
cast(NULL as int) b0543,
cast(NULL as int) b0544,
cast(NULL as int) b0545,
cast(NULL as int) b0546,
cast(NULL as int) b0547,
cast(NULL as int) b0548,
cast(NULL as int) b0549,
cast(NULL as int) b0550,
cast(NULL as int) b0551,
cast(NULL as int) b0552,
cast(NULL as int) b0553,
cast(NULL as int) b0554,
cast(NULL as int) b0555,
cast(NULL as int) b0556,
cast(NULL as int) b0557,
cast(NULL as int) b0558,
cast(NULL as int) b0559,
cast(NULL as int) b0560,
cast(NULL as int) b0561,
cast(NULL as int) b0562,
cast(NULL as int) b0563,
cast(NULL as int) b0564,
cast(NULL as int) b0565,
cast(NULL as int) b0566,
cast(NULL as int) b0567,
cast(NULL as int) b0568,
cast(NULL as int) b0569,
cast(NULL as int) b0570,
cast(NULL as int) b0571,
cast(NULL as int) b0572,
cast(NULL as int) b0573,
cast(NULL as int) b0574,
cast(NULL as int) b0575,
cast(NULL as int) b0576,
cast(NULL as int) b0577,
cast(NULL as int) b0578,
CASE WHEN	sic_code between 830000 and 839999	then 1 end	B0579,
cast(NULL as int) b0580,
cast(NULL as int) b0581,
cast(NULL as int) b0582,
cast(NULL as int) b0583,
cast(NULL as int) b0584,
cast(NULL as int) b0585,
cast(NULL as int) b0586,
cast(NULL as int) b0587,
cast(NULL as int) b0588,
cast(NULL as int) b0589,
cast(NULL as int) b0590,
cast(NULL as int) b0591

 from  digital.business_occupations_family_email_enhancements e;
---(38500869 row(s) affected)        ---QA (369867 row(s) affected)

insert into digital.business_segments_bb_vv_aws (
business_Exec_ID,
id,
e_executivesourcecode,
abinumber,
e_vendorid2,
e_firstname,
e_lastname,
phonenumber,
email,
orig_email,
m_address_mailing,
m_city_mailing,
m_state_mailing,
m_zipcode_mailing,
m_zipfour_mailing,
address,
city,
state,
zipcode,
zipfour,
m_address_landmark,
m_city_landmark,
m_state_landmark,
m_zipcode_landmark,
m_zipfour_landmark,
e_homeaddress,
e_homecity,
e_homestate,
e_homezipcode,
e_homezip4,
fulfillmentflag,
dataset,
b0001, b0002, b0003, b0004, b0005, b0006, b0007, b0008, b0009, b0010, b0011, b0012, b0013, b0014, b0015, b0016, b0017, b0018, b0019, b0020, b0021, b0022, b0023, b0024, b0025, b0026, b0027, b0028, b0029, b0030, b0031, b0032, b0033, b0034, b0035, b0036, b0037, b0038, b0039, b0040, b0041, b0042, b0043, b0044, b0045, b0046, b0047, b0048, b0049, b0050, b0051, b0052, b0053, b0054, b0055, b0056, b0057, b0058, b0059, b0060, b0061, b0062, b0063, b0064, b0065, b0066, b0067, b0068, b0069, b0070, b0071, b0072, b0073, b0074, b0075, b0076, b0077, b0078, b0079, b0080, b0081, b0082, b0083, b0084, b0085, b0086, b0087, b0088, b0089, b0090, b0091, b0092, b0093, b0094, b0095, b0096, b0097, b0098, b0099, b0100, b0101, b0102, b0103, b0104, b0105, b0106, b0107, b0108, b0110, b0111, b0112, b0113, b0114, b0115, b0116, b0117, b0118, b0119, b0120, b0121, b0122, b0123, b0124, b0125, b0126, b0127, b0128, b0129, b0130, b0131, b0132, b0133, b0134, b0135, b0136, b0137, b0138, b0139, b0140, b0141, b0142, b0143, b0144, b0145, b0146, b0147, b0148, b0149, b0150, b0151, b0152, b0153, b0299, b0300, b0301, b0302, b0303, b0306, b0307, b0323, b0324, b0325, b0326, b0327, b0328, b0329, b0330, b0331, b0332, b0333, b0334, b0335, b0336, b0337, b0338, b0339, b0340, b0350, b0351, b0352, b0353, b0354, b0355, b0356, b0357, b0358, b0359, b0360, b0361, b0362, b0363, b0364, b0365, b0366, b0367, b0368, b0369, b0370, b0375, b0378, b0379, B0380, B0381, B0382, B0383, B0384, B0385, B0386, B0387, B0388, B0389, B0390, B0391, B0392, B0393, B0394, B0395, B0396, B0397, B0398, B0399, B0400, B0401, B0402, B0403, B0404, B0405, B0406, B0407, B0408, B0409, B0410, B0411, B0412, B0413, B0414, B0415, B0416, B0417, B0418, B0419, B0420, B0421, B0422, B0423, B0424, B0425, B0426, B0427, B0428, B0429, B0430, B0431, B0432, B0433, B0434, B0435, B0436, B0437, B0438, B0439, B0440, B0441, B0442, B0443, B0444, B0445, B0446, B0447, B0448, B0449, B0450, B0451, B0452, B0453, B0454, B0455, B0456,
---
B0457   ,
B0458   ,
B0459   ,
B0460   ,
B0461   ,
B0462   ,
B0463   ,
B0464   ,
B0465   ,
B0466   ,
B0467   ,
B0468   ,
B0469   ,
B0470   ,
B0471   ,
B0472   ,
B0473   ,
B0474   ,
B0475   ,
B0476   ,
B0477   ,
B0478   ,
B0479   ,
B0480   ,
B0481   ,
B0482   ,
B0483   ,
B0484   ,
B0485   ,
B0486   ,
B0487   ,
B0488   ,
B0489   ,
B0490   ,
B0491   ,
B0492   ,
B0493   ,
B0494   ,
---

B0495, B0496, B0497, B0498, B0499, B0500, B0501, B0502, B0503, B0504, B0505, B0506, B0507, B0508, B0509, B0510, B0511, B0512, B0513, B0514, B0515, B0516, B0517, B0518,
B0519, B0520, B0521, B0522,	B0523, B0524, B0525, B0526, B0527, B0528, B0529, B0530, B0531, B0532, B0533, B0534, B0535, B0536, B0537, B0538, B0539, B0540, B0541, B0542,
B0543, B0544, B0545, B0546, B0547, B0548, B0549, B0550, B0551, B0552, B0553, B0554, B0555, B0556, B0557, B0558, B0559, B0560, B0561, B0562, B0563, B0564, B0565, B0566,
B0567, B0568, B0569, B0570, B0571, B0572, B0573, B0574, B0575, B0576, B0577, B0578, B0579, B0580, B0581, B0582, B0583, B0584, B0585, B0586, B0587, B0588, B0589, B0590,
B0591

)
select
--'000000000' New_ID,
'P'+
case when ltrim(rtrim(inidividualid)) !='' then Right('000000000000'+inidividualid,12) else '000000000000' end
+'-'+  case when (ltrim(rtrim(e_vendorid2)) = '00' OR e_vendorid2  = 36 ) then 'P' ELSE 'V' END   + Right('00000000000000'+id ,14)  +  '-'+ e_vendorid2   business_Exec_ID ,
 id  ,
 '00',
 '000000000',
 e_vendorid2,
e_firstname     ,
e_lastname      ,
phonenumber     ,
email   ,
orig_email,
'' m_address_mailing       ,
'' m_city_mailing  ,
'' m_state_mailing ,
'' m_zipcode_mailing       ,
'' m_zipfour_mailing       ,
 address ,
 city    ,
 state   ,
 zipcode ,
 zipfour ,
'' m_address_landmark      ,
'' m_city_landmark ,
'' m_state_landmark        ,
'' m_zipcode_landmark      ,
'' m_zipfour_landmark      ,
'' e_homeaddress,
'' e_homecity,
'' e_homestate,
'' e_homezipcode,
'' e_homezip4,
'' fulfillmentflag,
dataset,
B0001	,
B0002	,
B0003	,
B0004	,
B0005	,
B0006	,
B0007	,
B0008	,
B0009	,
B0010	,
B0011	,
B0012	,
B0013	,
B0014	,
B0015	,
B0016	,
B0017	,
B0018	,
B0019	,
B0020	,
B0021	,
B0022	,
B0023	,
B0024	,
B0025	,
B0026	,
B0027	,
B0028	,
B0029	,
B0030	,
B0031	,
B0032	,
B0033	,
B0034	,
B0035	,
B0036	,
B0037	,
B0038	,
B0039	,
B0040	,
B0041	,
B0042	,
B0043	,
B0044	,
B0045	,
B0046	,
B0047	,
B0048	,
B0049	,
B0050	,
B0051	,
B0052	,
B0053	,
B0054	,
B0055	,
B0056	,
B0057	,
B0058	,
B0059	,
B0060	,
B0061	,
B0062	,
B0063	,
B0064	,
B0065	,
B0066	,
B0067	,
B0068	,
B0069	,
B0070	,
B0071	,
B0072	,
B0073	,
B0074	,
B0075	,
B0076	,
B0077	,
B0078	,
B0079	,
B0080	,
B0081	,
B0082	,
B0083	,
B0084	,
B0085	,
B0086	,
B0087	,
B0088	,
B0089	,
B0090	,
B0091	,
B0092	,
B0093	,
B0094	,
B0095	,
B0096	,
B0097	,
B0098	,
B0099	,
B0100	,
B0101	,
B0102	,
B0103	,
B0104	,
B0105	,
B0106	,
B0107	,
B0108	,
B0110	,
B0111	,
B0112	,
B0113	,
B0114	,
B0115	,
B0116	,
B0117	,
B0118	,
B0119	,
B0120	,
B0121	,
B0122	,
B0123	,
B0124	,
B0125	,
B0126	,
B0127	,
B0128	,
B0129	,
B0130	,
B0131	,
B0132	,
B0133	,
B0134	,
B0135	,
B0136	,
B0137	,
B0138	,
B0139	,
B0140	,
B0141	,
B0142	,
B0143	,
B0144	,
B0145	,
B0146	,
B0147	,
B0148	,
B0149	,
B0150	,
B0151	,
B0152	,
B0153	,
B0299	,
B0300	,
B0301	,
B0302	,
B0303	,
B0306	,
B0307	,
B0323	,
B0324	,
B0325	,
B0326	,
B0327	,
B0328	,
B0329	,
B0330	,
B0331	,
B0332	,
B0333	,
B0334	,
B0335	,
B0336	,
B0337	,
B0338	,
B0339	,
B0340	,
B0350	,
B0351	,
B0352	,
B0353	,
B0354	,
B0355	,
B0356	,
B0357	,
B0358	,
B0359	,
B0360	,
B0361	,
B0362	,
B0363	,
B0364	,
B0365	,
B0366	,
B0367	,
B0368	,
B0369	,
B0370	,
B0375	,
B0378	,
B0379	,
B0380	,
B0381	,
B0382	,
B0383	,
B0384	,
B0385	,
B0386	,
B0387	,
B0388	,
B0389	,
B0390	,
B0391	,
B0392	,
B0393	,
B0394	,
B0395	,
B0396	,
B0397	,
B0398	,
B0399	,
B0400	,
B0401	,
B0402	,
B0403	,
B0404	,
B0405	,
B0406	,
B0407	,
B0408	,
B0409	,
B0410	,
B0411	,
B0412	,
B0413	,
B0414	,
B0415	,
B0416	,
B0417	,
B0418	,
B0419	,
B0420	,
B0421	,
B0422	,
B0423	,
B0424	,
B0425	,
B0426	,
B0427	,
B0428	,
B0429	,
B0430	,
B0431	,
B0432	,
B0433	,
B0434	,
B0435	,
B0436	,
B0437	,
B0438	,
B0439	,
B0440	,
B0441	,
B0442	,
B0443	,
B0444	,
B0445	,
B0446	,
B0447	,
B0448	,
B0449	,
B0450	,
B0451	,
B0452	,
B0453	,
B0454	,
B0455	,
B0456   ,
---
B0457   ,
B0458   ,
B0459   ,
B0460   ,
B0461   ,
B0462   ,
B0463   ,
B0464   ,
B0465   ,
B0466   ,
B0467   ,
B0468   ,
B0469   ,
B0470   ,
B0471   ,
B0472   ,
B0473   ,
B0474   ,
B0475   ,
B0476   ,
B0477   ,
B0478   ,
B0479   ,
B0480   ,
B0481   ,
B0482   ,
B0483   ,
B0484   ,
B0485   ,
B0486   ,
B0487   ,
B0488   ,
B0489   ,
B0490   ,
B0491   ,
B0492   ,
B0493   ,
B0494   ,
---

B0495, B0496, B0497, B0498, B0499, B0500, B0501, B0502, B0503, B0504, B0505, B0506, B0507, B0508, B0509, B0510, B0511, B0512, B0513, B0514, B0515, B0516, B0517, B0518,
B0519, B0520, B0521, B0522,	B0523, B0524, B0525, B0526, B0527, B0528, B0529, B0530, B0531, B0532, B0533, B0534, B0535, B0536, B0537, B0538, B0539, B0540, B0541, B0542,
B0543, B0544, B0545, B0546, B0547, B0548, B0549, B0550, B0551, B0552, B0553, B0554, B0555, B0556, B0557, B0558, B0559, B0560, B0561, B0562, B0563, B0564, B0565, B0566,
B0567, B0568, B0569, B0570, B0571, B0572, B0573, B0574, B0575, B0576, B0577, B0578, B0579, B0580, B0581, B0582, B0583, B0584, B0585, B0586, B0587, B0588, B0589, B0590,
B0591

from digital.business_occupations_matches_family_segments;
---(38500869 row(s) affected)     ---QA (369867 row(s) affected)

select dataset,count(*) cnt from digital.business_segments_bb_vv_aws group by dataset order by dataset;











